<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: proxygen/lib/http/session/HTTPTransaction.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('HTTPTransaction_8cpp_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">HTTPTransaction.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="HTTPTransaction_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  Copyright (c) 2015-present, Facebook, Inc.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  All rights reserved.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  This source code is licensed under the BSD-style license found in the</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *  LICENSE file in the root directory of this source tree. An additional grant</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  of patent rights can be found in the PATENTS file in the same directory.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="HTTPTransaction_8h.html">proxygen/lib/http/session/HTTPTransaction.h</a>&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;folly/Conv.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;folly/io/async/EventBaseManager.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;folly/tracing/ScopedTraceSection.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;glog/logging.h&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="HTTPHeaderSize_8h.html">proxygen/lib/http/HTTPHeaderSize.h</a>&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="RFC2616_8h.html">proxygen/lib/http/RFC2616.h</a>&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="HTTPSessionStats_8h.html">proxygen/lib/http/session/HTTPSessionStats.h</a>&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">using</span> folly::IOBuf;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">using</span> std::unique_ptr;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceproxygen.html">proxygen</a> {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keyword">const</span> int64_t kApproximateMTU = 1400;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keyword">const</span> std::chrono::seconds kRateLimitMaxDelay(10);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;}</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a50bc3bec88048692b95b2932eb7bbb19">   31</a></span>&#160;<a class="code" href="classproxygen_1_1HTTPTransaction.html#a50bc3bec88048692b95b2932eb7bbb19">HTTPTransaction::HTTPTransaction</a>(<a class="code" href="namespaceproxygen.html#a00b4cbb0c54e966bfd87e0e7cb1cb33d">TransportDirection</a> direction,</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                 <a class="code" href="classproxygen_1_1HTTPCodec.html#addee32fd97cd4864b2a4b2f8a99c11c1">HTTPCodec::StreamID</a> <span class="keywordtype">id</span>,</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                                 uint32_t seqNo,</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                 <a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html">Transport</a>&amp; transport,</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                 <a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html">HTTP2PriorityQueueBase</a>&amp; egressQueue,</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                 folly::HHWheelTimer* timer,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                 <span class="keyword">const</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                 folly::Optional&lt;std::chrono::milliseconds&gt;&amp;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                 defaultTimeout,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                 <a class="code" href="classproxygen_1_1HTTPSessionStats.html">HTTPSessionStats</a>* stats,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                 <span class="keywordtype">bool</span> useFlowControl,</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                 uint32_t receiveInitialWindowSize,</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                 uint32_t sendInitialWindowSize,</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                 <a class="code" href="structproxygen_1_1http2_1_1PriorityUpdate.html">http2::PriorityUpdate</a> priority,</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                 folly::Optional&lt;HTTPCodec::StreamID&gt; assocId,</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                 folly::Optional&lt;HTTPCodec::ExAttributes&gt;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                 exAttributes):</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    deferredEgressBody_(<a class="code" href="namespacefolly.html">folly</a>::IOBufQueue::cacheChainLength()),</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    direction_(direction),</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    id_(id),</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    seqNo_(seqNo),</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    transport_(transport),</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    stats_(stats),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    recvWindow_(receiveInitialWindowSize),</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    sendWindow_(sendInitialWindowSize),</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    egressQueue_(egressQueue),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    assocStreamId_(assocId),</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    priority_(priority),</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    ingressPaused_(false),</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    egressPaused_(false),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    flowControlPaused_(false),</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    handlerEgressPaused_(false),</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    egressRateLimited_(false),</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    useFlowControl_(useFlowControl),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    aborted_(false),</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    deleting_(false),</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    firstByteSent_(false),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    firstHeaderByteSent_(false),</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    inResume_(false),</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    inActiveSet_(true),</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    ingressErrorSeen_(false),</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    priorityFallback_(false),</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    headRequest_(false),</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    enableLastByteFlushedTracking_(false),</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    transactionTimeout_(defaultTimeout),</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    timer_(timer) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#af4cfe0b59bb2946669c46c8757f357e2">assocStreamId_</a>) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a91147cca992f750017bd431e85952006">isUpstream</a>()) {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a> = HTTPTransactionEgressSM::State::SendingDone;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4635c6fb2e6d001200f39ea32197af09">ingressState_</a> = HTTPTransactionIngressSM::State::ReceivingDone;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">if</span> (exAttributes) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4e911a58ee03620fe176f2d80572cff6">exAttributes_</a> = exAttributes;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4e911a58ee03620fe176f2d80572cff6">exAttributes_</a>-&gt;unidirectional) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#af7143d9168c4daf4b9d973b5091af64b">isRemoteInitiated</a>()) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a> = HTTPTransactionEgressSM::State::SendingDone;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4635c6fb2e6d001200f39ea32197af09">ingressState_</a> = HTTPTransactionIngressSM::State::ReceivingDone;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">refreshTimeout</a>();</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4c679e83df84756777a28364d5632d42">stats_</a>) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4c679e83df84756777a28364d5632d42">stats_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPSessionStats.html#a4c0ac2fb3a6fe829a82ddacce8c39175">recordTransactionOpened</a>();</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a> = <a class="code" href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">egressQueue_</a>.<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html#ab88b943c7dc595b06dd998ac7fe61efe">addTransaction</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>, priority, <span class="keyword">this</span>, <span class="keyword">false</span>,</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                             &amp;<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0a599cbbd76e87f15244e4e90de9970f">insertDepth_</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">if</span> (priority.<a class="code" href="structproxygen_1_1http2_1_1PriorityUpdate.html#a679735d9727d4589b1b12fd3a2f3d8d6">streamDependency</a> != <a class="code" href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">egressQueue_</a>.<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html#a84127d301f6e185dd2fdf92d8fbf63f6">getRootId</a>() &amp;&amp;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0a599cbbd76e87f15244e4e90de9970f">insertDepth_</a> == 1) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#aacb764e1b4dbc2caa9b8f3a031b4fe4d">priorityFallback_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#add2ec8e1f7d0b23b829d47eccbdc1c2b">currentDepth_</a> = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0a599cbbd76e87f15244e4e90de9970f">insertDepth_</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#abd6a8877e27da8c50a2023936c051e9a">  112</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#abd6a8877e27da8c50a2023936c051e9a">HTTPTransaction::onDelayedDestroy</a>(<span class="keywordtype">bool</span> delayed) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0f5cf49d49de555ca71b92b5b5a7e38b">isEgressComplete</a>() || !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>() || <a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>()</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      || <a class="code" href="classproxygen_1_1HTTPTransaction.html#afda40e08e5ec6811253463896924c19b">pendingByteEvents_</a> &gt; 0 || <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5a59ec7ac8412d0d45ec93631dacbbd3">deleting_</a>) {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;destroying transaction &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5a59ec7ac8412d0d45ec93631dacbbd3">deleting_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a67eb253d121a26772f4caa56847ed7cd">detachTransaction</a>();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> bytesBuffered = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a3262de58877c59dd8367caa96088a30e">getOutstanding</a>();</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span> (bytesBuffered) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a81b96f75e461f7e176e3178040486b56">notifyIngressBodyProcessed</a>(bytesBuffered);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#ad3a4d2e4b5ea45e424ce6eae07ba4c3f">detach</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  (void)delayed; <span class="comment">// prevent unused variable warnings</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a1ab458d6f99eaeefa002e8580ecd0f17">  132</a></span>&#160;<a class="code" href="classproxygen_1_1HTTPTransaction.html#a1ab458d6f99eaeefa002e8580ecd0f17">HTTPTransaction::~HTTPTransaction</a>() {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// Cancel transaction timeout if still scheduled.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> (isScheduled()) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    cancelTimeout();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4c679e83df84756777a28364d5632d42">stats_</a>) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4c679e83df84756777a28364d5632d42">stats_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPSessionStats.html#a09e2e19fb354bba950e9d38d1fefd697">recordTransactionClosed</a>();</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>()) {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4e30ff9c01ee4576834fa7831ea3f42c">dequeue</a>();</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// TODO: handle the case where the priority node hangs out longer than</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// the transaction</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">egressQueue_</a>.<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html#ab9fda9e325d10dd40994ee45b49c0324">removeTransaction</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a2ef41693d605402f44b89b8652feb8c9">  149</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2ef41693d605402f44b89b8652feb8c9">HTTPTransaction::reset</a>(<span class="keywordtype">bool</span> useFlowControl,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                            uint32_t receiveInitialWindowSize,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                            uint32_t receiveStreamWindowSize,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                            uint32_t sendInitialWindowSize) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a> = useFlowControl;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a5e0843cdb55c9c3ffd1cfe3e2e1f25f2">setCapacity</a>(receiveInitialWindowSize);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#af62e6acda8c5bb199bb5c7fb74867f6f">setReceiveWindow</a>(receiveStreamWindowSize);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a5e0843cdb55c9c3ffd1cfe3e2e1f25f2">setCapacity</a>(sendInitialWindowSize);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a71da0fca7b035c9c9735aba7095ee4a1">  159</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a71da0fca7b035c9c9735aba7095ee4a1">HTTPTransaction::onIngressHeadersComplete</a>(</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  std::unique_ptr&lt;HTTPMessage&gt; msg) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  msg-&gt;setSeqNo(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a7e4b1c3f7b3c86f941aab14e76ffcf13">seqNo_</a>);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a91147cca992f750017bd431e85952006">isUpstream</a>() &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#aec29fb741786a8bcfe781a9a809e0159">isPushed</a>() &amp;&amp; msg-&gt;isResponse()) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ab0fac97a4fe14aebb9f05f9751ec428f">lastResponseStatus_</a> = msg-&gt;getStatusCode();</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">validateIngressStateTransition</a>(</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          HTTPTransactionIngressSM::Event::onHeaders)) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">if</span> (msg-&gt;isRequest()) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a6a1acbd434b94259956a083014a485e6">headRequest_</a> = (msg-&gt;getMethod() == <a class="code" href="namespaceproxygen.html#a708d14cbb2dacbfffbe455f5b7941fffae15e216fc1c639f787b1231ecdfa1bf8">HTTPMethod::HEAD</a>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> ((msg-&gt;isRequest() &amp;&amp; msg-&gt;getMethod() != <a class="code" href="namespaceproxygen.html#a708d14cbb2dacbfffbe455f5b7941fffab57e2519e26151feacdbe52076bc39ec">HTTPMethod::CONNECT</a>) ||</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      (msg-&gt;isResponse() &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a6a1acbd434b94259956a083014a485e6">headRequest_</a> &amp;&amp;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;       !<a class="code" href="namespaceproxygen_1_1RFC2616.html#a190e9a54e16965094cb9d3e476eb35fb">RFC2616::responseBodyMustBeEmpty</a>(msg-&gt;getStatusCode()))) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// CONNECT payload has no defined semantics</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; contentLen =</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        msg-&gt;getHeaders().getSingleOrEmpty(HTTP_HEADER_CONTENT_LENGTH);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (!contentLen.empty()) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">try</span> {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a> = folly::to&lt;uint64_t&gt;(contentLen);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      } <span class="keywordflow">catch</span> (<span class="keyword">const</span> folly::ConversionError&amp; ex) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; <span class="stringliteral">&quot;Invalid content-length: &quot;</span> &lt;&lt; contentLen</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;, ex=&quot;</span> &lt;&lt; ex.what() &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#a3f99aed58bb09a1b4b6bb803d49d83ae">headerBytesReceived</a>(msg-&gt;getIngressHeaderSize());</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa1452a5a8322901be423c0dcd6de76ef">updateIngressCompressionInfo</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a50773010568880d549b9de1cc710f51c">getCodec</a>().<a class="code" href="classproxygen_1_1HTTPCodec.html#a4e0b7580b74da507c77553ef7891bc0e">getCompressionInfo</a>());</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">mustQueueIngress</a>()) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">checkCreateDeferredIngress</a>();</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;emplace(<a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>, <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa0f2810d6dd9e145dc07a1eb52d1bf7de">HTTPEvent::Type::HEADERS_COMPLETE</a>,</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                             std::move(msg));</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued ingress event of type &quot;</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            &lt;&lt; <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa0f2810d6dd9e145dc07a1eb52d1bf7de">HTTPEvent::Type::HEADERS_COMPLETE</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa82560a6af2507dd29b6429df4e495f8">processIngressHeadersComplete</a>(std::move(msg));</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aa82560a6af2507dd29b6429df4e495f8">  204</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa82560a6af2507dd29b6429df4e495f8">HTTPTransaction::processIngressHeadersComplete</a>(</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    std::unique_ptr&lt;HTTPMessage&gt; msg) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">refreshTimeout</a>();</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>()) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a5e431cbb4c065285c5ad65acaceb0b22">onHeadersComplete</a>(std::move(msg));</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a7be28e684b8611cfdd26bf3207a1f51f">  216</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a7be28e684b8611cfdd26bf3207a1f51f">HTTPTransaction::onIngressBody</a>(unique_ptr&lt;IOBuf&gt; chain,</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                    uint16_t padding) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  FOLLY_SCOPED_TRACE_SECTION(<span class="stringliteral">&quot;HTTPTransaction - onIngressBody&quot;</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">isIngressEOMSeen</a>()) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">sendAbort</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba795fcd4a9695a63ff230ad23d4122917">ErrorCode::STREAM_CLOSED</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keyword">auto</span> len = chain-&gt;computeChainDataLength();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (len == 0) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">validateIngressStateTransition</a>(</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        HTTPTransactionIngressSM::Event::onBody)) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a>.hasValue()) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a>.value() &gt;= len) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a> =</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a>.value() - len;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keyword">auto</span> errorMsg = folly::to&lt;std::string&gt;(</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          <span class="stringliteral">&quot;Content-Length/body mismatch: received=&quot;</span>,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          len,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          <span class="stringliteral">&quot; expecting no more than &quot;</span>,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          <a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a>.value());</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; errorMsg &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <a class="code" href="classproxygen_1_1HTTPException.html">HTTPException</a> ex(<a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954aedb8d33af4486e6873c54224f6cc10ef">HTTPException::Direction::INGRESS</a>, errorMsg);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        ex.<a class="code" href="classproxygen_1_1Exception.html#a96189a5e5d3636599b7af7337437e77f">setProxygenError</a>(<a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da71d1707a93df7151bf58b8a5f6030846">kErrorParseBody</a>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">onError</a>(ex);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#a5ef8dc83f2158fc452f029e3f3f40a71">bodyBytesReceived</a>(len);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// register the bytes in the receive window</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a22bf8e1744def54ee887b2ae894e9e45">reserve</a>(len + padding, <a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a>)) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; <span class="stringliteral">&quot;recvWindow_.reserve failed with len=&quot;</span> &lt;&lt; len</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; padding=&quot;</span> &lt;&lt; padding</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; capacity=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a59e739a83cce8a0fc22c9dce48a0b193">getCapacity</a>()</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; outstanding=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a3262de58877c59dd8367caa96088a30e">getOutstanding</a>()</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *this ;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">sendAbort</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba20973c7b1b8e3fe85f3926d10271a8d4">ErrorCode::FLOW_CONTROL_ERROR</a>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    CHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#ae0cfefc1b0658621476f39cba28d9505">free</a>(padding));</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a> += padding;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">mustQueueIngress</a>()) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">checkCreateDeferredIngress</a>();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;emplace(<a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>, <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa786329b34bbe53ab40a54a19cd597f2d">HTTPEvent::Type::BODY</a>,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                              std::move(chain));</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued ingress event of type &quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa786329b34bbe53ab40a54a19cd597f2d">HTTPEvent::Type::BODY</a></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; size=&quot;</span> &lt;&lt; len &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    CHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#ae0cfefc1b0658621476f39cba28d9505">free</a>(len));</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0e0d2e99d0604ab973cd67a374184b0e">processIngressBody</a>(std::move(chain), len);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a0e0d2e99d0604ab973cd67a374184b0e">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0e0d2e99d0604ab973cd67a374184b0e">HTTPTransaction::processIngressBody</a>(unique_ptr&lt;IOBuf&gt; chain, <span class="keywordtype">size_t</span> len) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  FOLLY_SCOPED_TRACE_SECTION(<span class="stringliteral">&quot;HTTPTransaction - processIngressBody&quot;</span>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">refreshTimeout</a>();</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a81b96f75e461f7e176e3178040486b56">notifyIngressBodyProcessed</a>(len);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>()) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a56a25d7fb8ac5ddf1ed5b16eaca3c5df">onBody</a>(std::move(chain));</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">isIngressEOMSeen</a>()) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a> += len;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a> &gt; 0) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        uint32_t divisor = 2;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a8c6aa03b14a2f69b5672f8b8b9e61b04">isDraining</a>()) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <span class="comment">// only send window updates for draining transports when window is</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <span class="comment">// closed</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          divisor = 1;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">if</span> (uint32_t(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a>) &gt;= (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a59e739a83cce8a0fc22c9dce48a0b193">getCapacity</a>() / divisor)) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <a class="code" href="classproxygen_1_1HTTPTransaction.html#a715b0b12bf67788bf0db9318e3d61e14">flushWindowUpdate</a>();</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    } <span class="comment">// else don&#39;t care about window updates</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a40868f9faa2e3b0a095a56ec4da4057e">  309</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a40868f9faa2e3b0a095a56ec4da4057e">HTTPTransaction::onIngressChunkHeader</a>(<span class="keywordtype">size_t</span> length) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">validateIngressStateTransition</a>(</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        HTTPTransactionIngressSM::Event::onChunkHeader)) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">mustQueueIngress</a>()) {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">checkCreateDeferredIngress</a>();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;emplace(<a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>, <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa7c176223c0dc5d3e1e28b29b6a3d7221">HTTPEvent::Type::CHUNK_HEADER</a>, length);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued ingress event of type &quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa7c176223c0dc5d3e1e28b29b6a3d7221">HTTPEvent::Type::CHUNK_HEADER</a></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; size=&quot;</span> &lt;&lt; length &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#acf377e6941a4b536de594a81cbe06d8b">processIngressChunkHeader</a>(length);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#acf377e6941a4b536de594a81cbe06d8b">  324</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#acf377e6941a4b536de594a81cbe06d8b">HTTPTransaction::processIngressChunkHeader</a>(<span class="keywordtype">size_t</span> length) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">refreshTimeout</a>();</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>()) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#aa760cd4a327aaa62293b1d09c5811298">onChunkHeader</a>(length);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#ade30487710a3c3b15441fe518dc4394e">  335</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#ade30487710a3c3b15441fe518dc4394e">HTTPTransaction::onIngressChunkComplete</a>() {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">validateIngressStateTransition</a>(</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        HTTPTransactionIngressSM::Event::onChunkComplete)) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">mustQueueIngress</a>()) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">checkCreateDeferredIngress</a>();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;emplace(<a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>, <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fae0fc80012eacfd179a3045b6a25d921d">HTTPEvent::Type::CHUNK_COMPLETE</a>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued ingress event of type &quot;</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            &lt;&lt; <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fae0fc80012eacfd179a3045b6a25d921d">HTTPEvent::Type::CHUNK_COMPLETE</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#acdd10519941d283b375243d7420d6fa2">processIngressChunkComplete</a>();</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#acdd10519941d283b375243d7420d6fa2">  350</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#acdd10519941d283b375243d7420d6fa2">HTTPTransaction::processIngressChunkComplete</a>() {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">refreshTimeout</a>();</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>()) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#ad4befff61cff93d6e2c9459e39556419">onChunkComplete</a>();</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a233a1f58c07415b031e1636a6333a172">  361</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a233a1f58c07415b031e1636a6333a172">HTTPTransaction::onIngressTrailers</a>(unique_ptr&lt;HTTPHeaders&gt; trailers) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">validateIngressStateTransition</a>(</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        HTTPTransactionIngressSM::Event::onTrailers)) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">mustQueueIngress</a>()) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">checkCreateDeferredIngress</a>();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;emplace(<a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>, <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa1f8ec8636df593e722e9631642eabc74">HTTPEvent::Type::TRAILERS_COMPLETE</a>,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        std::move(trailers));</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued ingress event of type &quot;</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            &lt;&lt; <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa1f8ec8636df593e722e9631642eabc74">HTTPEvent::Type::TRAILERS_COMPLETE</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa42ddb3266af71bfe85f7d925f687137">processIngressTrailers</a>(std::move(trailers));</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aa42ddb3266af71bfe85f7d925f687137">  377</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa42ddb3266af71bfe85f7d925f687137">HTTPTransaction::processIngressTrailers</a>(unique_ptr&lt;HTTPHeaders&gt; trailers) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">refreshTimeout</a>();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>()) {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a219de67110f915deda30d18327f26393">onTrailers</a>(std::move(trailers));</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a259ca72274b3d7924710c282eeef5823">  388</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a259ca72274b3d7924710c282eeef5823">HTTPTransaction::onIngressUpgrade</a>(<a class="code" href="namespaceproxygen.html#a7feed732013b7cc0e2213b19c7b82745">UpgradeProtocol</a> protocol) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">validateIngressStateTransition</a>(</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        HTTPTransactionIngressSM::Event::onUpgrade)) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">mustQueueIngress</a>()) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">checkCreateDeferredIngress</a>();</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;emplace(<a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>, <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa7f10b7b76869bf2e029b6ce4632e1323">HTTPEvent::Type::UPGRADE</a>, protocol);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued ingress event of type &quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa7f10b7b76869bf2e029b6ce4632e1323">HTTPEvent::Type::UPGRADE</a></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a81313661e5baf7b3ccacb41a9275eafb">processIngressUpgrade</a>(protocol);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a81313661e5baf7b3ccacb41a9275eafb">  403</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a81313661e5baf7b3ccacb41a9275eafb">HTTPTransaction::processIngressUpgrade</a>(<a class="code" href="namespaceproxygen.html#a7feed732013b7cc0e2213b19c7b82745">UpgradeProtocol</a> protocol) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>()) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#acda954bf78c4d2aad951698e78c40a0f">onUpgrade</a>(protocol);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#af49f69623208256d6af6d317f7ba8cd4">  413</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#af49f69623208256d6af6d317f7ba8cd4">HTTPTransaction::onIngressEOM</a>() {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">isIngressEOMSeen</a>()) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// This can happen when HTTPSession calls onIngressEOF()</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">sendAbort</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba795fcd4a9695a63ff230ad23d4122917">ErrorCode::STREAM_CLOSED</a>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a>.hasValue() &amp;&amp;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a>.value() &gt; 0) {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keyword">auto</span> errorMsg = folly::to&lt;std::string&gt;(</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="stringliteral">&quot;Content-Length/body mismatch: expecting another &quot;</span>,</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">expectedContentLengthRemaining_</a>.value());</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; errorMsg &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="classproxygen_1_1HTTPException.html">HTTPException</a> ex(<a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954aedb8d33af4486e6873c54224f6cc10ef">HTTPException::Direction::INGRESS</a>, errorMsg);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      ex.<a class="code" href="classproxygen_1_1Exception.html#a96189a5e5d3636599b7af7337437e77f">setProxygenError</a>(<a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da71d1707a93df7151bf58b8a5f6030846">kErrorParseBody</a>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">onError</a>(ex);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">// TODO: change the codec to not give an EOM callback after a 100 response?</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// We could then delete the below &#39;if&#39;</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a91147cca992f750017bd431e85952006">isUpstream</a>() &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1aeab9bd4392274da1b4273ada925ee">extraResponseExpected</a>()) {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Ignoring EOM on initial 100 response on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">validateIngressStateTransition</a>(</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        HTTPTransactionIngressSM::Event::onEOM)) {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">// We need to update the read timeout here.  We&#39;re not likely to be</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// expecting any more ingress, and the timer should be cancelled</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// immediately.  If we are expecting more, this will reset the timer.</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">updateReadTimeout</a>();</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">mustQueueIngress</a>()) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">checkCreateDeferredIngress</a>();</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;emplace(<a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>, <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa54f5ce060c26e64cc1fdea3c2f602000">HTTPEvent::Type::MESSAGE_COMPLETE</a>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued ingress event of type &quot;</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            &lt;&lt; <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa54f5ce060c26e64cc1fdea3c2f602000">HTTPEvent::Type::MESSAGE_COMPLETE</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a6df2dac550e90e25d05a86e6f6050944">processIngressEOM</a>();</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a6df2dac550e90e25d05a86e6f6050944">  457</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a6df2dac550e90e25d05a86e6f6050944">HTTPTransaction::processIngressEOM</a>() {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>) {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;ingress EOM on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> wasComplete = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>();</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">validateIngressStateTransition</a>(</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        HTTPTransactionIngressSM::Event::eomFlushed)) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (!wasComplete) {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#afdc4d4dec715841ba0c5bb5e58b1d53c">onEOM</a>();</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">markEgressComplete</a>();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">updateReadTimeout</a>();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a89082f763904815911bb62430ba5f24a">  478</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a89082f763904815911bb62430ba5f24a">HTTPTransaction::isExpectingWindowUpdate</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a> != HTTPTransactionEgressSM::State::SendingDone &amp;&amp;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;         <a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a> &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a769103af9c73585fd33b8dc686d06c65">getSize</a>() &lt;= 0;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a9af3fdd59bf5bc30fbac8ff564abe5e9">  483</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a9af3fdd59bf5bc30fbac8ff564abe5e9">HTTPTransaction::isExpectingIngress</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a89082f763904815911bb62430ba5f24a">isExpectingWindowUpdate</a>() || (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">isIngressEOMSeen</a>());</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">  487</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">HTTPTransaction::updateReadTimeout</a>() {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a9af3fdd59bf5bc30fbac8ff564abe5e9">isExpectingIngress</a>()) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">refreshTimeout</a>();</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    cancelTimeout();</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  }</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a22ec9e51f55497dc4dca424a463b4a54">  495</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a22ec9e51f55497dc4dca424a463b4a54">HTTPTransaction::markIngressComplete</a>() {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Marking ingress complete on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4635c6fb2e6d001200f39ea32197af09">ingressState_</a> = HTTPTransactionIngressSM::State::ReceivingDone;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>.reset();</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  cancelTimeout();</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;}</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">  502</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">HTTPTransaction::markEgressComplete</a>() {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Marking egress complete on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength() &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>()) {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    int64_t deferredEgressBodyBytes =</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      folly::to&lt;int64_t&gt;(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength());</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a9ac88e461ed34742fde46678d52392fc">notifyEgressBodyBuffered</a>(-deferredEgressBodyBytes);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.move();</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>()) {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4e30ff9c01ee4576834fa7831ea3f42c">dequeue</a>();</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a> = HTTPTransactionEgressSM::State::SendingDone;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">  516</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">HTTPTransaction::validateIngressStateTransition</a>(</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <a class="code" href="classproxygen_1_1StateMachine.html#a35c97a192fb193482e41b6dc2fde9ab1">HTTPTransactionIngressSM::Event</a> event) {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">HTTPTransactionIngressSM::transit</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4635c6fb2e6d001200f39ea32197af09">ingressState_</a>, event)) {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    std::stringstream ss;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Invalid ingress state transition, state=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4635c6fb2e6d001200f39ea32197af09">ingressState_</a> &lt;&lt;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="stringliteral">&quot;, event=&quot;</span> &lt;&lt; <span class="keyword">event</span> &lt;&lt; <span class="stringliteral">&quot;, streamID=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="classproxygen_1_1HTTPException.html">HTTPException</a> ex(<a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb">HTTPException::Direction::INGRESS_AND_EGRESS</a>, ss.str());</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    ex.<a class="code" href="classproxygen_1_1Exception.html#a96189a5e5d3636599b7af7337437e77f">setProxygenError</a>(<a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da973718c9a40010086e7ba12e4b1bc07d">kErrorIngressStateTransition</a>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    ex.setCodecStatusCode(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9bae8c0c70879b5895c615677261d64a1ee">ErrorCode::INTERNAL_ERROR</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// This will invoke sendAbort() and also inform the handler of the</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// error and detach the handler.</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">onError</a>(ex);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">  535</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">HTTPTransaction::onError</a>(<span class="keyword">const</span> <a class="code" href="classproxygen_1_1HTTPException.html">HTTPException</a>&amp; error) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> wasAborted = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>; <span class="comment">// see comment below</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> wasEgressComplete = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0f5cf49d49de555ca71b92b5b5a7e38b">isEgressComplete</a>();</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> wasIngressComplete = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>();</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordtype">bool</span> notify = (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954">HTTPException::Direction</a> direction = error.<a class="code" href="classproxygen_1_1HTTPException.html#a18964033ec0f831ef02f6305d7409e46">getDirection</a>();</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">if</span> (direction == <a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954aedb8d33af4486e6873c54224f6cc10ef">HTTPException::Direction::INGRESS</a> &amp;&amp;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">isIngressEOMSeen</a>() &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a89082f763904815911bb62430ba5f24a">isExpectingWindowUpdate</a>()) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// we got an ingress error, we&#39;ve seen the entire message, but we&#39;re</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// expecting more (window updates).  These aren&#39;t coming, convert to</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// INGRESS_AND_EGRESS</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Converting ingress error to ingress+egress due to&quot;</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="stringliteral">&quot; flow control, and aborting &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    direction = <a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb">HTTPException::Direction::INGRESS_AND_EGRESS</a>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">sendAbort</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba20973c7b1b8e3fe85f3926d10271a8d4">ErrorCode::FLOW_CONTROL_ERROR</a>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">if</span> (error.<a class="code" href="classproxygen_1_1Exception.html#af1367ee45a543354d6527bcc1f17a059">getProxygenError</a>() == <a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da6e26e85744e3af152c1be71750ec85b0">kErrorStreamAbort</a>) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    DCHECK(error.<a class="code" href="classproxygen_1_1HTTPException.html#a18964033ec0f831ef02f6305d7409e46">getDirection</a>() ==</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;           <a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb">HTTPException::Direction::INGRESS_AND_EGRESS</a>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (error.<a class="code" href="classproxygen_1_1HTTPException.html#a45d6add97607abbb4a2795980850d8ef">hasCodecStatusCode</a>()) {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    DCHECK(error.<a class="code" href="classproxygen_1_1HTTPException.html#a18964033ec0f831ef02f6305d7409e46">getDirection</a>() ==</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;           <a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb">HTTPException::Direction::INGRESS_AND_EGRESS</a>);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">sendAbort</a>(error.<a class="code" href="classproxygen_1_1HTTPException.html#a8a9f5f138aacf5b6c305ae0fd398a0ff">getCodecStatusCode</a>());</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">switch</span> (direction) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb">HTTPException::Direction::INGRESS_AND_EGRESS</a>:</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">markEgressComplete</a>();</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a22ec9e51f55497dc4dca424a463b4a54">markIngressComplete</a>();</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordflow">if</span> (wasEgressComplete &amp;&amp; wasIngressComplete &amp;&amp;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          <span class="comment">// We mark egress complete before we get acknowledgement of the</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;          <span class="comment">// write segment finishing successfully.</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          <span class="comment">// TODO: instead of using DestructorGuard hacks to keep txn around,</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          <span class="comment">// use an explicit callback function and set egress complete after</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;          <span class="comment">// last byte flushes (or egress error occurs), see #3912823</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;          (error.<a class="code" href="classproxygen_1_1Exception.html#af1367ee45a543354d6527bcc1f17a059">getProxygenError</a>() != <a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da60580b04a0444f809e2270068d934fa5">kErrorWriteTimeout</a> || wasAborted)) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        notify = <span class="keyword">false</span>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a5ba463f336572a8840e1e782bb0be238">HTTPException::Direction::EGRESS</a>:</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">markEgressComplete</a>();</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">if</span> (!wasEgressComplete &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">isIngressEOMSeen</a>() &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a93621220dbc29ef70ba34d0bcb245913">ingressErrorSeen_</a>) {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="comment">// we&#39;ve already seen an ingress error but we ignored it, hoping the</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">// handler would resume and read our queued EOM.  Now both sides are</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="comment">// dead and we need to kill this transaction.</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a22ec9e51f55497dc4dca424a463b4a54">markIngressComplete</a>();</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordflow">if</span> (wasEgressComplete) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        notify = <span class="keyword">false</span>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954aedb8d33af4486e6873c54224f6cc10ef">HTTPException::Direction::INGRESS</a>:</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">isIngressEOMSeen</a>()) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// Not an error, for now</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a93621220dbc29ef70ba34d0bcb245913">ingressErrorSeen_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a22ec9e51f55497dc4dca424a463b4a54">markIngressComplete</a>();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">if</span> (wasIngressComplete) {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        notify = <span class="keyword">false</span>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">if</span> (notify &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">// mark egress complete may result in handler detaching</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a585c21327eb30ab85ebdb84f663dab3b">onError</a>(error);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;}</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a5aa84f5d6023b600935a8ff16177e28a">  609</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5aa84f5d6023b600935a8ff16177e28a">HTTPTransaction::onGoaway</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9b">ErrorCode</a> code) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;received GOAWAY notification on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// This callback can be received at any time and does not affect this</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="comment">// transaction&#39;s ingress or egress state machines. If it would have</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="comment">// affected this transaction&#39;s state, we would have received onError()</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="comment">// instead.</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#abe33bf69be66a24c82a38b13ee087b42">onGoaway</a>(code);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a5a70b3675a5cfdd66137a4243a2c585e">  621</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5a70b3675a5cfdd66137a4243a2c585e">HTTPTransaction::onIngressTimeout</a>() {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;ingress timeout on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a70de40060357331a03b389ddfa3256e7">pauseIngress</a>();</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordtype">bool</span> windowUpdateTimeout = !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0f5cf49d49de555ca71b92b5b5a7e38b">isEgressComplete</a>() &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a89082f763904815911bb62430ba5f24a">isExpectingWindowUpdate</a>();</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span> (windowUpdateTimeout) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="classproxygen_1_1HTTPException.html">HTTPException</a> ex(<a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb">HTTPException::Direction::INGRESS_AND_EGRESS</a>,</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          folly::to&lt;std::string&gt;(<span class="stringliteral">&quot;ingress timeout, streamID=&quot;</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>));</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      ex.<a class="code" href="classproxygen_1_1Exception.html#a96189a5e5d3636599b7af7337437e77f">setProxygenError</a>(<a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da60580b04a0444f809e2270068d934fa5">kErrorWriteTimeout</a>);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="comment">// This is a protocol error</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      ex.<a class="code" href="classproxygen_1_1HTTPException.html#a3dc0e569f9753f484a6e26ac0c8ab5c3">setCodecStatusCode</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba23f149f0f9ae9ed9e0119e7209178a5d">ErrorCode::PROTOCOL_ERROR</a>);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">onError</a>(ex);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <a class="code" href="classproxygen_1_1HTTPException.html">HTTPException</a> ex(<a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954aedb8d33af4486e6873c54224f6cc10ef">HTTPException::Direction::INGRESS</a>,</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;          folly::to&lt;std::string&gt;(<span class="stringliteral">&quot;ingress timeout, streamID=&quot;</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>));</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      ex.<a class="code" href="classproxygen_1_1Exception.html#a96189a5e5d3636599b7af7337437e77f">setProxygenError</a>(<a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956dac8d82d9d46b9904442f90190d8aeb099">kErrorTimeout</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">onError</a>(ex);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a22ec9e51f55497dc4dca424a463b4a54">markIngressComplete</a>();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">markEgressComplete</a>();</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;}</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a2b1ed029d994147d82f666d1069b1ee7">  646</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b1ed029d994147d82f666d1069b1ee7">HTTPTransaction::onIngressWindowUpdate</a>(<span class="keyword">const</span> uint32_t amount) {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a>) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Remote side ack&#39;d &quot;</span> &lt;&lt; amount &lt;&lt; <span class="stringliteral">&quot; bytes &quot;</span> &lt;&lt; *this ;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">updateReadTimeout</a>();</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#ae0cfefc1b0658621476f39cba28d9505">free</a>(amount)) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">notifyTransportPendingEgress</a>();</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; <span class="stringliteral">&quot;sendWindow_.free failed with amount=&quot;</span> &lt;&lt; amount</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; capacity=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a59e739a83cce8a0fc22c9dce48a0b193">getCapacity</a>()</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; outstanding=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a3262de58877c59dd8367caa96088a30e">getOutstanding</a>()</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">sendAbort</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba20973c7b1b8e3fe85f3926d10271a8d4">ErrorCode::FLOW_CONTROL_ERROR</a>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a2e8861dbc6a86b7cb4b569737c2768cf">  664</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2e8861dbc6a86b7cb4b569737c2768cf">HTTPTransaction::onIngressSetSendWindow</a>(<span class="keyword">const</span> uint32_t newWindowSize) {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a>) {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">updateReadTimeout</a>();</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a5e0843cdb55c9c3ffd1cfe3e2e1f25f2">setCapacity</a>(newWindowSize)) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">notifyTransportPendingEgress</a>();</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; <span class="stringliteral">&quot;sendWindow_.setCapacity failed with newWindowSize=&quot;</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;               &lt;&lt; newWindowSize &lt;&lt; <span class="stringliteral">&quot; capacity=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a59e739a83cce8a0fc22c9dce48a0b193">getCapacity</a>()</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; outstanding=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a3262de58877c59dd8367caa96088a30e">getOutstanding</a>()</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">sendAbort</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba20973c7b1b8e3fe85f3926d10271a8d4">ErrorCode::FLOW_CONTROL_ERROR</a>);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;}</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aac4c2173a96b0cad3788385bad57fc44">  680</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aac4c2173a96b0cad3788385bad57fc44">HTTPTransaction::onEgressTimeout</a>() {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;egress timeout on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="classproxygen_1_1HTTPException.html">HTTPException</a> ex(<a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a5ba463f336572a8840e1e782bb0be238">HTTPException::Direction::EGRESS</a>,</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      folly::to&lt;std::string&gt;(<span class="stringliteral">&quot;egress timeout, streamID=&quot;</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>));</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    ex.<a class="code" href="classproxygen_1_1Exception.html#a96189a5e5d3636599b7af7337437e77f">setProxygenError</a>(<a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956dac8d82d9d46b9904442f90190d8aeb099">kErrorTimeout</a>);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">onError</a>(ex);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">markEgressComplete</a>();</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a83b433ee00e2d1ab6a28417dd487345a">  693</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a83b433ee00e2d1ab6a28417dd487345a">HTTPTransaction::onEgressHeaderFirstByte</a>() {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#a9c02c5e17cca8e78b7cd6fe92ccdccba">firstHeaderByteFlushed</a>();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;}</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#abd55976c86db66e98b1f45ec5802fee5">  700</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#abd55976c86db66e98b1f45ec5802fee5">HTTPTransaction::onEgressBodyFirstByte</a>() {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#a464cd5c01e33a077256f95de31463c26">firstByteFlushed</a>();</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aa020c58a0e0c82bc5598b01e369bdeb1">  707</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa020c58a0e0c82bc5598b01e369bdeb1">HTTPTransaction::onEgressBodyLastByte</a>() {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#ab689d82403553c69944197d9fbbeedf1">lastByteFlushed</a>();</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;}</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a6102abd70fb8d9e25302e73cdd0ab73e">  714</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a6102abd70fb8d9e25302e73cdd0ab73e">HTTPTransaction::onEgressTrackedByte</a>() {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#a690ec40de2214b704962e7d4af558239">trackedByteFlushed</a>();</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;}</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a12c9413175f9eba01ce7c2f794feda10">  721</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a12c9413175f9eba01ce7c2f794feda10">HTTPTransaction::onEgressLastByteAck</a>(std::chrono::milliseconds latency) {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#a08a22f1b3b1b494d43aa839483f93715">lastByteAcked</a>(latency);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;}</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a2bd620e0eb5287c2b63a1a228d7c50e0">  728</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2bd620e0eb5287c2b63a1a228d7c50e0">HTTPTransaction::sendHeadersWithOptionalEOM</a>(</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keyword">const</span> <a class="code" href="classproxygen_1_1HTTPMessage.html">HTTPMessage</a>&amp; headers,</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">bool</span> eom) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  CHECK(<a class="code" href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">HTTPTransactionEgressSM::transit</a>(</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;          <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a>, HTTPTransactionEgressSM::Event::sendHeaders));</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  DCHECK(!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0f5cf49d49de555ca71b92b5b5a7e38b">isEgressComplete</a>());</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">if</span> (!headers.<a class="code" href="classproxygen_1_1HTTPMessage.html#ac77cbdbc9a043493083ef046870d04c6">isRequest</a>() &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#aec29fb741786a8bcfe781a9a809e0159">isPushed</a>()) {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ab0fac97a4fe14aebb9f05f9751ec428f">lastResponseStatus_</a> = headers.<a class="code" href="classproxygen_1_1HTTPMessage.html#ac064c15b921026a767bf252aee16e8ef">getStatusCode</a>();</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">if</span> (headers.<a class="code" href="classproxygen_1_1HTTPMessage.html#ac77cbdbc9a043493083ef046870d04c6">isRequest</a>()) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a6a1acbd434b94259956a083014a485e6">headRequest_</a> = (headers.<a class="code" href="classproxygen_1_1HTTPMessage.html#ab5c428825d6d2c1d3edb7babd36f5064">getMethod</a>() == <a class="code" href="namespaceproxygen.html#a708d14cbb2dacbfffbe455f5b7941fffae15e216fc1c639f787b1231ecdfa1bf8">HTTPMethod::HEAD</a>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">if</span> (headers.<a class="code" href="classproxygen_1_1HTTPMessage.html#aca0cf87662b02d51fc9c3588ab93069e">isResponse</a>() &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a6a1acbd434b94259956a083014a485e6">headRequest_</a>) {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; contentLen =</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      headers.<a class="code" href="classproxygen_1_1HTTPMessage.html#a2ba4953e1ab061fe5eb68af08e684772">getHeaders</a>().<a class="code" href="classproxygen_1_1HTTPHeaders.html#aa14bc0e99fc0ebe98fb95b7cff1bb598">getSingleOrEmpty</a>(HTTP_HEADER_CONTENT_LENGTH);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (!contentLen.empty()) {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="keywordflow">try</span> {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac15f2ce834f719ef4e9350edb51d688d">expectedResponseLength_</a> = folly::to&lt;uint64_t&gt;(contentLen);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      } <span class="keywordflow">catch</span> (<span class="keyword">const</span> folly::ConversionError&amp; ex) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; <span class="stringliteral">&quot;Invalid content-length: &quot;</span> &lt;&lt; contentLen &lt;&lt;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="stringliteral">&quot;, ex=&quot;</span> &lt;&lt; ex.what() &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <a class="code" href="namespaceproxygen.html#a3229605c4d71bcf5379d0dd133870421">HTTPHeaderSize</a> size;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a4471d40c95555b058e2721955e432fea">sendHeaders</a>(<span class="keyword">this</span>, headers, &amp;size, eom);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#a8c465da22a769b3cae95ce03e71f7456">headerBytesGenerated</a>(size);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2019b1e0b9d117ac14a2843035913769">updateEgressCompressionInfo</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a50773010568880d549b9de1cc710f51c">getCodec</a>().<a class="code" href="classproxygen_1_1HTTPCodec.html#a4e0b7580b74da507c77553ef7891bc0e">getCompressionInfo</a>());</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> (eom) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    CHECK(<a class="code" href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">HTTPTransactionEgressSM::transit</a>(</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a>, HTTPTransactionEgressSM::Event::sendEOM));</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">// trailers are supported in this case:</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">// trailers are for chunked encoding-transfer of a body</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#afc053d6a939eec4c3794c07132f7be82">bodyBytesGenerated</a>(0);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    CHECK(<a class="code" href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">HTTPTransactionEgressSM::transit</a>(</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;          <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a>, HTTPTransactionEgressSM::Event::eomFlushed));</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a715b0b12bf67788bf0db9318e3d61e14">flushWindowUpdate</a>();</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a2a0b9456073184f5b19efccaf5b08c13">  773</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2a0b9456073184f5b19efccaf5b08c13">HTTPTransaction::sendHeadersWithEOM</a>(<span class="keyword">const</span> <a class="code" href="classproxygen_1_1HTTPMessage.html">HTTPMessage</a>&amp; header) {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2bd620e0eb5287c2b63a1a228d7c50e0">sendHeadersWithOptionalEOM</a>(header, <span class="keyword">true</span>);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;}</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a18c3300cbce5fcdb167dbfb6cc073e65">  777</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a18c3300cbce5fcdb167dbfb6cc073e65">HTTPTransaction::sendHeaders</a>(<span class="keyword">const</span> <a class="code" href="classproxygen_1_1HTTPMessage.html">HTTPMessage</a>&amp; header) {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2bd620e0eb5287c2b63a1a228d7c50e0">sendHeadersWithOptionalEOM</a>(header, <span class="keyword">false</span>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aea212f62c9bfdd6facd1667a624abce6">  781</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aea212f62c9bfdd6facd1667a624abce6">HTTPTransaction::sendBody</a>(std::unique_ptr&lt;folly::IOBuf&gt; body) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  DestructorGuard guard(<span class="keyword">this</span>);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordtype">bool</span> chunking =</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    ((<a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a> == HTTPTransactionEgressSM::State::ChunkHeaderSent) &amp;&amp;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;     !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a50773010568880d549b9de1cc710f51c">getCodec</a>().<a class="code" href="classproxygen_1_1HTTPCodec.html#a8dfbc8c5bee0947e718742e541259be2">supportsParallelRequests</a>());  <span class="comment">// see sendChunkHeader</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  CHECK(<a class="code" href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">HTTPTransactionEgressSM::transit</a>(</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a>, HTTPTransactionEgressSM::Event::sendBody));</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordflow">if</span> (body) {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">size_t</span> bodyLen = body-&gt;computeChainDataLength();</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac49a1ef5d00655ff061197d8c741b74c">actualResponseLength_</a> = <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac49a1ef5d00655ff061197d8c741b74c">actualResponseLength_</a>.value() + bodyLen;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">if</span> (chunking) {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="comment">// Note, this check doesn&#39;t account for cases where sendBody is called</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="comment">// multiple times for a single chunk, and the total length exceeds the</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="comment">// header.</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      DCHECK(!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a590f2fa2f962dd1c349bd5362c0bb115">chunkHeaders_</a>.empty());</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      DCHECK_LE(bodyLen, <a class="code" href="classproxygen_1_1HTTPTransaction.html#a590f2fa2f962dd1c349bd5362c0bb115">chunkHeaders_</a>.back().length)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Sent body longer than chunk header &quot;</span>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>()) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a9ac88e461ed34742fde46678d52392fc">notifyEgressBodyBuffered</a>(bodyLen);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  }</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.append(std::move(body));</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">notifyTransportPendingEgress</a>();</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;}</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#ae5960b3f86681f8df51ac9300cf5595b">  810</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae5960b3f86681f8df51ac9300cf5595b">HTTPTransaction::onWriteReady</a>(<span class="keyword">const</span> uint32_t maxEgress, <span class="keywordtype">double</span> ratio) {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  DCHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>());</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>) {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08ccd95211616539ef13b9950f719161">updateRelativeWeight</a>(ratio);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a924c9548b4cd45d9960e9907a5054c71">cumulativeRatio_</a> += ratio;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a101815c9d188a04309b686780da3f42d">egressCalls_</a>++;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a35558444e6e7864fdc097e1263a27b3c">sendDeferredBody</a>(maxEgress);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>();</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;}</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">// Send up to maxEgress body bytes, including pendingEOM if appropriate</span></div><div class="line"><a name="l00823"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a35558444e6e7864fdc097e1263a27b3c">  823</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a35558444e6e7864fdc097e1263a27b3c">HTTPTransaction::sendDeferredBody</a>(<span class="keyword">const</span> uint32_t maxEgress) {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keyword">const</span> int32_t windowAvailable = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a769103af9c73585fd33b8dc686d06c65">getSize</a>();</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keyword">const</span> uint32_t sendWindow = <a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a> ? std::min&lt;uint32_t&gt;(</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    maxEgress, windowAvailable &gt; 0 ? windowAvailable : 0) : maxEgress;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="comment">// We shouldn&#39;t be called if we have no pending body/EOM, egress is paused, or</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="comment">// the send window is closed</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  CHECK((<a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength() &gt; 0 ||</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;         <a class="code" href="classproxygen_1_1HTTPTransaction.html#a3fb44b6e36a49d30e44e67eb1c789bfc">isEgressEOMQueued</a>()) &amp;&amp;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        sendWindow &gt; 0);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">size_t</span> bytesLeft = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength();</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordtype">size_t</span> canSend = std::min&lt;size_t&gt;(sendWindow, bytesLeft);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#afe7278404a7436993d005c0ce752931b">maybeDelayForRateLimit</a>()) {</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// Timeout will call notifyTransportPendingEgress again</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordtype">size_t</span> curLen = 0;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordtype">size_t</span> nbytes = 0;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordtype">bool</span> willSendEOM = <span class="keyword">false</span>;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a590f2fa2f962dd1c349bd5362c0bb115">chunkHeaders_</a>.empty()) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    curLen = canSend;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    std::unique_ptr&lt;IOBuf&gt; body = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.split(curLen);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    willSendEOM = <a class="code" href="classproxygen_1_1HTTPTransaction.html#ab32157f5fafa1cec6e22685c5f7b529e">hasPendingEOM</a>();</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    DCHECK(curLen &gt; 0 || willSendEOM);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span> (curLen &gt; 0) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="keywordflow">if</span> (willSendEOM) {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="comment">// we have to dequeue BEFORE sending the EOM =(</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4e30ff9c01ee4576834fa7831ea3f42c">dequeue</a>();</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      nbytes = <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa0acb82e5fec7d6ab61c9e5ac2a54f09">sendBodyNow</a>(std::move(body), curLen, willSendEOM);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      willSendEOM = <span class="keyword">false</span>;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    } <span class="comment">// else we got called with only a pending EOM, handled below</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// This body is expliticly chunked</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a590f2fa2f962dd1c349bd5362c0bb115">chunkHeaders_</a>.empty() &amp;&amp; canSend &gt; 0) {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <a class="code" href="structproxygen_1_1HTTPTransaction_1_1Chunk.html">Chunk</a>&amp; chunk = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a590f2fa2f962dd1c349bd5362c0bb115">chunkHeaders_</a>.front();</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">if</span> (!chunk.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1Chunk.html#af044d194d523fbce539790e034449240">headerSent</a>) {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        nbytes += <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#af21bcdf1b2e19d5817252a8af9bcc1d6">sendChunkHeader</a>(<span class="keyword">this</span>, chunk.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1Chunk.html#abdf4b50799a3323b6bb5417eb4f010cf">length</a>);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        chunk.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1Chunk.html#af044d194d523fbce539790e034449240">headerSent</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      curLen = std::min&lt;size_t&gt;(chunk.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1Chunk.html#abdf4b50799a3323b6bb5417eb4f010cf">length</a>, canSend);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      std::unique_ptr&lt;folly::IOBuf&gt; cur = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.split(curLen);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      VLOG(4) &lt;&lt; <span class="stringliteral">&quot;sending &quot;</span> &lt;&lt; curLen &lt;&lt; <span class="stringliteral">&quot; fin=false&quot;</span>;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      nbytes += <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa0acb82e5fec7d6ab61c9e5ac2a54f09">sendBodyNow</a>(std::move(cur), curLen, <span class="keyword">false</span>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      canSend -= curLen;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      chunk.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1Chunk.html#abdf4b50799a3323b6bb5417eb4f010cf">length</a> -= curLen;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keywordflow">if</span> (chunk.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1Chunk.html#abdf4b50799a3323b6bb5417eb4f010cf">length</a> == 0) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        nbytes += <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#af62ff7bd7b8f57ee839d95fcbdecd498">sendChunkTerminator</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a590f2fa2f962dd1c349bd5362c0bb115">chunkHeaders_</a>.pop_front();</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        DCHECK_EQ(canSend, 0);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    willSendEOM = <a class="code" href="classproxygen_1_1HTTPTransaction.html#ab32157f5fafa1cec6e22685c5f7b529e">hasPendingEOM</a>();</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="comment">// Send any queued eom</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keywordflow">if</span> (willSendEOM) {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    nbytes += <a class="code" href="classproxygen_1_1HTTPTransaction.html#a471d51265eceb6262ac25f9cf115f105">sendEOMNow</a>();</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">// Update the handler&#39;s pause state</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">notifyTransportPendingEgress</a>();</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#afc053d6a939eec4c3794c07132f7be82">bodyBytesGenerated</a>(nbytes);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">return</span> nbytes;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;}</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#afe7278404a7436993d005c0ce752931b">  897</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#afe7278404a7436993d005c0ce752931b">HTTPTransaction::maybeDelayForRateLimit</a>() {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4be280b06dbdc5c8f9bc01fa9edd1387">egressLimitBytesPerMs_</a> &lt;= 0) {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// No rate limiting</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4a2269f00d4980b9799843f94fb2dc09">numLimitedBytesEgressed_</a> == 0) {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">// If we haven&#39;t egressed any bytes yet, don&#39;t delay.</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  int64_t limitedDurationMs = (int64_t) <a class="code" href="namespaceproxygen.html#ae94f36adf5ce28528d9e34c9ba9cc5f8">millisecondsBetween</a>(</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="namespaceproxygen.html#a09b325f9c0aa18197dfeebb7f0533a49">getCurrentTime</a>(),</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac7f3655a5f69420aacf1501ce1d4818d">startRateLimit_</a></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  ).count();</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">// Algebra!  Try to figure out the next time send where we&#39;ll</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">// be allowed to send at least 1 full packet&#39;s worth.  The</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// formula we&#39;re using is:</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">//   (bytesSoFar + packetSize) / (timeSoFar + delay) == targetRateLimit</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  std::chrono::milliseconds requiredDelay(</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    (</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;     ((int64_t)<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4a2269f00d4980b9799843f94fb2dc09">numLimitedBytesEgressed_</a> + kApproximateMTU) -</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;     ((int64_t)<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4be280b06dbdc5c8f9bc01fa9edd1387">egressLimitBytesPerMs_</a> * limitedDurationMs)</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    ) / (int64_t)<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4be280b06dbdc5c8f9bc01fa9edd1387">egressLimitBytesPerMs_</a></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  );</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">if</span> (requiredDelay.count() &lt;= 0) {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">// No delay required</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">if</span> (requiredDelay &gt; kRateLimitMaxDelay) {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">// The delay should never be this long</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;ratelim: Required delay too long (&quot;</span> &lt;&lt; requiredDelay.count()</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;ms), ignoring&quot;</span>;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">// Delay required</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ab2728d681b3faa0ebe646adbb1b0b25c">egressRateLimited_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4913894bc6b9ffd5a1fc61fd0913e94e">timer_</a>) {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4913894bc6b9ffd5a1fc61fd0913e94e">timer_</a>-&gt;scheduleTimeout(&amp;<a class="code" href="classproxygen_1_1HTTPTransaction.html#a86b018f195a82e4838b615839336f4d9">rateLimitCallback_</a>, requiredDelay);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">notifyTransportPendingEgress</a>();</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;}</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a030cb3bae08736b2a9e57877f31cf9c0">  948</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a030cb3bae08736b2a9e57877f31cf9c0">HTTPTransaction::rateLimitTimeoutExpired</a>() {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ab2728d681b3faa0ebe646adbb1b0b25c">egressRateLimited_</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">notifyTransportPendingEgress</a>();</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;}</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a471d51265eceb6262ac25f9cf115f105">  953</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a471d51265eceb6262ac25f9cf115f105">HTTPTransaction::sendEOMNow</a>() {</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;egress EOM on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">// TODO: with ByteEvent refactor, we will have to delay changing this</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="comment">// state until later</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  CHECK(<a class="code" href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">HTTPTransactionEgressSM::transit</a>(</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;          <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a>, HTTPTransactionEgressSM::Event::eomFlushed));</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordtype">size_t</span> nbytes = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#ad3e8c25f82c1ab3d38602ce696fcfe70">sendEOM</a>(<span class="keyword">this</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#af70fc7a7918b5c087c4d3ce93ba3e73a">trailers_</a>.get());</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#af70fc7a7918b5c087c4d3ce93ba3e73a">trailers_</a>.reset();</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">return</span> nbytes;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;}</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aa0acb82e5fec7d6ab61c9e5ac2a54f09">  964</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa0acb82e5fec7d6ab61c9e5ac2a54f09">HTTPTransaction::sendBodyNow</a>(std::unique_ptr&lt;folly::IOBuf&gt; body,</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                    <span class="keywordtype">size_t</span> bodyLen, <span class="keywordtype">bool</span> sendEom) {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> std::string noneStr = <span class="stringliteral">&quot;None&quot;</span>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  DCHECK(body);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  DCHECK_GT(bodyLen, 0);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordtype">size_t</span> nbytes = 0;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a>) {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    CHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a22bf8e1744def54ee887b2ae894e9e45">reserve</a>(bodyLen));</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Sending &quot;</span> &lt;&lt; bodyLen</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; bytes of body. eom=&quot;</span> &lt;&lt; ((sendEom) ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>)</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; send_window is &quot;</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;          &lt;&lt; (<a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                  ? folly::to&lt;std::string&gt;(</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a769103af9c73585fd33b8dc686d06c65">getSize</a>(), <span class="stringliteral">&quot; / &quot;</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a59e739a83cce8a0fc22c9dce48a0b193">getCapacity</a>())</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                  : noneStr)</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; trailers=&quot;</span> &lt;&lt; ((<a class="code" href="classproxygen_1_1HTTPTransaction.html#af70fc7a7918b5c087c4d3ce93ba3e73a">trailers_</a>) ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordflow">if</span> (sendEom &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#af70fc7a7918b5c087c4d3ce93ba3e73a">trailers_</a>) {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    CHECK(<a class="code" href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">HTTPTransactionEgressSM::transit</a>(</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a>, HTTPTransactionEgressSM::Event::eomFlushed));</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a93621220dbc29ef70ba34d0bcb245913">ingressErrorSeen_</a> &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a89082f763904815911bb62430ba5f24a">isExpectingWindowUpdate</a>()) {</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// I don&#39;t know how we got here but we&#39;re in trouble.  We need a window</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// update to continue but we&#39;ve already seen an ingress error.</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="classproxygen_1_1HTTPException.html">HTTPException</a> ex(<a class="code" href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb">HTTPException::Direction::INGRESS_AND_EGRESS</a>,</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                     folly::to&lt;std::string&gt;(<span class="stringliteral">&quot;window blocked with ingress error,&quot;</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                            <span class="stringliteral">&quot; streamID=&quot;</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>));</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    ex.<a class="code" href="classproxygen_1_1Exception.html#a96189a5e5d3636599b7af7337437e77f">setProxygenError</a>(<a class="code" href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da60f7c9e48bcca567facd26654ed3b4d8">kErrorEOF</a>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    ex.<a class="code" href="classproxygen_1_1HTTPException.html#a3dc0e569f9753f484a6e26ac0c8ab5c3">setCodecStatusCode</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba20973c7b1b8e3fe85f3926d10271a8d4">ErrorCode::FLOW_CONTROL_ERROR</a>);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">onError</a>(ex);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">updateReadTimeout</a>();</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  nbytes = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a0c3f6ac1245cf283d586e216740e5b7d">sendBody</a>(<span class="keyword">this</span>,</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                               std::move(body),</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                               sendEom &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#af70fc7a7918b5c087c4d3ce93ba3e73a">trailers_</a>,</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                               <a class="code" href="classproxygen_1_1HTTPTransaction.html#a3593cac85cdc7aa01309b908a4103dd6">enableLastByteFlushedTracking_</a>);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordflow">if</span> (sendEom &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#af70fc7a7918b5c087c4d3ce93ba3e73a">trailers_</a>) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a471d51265eceb6262ac25f9cf115f105">sendEOMNow</a>();</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a2f9237117b2220cf1b495c591d35bdfd">isPrioritySampled</a>()) {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a851f8e0daa480bb26f6c3847a1c6f7ec">updateTransactionBytesSent</a>(bodyLen);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4be280b06dbdc5c8f9bc01fa9edd1387">egressLimitBytesPerMs_</a> &gt; 0) {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4a2269f00d4980b9799843f94fb2dc09">numLimitedBytesEgressed_</a> += nbytes;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">return</span> nbytes;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;}</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#ad95519e6472228d359c7fb144889f1ac"> 1012</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#ad95519e6472228d359c7fb144889f1ac">HTTPTransaction::sendEOM</a>() {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  CHECK(<a class="code" href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">HTTPTransactionEgressSM::transit</a>(</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a>, HTTPTransactionEgressSM::Event::sendEOM))</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac15f2ce834f719ef4e9350edb51d688d">expectedResponseLength_</a> &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac49a1ef5d00655ff061197d8c741b74c">actualResponseLength_</a> &amp;&amp;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      (*<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac15f2ce834f719ef4e9350edb51d688d">expectedResponseLength_</a> != *<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac49a1ef5d00655ff061197d8c741b74c">actualResponseLength_</a>)) {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keyword">auto</span> errorMsg =</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        folly::to&lt;std::string&gt;(<span class="stringliteral">&quot;Content-Length/body mismatch: expected= &quot;</span>,</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                               *<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac15f2ce834f719ef4e9350edb51d688d">expectedResponseLength_</a>,</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                               <span class="stringliteral">&quot;, actual= &quot;</span>,</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                               *<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac49a1ef5d00655ff061197d8c741b74c">actualResponseLength_</a>);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; errorMsg &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  }</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength() == 0 &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a590f2fa2f962dd1c349bd5362c0bb115">chunkHeaders_</a>.empty()) {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// there is nothing left to send, egress the EOM directly.  For SPDY</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">// this will jump the txn queue</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>()) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keywordtype">size_t</span> nbytes = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a471d51265eceb6262ac25f9cf115f105">sendEOMNow</a>();</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a6f89b92fa724cb3a2591ab01332c18b8">notifyPendingEgress</a>();</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#afc053d6a939eec4c3794c07132f7be82">bodyBytesGenerated</a>(nbytes);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="comment">// If the txn is enqueued, sendDeferredBody()</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="comment">// should take care of sending the EOM.</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="comment">// This can happen for some uses of the egress queue</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued egress EOM with no body&quot;</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;[egressState=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;ingressState=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4635c6fb2e6d001200f39ea32197af09">ingressState_</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;egressPaused=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a9a303a52efdc3a44b3624a4d598d2f4b">egressPaused_</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;ingressPaused=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;aborted=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;enqueued=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;chainLength=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Queued egress EOM on &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">notifyTransportPendingEgress</a>();</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234"> 1056</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">HTTPTransaction::sendAbort</a>() {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">sendAbort</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a91147cca992f750017bd431e85952006">isUpstream</a>() ? <a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba2027c027133e22c8929e2874dc44dd36">ErrorCode::CANCEL</a></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                         : <a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9bae8c0c70879b5895c615677261d64a1ee">ErrorCode::INTERNAL_ERROR</a>);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a28679a697180f37a6f80b412b37ab478"> 1061</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">HTTPTransaction::sendAbort</a>(<a class="code" href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9b">ErrorCode</a> <a class="code" href="SPDYCodec_8cpp.html#a6d7c29827e855a62945ede0ae6e82786">statusCode</a>) {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a22ec9e51f55497dc4dca424a463b4a54">markIngressComplete</a>();</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">markEgressComplete</a>();</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a>) {</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">// This can happen in cases where the abort is sent before notifying the</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// handler, but its logic also wants to abort</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;skipping redundant abort&quot;</span>;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  }</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;aborting transaction &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">aborted_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordtype">size_t</span> nbytes = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a196ee69eed048b43bdc900bb97c080fa">sendAbort</a>(<span class="keyword">this</span>, statusCode);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>) {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="namespaceproxygen.html#a3229605c4d71bcf5379d0dd133870421">HTTPHeaderSize</a> size;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    size.uncompressed = nbytes;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">transportCallback_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionTransportCallback.html#a8c465da22a769b3cae95ce03e71f7456">headerBytesGenerated</a>(size);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;}</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a70de40060357331a03b389ddfa3256e7"> 1081</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a70de40060357331a03b389ddfa3256e7">HTTPTransaction::pauseIngress</a>() {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  VLOG(4)&lt;&lt; <span class="stringliteral">&quot;pauseIngress request &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a>) {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;can&#39;t pause ingress; ingressPaused=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  }</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  cancelTimeout();</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a854efe446d5edff65c09243eed1bfbb5">pauseIngress</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#ae964af29eff98740360a8d7a02b88720"> 1093</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae964af29eff98740360a8d7a02b88720">HTTPTransaction::resumeIngress</a>() {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;resumeIngress request &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a> || <a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>()) {</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;can&#39;t resume ingress, ingressPaused=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;, ingressComplete=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">isIngressComplete</a>()</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;, inResume_=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4fc154af488feb7538d9dc9413db8df7">inResume_</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a2d5fbaa7d2eb616f56541d3189553cc6">resumeIngress</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4fc154af488feb7538d9dc9413db8df7">inResume_</a>) {</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;skipping recursive resume loop &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4fc154af488feb7538d9dc9413db8df7">inResume_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a> &amp;&amp; (maxDeferredIngress_ &lt;= deferredIngress_-&gt;size())) {</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a59dfab33819a404ebee7989b3961c822">maxDeferredIngress_</a> = <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;size();</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  }</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="comment">// Process any deferred ingress callbacks</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="comment">// Note: we recheck the ingressPaused_ state because a callback</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="comment">// invoked by the resumeIngress() call above could have re-paused</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="comment">// the transaction.</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a> &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;empty()) {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="classproxygen_1_1HTTPEvent.html">HTTPEvent</a>&amp; callback(<a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;front());</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Processing deferred ingress callback of type &quot;</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            &lt;&lt; callback.<a class="code" href="classproxygen_1_1HTTPEvent.html#ac0fb3a17ef16423dfb2dda5cf547aaa2">getEvent</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">switch</span> (callback.getEvent()) {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fae8f67cbcf442cae7cbb362ea8227b7ee">HTTPEvent::Type::MESSAGE_BEGIN</a>:</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;unreachable&quot;</span>;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa0f2810d6dd9e145dc07a1eb52d1bf7de">HTTPEvent::Type::HEADERS_COMPLETE</a>:</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa82560a6af2507dd29b6429df4e495f8">processIngressHeadersComplete</a>(callback.getHeaders());</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa786329b34bbe53ab40a54a19cd597f2d">HTTPEvent::Type::BODY</a>: {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        unique_ptr&lt;IOBuf&gt; data = callback.getBody();</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keyword">auto</span> len = data-&gt;computeChainDataLength();</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        CHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#ae0cfefc1b0658621476f39cba28d9505">free</a>(len));</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0e0d2e99d0604ab973cd67a374184b0e">processIngressBody</a>(std::move(data), len);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      } <span class="keywordflow">break</span>;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa7c176223c0dc5d3e1e28b29b6a3d7221">HTTPEvent::Type::CHUNK_HEADER</a>:</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#acf377e6941a4b536de594a81cbe06d8b">processIngressChunkHeader</a>(callback.getChunkLength());</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fae0fc80012eacfd179a3045b6a25d921d">HTTPEvent::Type::CHUNK_COMPLETE</a>:</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#acdd10519941d283b375243d7420d6fa2">processIngressChunkComplete</a>();</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa1f8ec8636df593e722e9631642eabc74">HTTPEvent::Type::TRAILERS_COMPLETE</a>:</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa42ddb3266af71bfe85f7d925f687137">processIngressTrailers</a>(callback.getTrailers());</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa54f5ce060c26e64cc1fdea3c2f602000">HTTPEvent::Type::MESSAGE_COMPLETE</a>:</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a6df2dac550e90e25d05a86e6f6050944">processIngressEOM</a>();</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa7f10b7b76869bf2e029b6ce4632e1323">HTTPEvent::Type::UPGRADE</a>:</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a81313661e5baf7b3ccacb41a9275eafb">processIngressUpgrade</a>(callback.getUpgradeProtocol());</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>) {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;pop();</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    }</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  }</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">updateReadTimeout</a>();</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4fc154af488feb7538d9dc9413db8df7">inResume_</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;}</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a9aa4ccd2421c67151b8bbf151e21f320"> 1159</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a9aa4ccd2421c67151b8bbf151e21f320">HTTPTransaction::pauseEgress</a>() {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;asked to pause egress &quot;</span> &lt;&lt; *this ;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a9a303a52efdc3a44b3624a4d598d2f4b">egressPaused_</a>) {</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;egress already paused &quot;</span> &lt;&lt; *this ;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  }</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a9a303a52efdc3a44b3624a4d598d2f4b">egressPaused_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0cd2d19638e42b0a0517ecf5813fff37">updateHandlerPauseState</a>();</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;}</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#af50de2d1a784ae9eeb207473781103e0"> 1170</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#af50de2d1a784ae9eeb207473781103e0">HTTPTransaction::resumeEgress</a>() {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;asked to resume egress&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a9a303a52efdc3a44b3624a4d598d2f4b">egressPaused_</a>) {</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;egress already not paused&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a9a303a52efdc3a44b3624a4d598d2f4b">egressPaused_</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0cd2d19638e42b0a0517ecf5813fff37">updateHandlerPauseState</a>();</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;}</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a6ad638cc955677912c4c10d8b6ddf8ff"> 1181</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a6ad638cc955677912c4c10d8b6ddf8ff">HTTPTransaction::setEgressRateLimit</a>(uint64_t bitsPerSecond) {</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4be280b06dbdc5c8f9bc01fa9edd1387">egressLimitBytesPerMs_</a> = bitsPerSecond / 8000;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordflow">if</span> (bitsPerSecond &gt; 0 &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4be280b06dbdc5c8f9bc01fa9edd1387">egressLimitBytesPerMs_</a> == 0) {</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;ratelim: Limit too low (&quot;</span> &lt;&lt; bitsPerSecond &lt;&lt; <span class="stringliteral">&quot;), ignoring&quot;</span>;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac7f3655a5f69420aacf1501ce1d4818d">startRateLimit_</a> = <a class="code" href="namespaceproxygen.html#a09b325f9c0aa18197dfeebb7f0533a49">getCurrentTime</a>();</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4a2269f00d4980b9799843f94fb2dc09">numLimitedBytesEgressed_</a> = 0;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;}</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3"> 1190</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">HTTPTransaction::notifyTransportPendingEgress</a>() {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  DestructorGuard guard(<span class="keyword">this</span>);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#ab2728d681b3faa0ebe646adbb1b0b25c">egressRateLimited_</a> &amp;&amp;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength() &gt; 0 ||</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;       <a class="code" href="classproxygen_1_1HTTPTransaction.html#a3fb44b6e36a49d30e44e67eb1c789bfc">isEgressEOMQueued</a>()) &amp;&amp;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a> || <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a769103af9c73585fd33b8dc686d06c65">getSize</a>() &gt; 0)) {</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="comment">// Egress isn&#39;t paused, we have something to send, and flow</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="comment">// control isn&#39;t blocking us.</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>()) {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="comment">// Insert into the queue and let the session know we&#39;ve got something</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">egressQueue_</a>.<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html#affc0541d33b92f8ac94bb95faf4d9015">signalPendingEgress</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a>);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a6f89b92fa724cb3a2591ab01332c18b8">notifyPendingEgress</a>();</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a9ac88e461ed34742fde46678d52392fc">notifyEgressBodyBuffered</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength());</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">isEnqueued</a>()) {</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">// Nothing to send, or not allowed to send right now.</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    int64_t deferredEgressBodyBytes =</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      folly::to&lt;int64_t&gt;(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength());</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a9ac88e461ed34742fde46678d52392fc">notifyEgressBodyBuffered</a>(-deferredEgressBodyBytes);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">egressQueue_</a>.<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html#a775fcd7d7d4c27b71ca700c4f7ef93ff">clearPendingEgress</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a>);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  }</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0cd2d19638e42b0a0517ecf5813fff37">updateHandlerPauseState</a>();</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;}</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a0cd2d19638e42b0a0517ecf5813fff37"> 1214</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0cd2d19638e42b0a0517ecf5813fff37">HTTPTransaction::updateHandlerPauseState</a>() {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  int64_t availWindow =</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">sendWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a769103af9c73585fd33b8dc686d06c65">getSize</a>() - <a class="code" href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">deferredEgressBody_</a>.chainLength();</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="comment">// do not count transaction stalled if no more bytes to send,</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="comment">// i.e. when availWindow == 0</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a> &amp;&amp; availWindow &lt; 0 &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a16fd01bfd8dc6a7e734e3a4cbca74eee">flowControlPaused_</a>) {</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;transaction stalled by flow control&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a4c679e83df84756777a28364d5632d42">stats_</a>) {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4c679e83df84756777a28364d5632d42">stats_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPSessionStats.html#a11caacb735320e219801d594fad7a1a3">recordTransactionStalled</a>();</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    }</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  }</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a16fd01bfd8dc6a7e734e3a4cbca74eee">flowControlPaused_</a> = <a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a> &amp;&amp; availWindow &lt;= 0;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <span class="keywordtype">bool</span> handlerShouldBePaused = <a class="code" href="classproxygen_1_1HTTPTransaction.html#a9a303a52efdc3a44b3624a4d598d2f4b">egressPaused_</a> || <a class="code" href="classproxygen_1_1HTTPTransaction.html#a16fd01bfd8dc6a7e734e3a4cbca74eee">flowControlPaused_</a> ||</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ab2728d681b3faa0ebe646adbb1b0b25c">egressRateLimited_</a>;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a> &amp;&amp; handlerShouldBePaused != <a class="code" href="classproxygen_1_1HTTPTransaction.html#ad54b8093a5fc5524ff4edac194455300">handlerEgressPaused_</a>) {</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordflow">if</span> (handlerShouldBePaused) {</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ad54b8093a5fc5524ff4edac194455300">handlerEgressPaused_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a0a50acdb32cb51ecbf6a72730053a36b">onEgressPaused</a>();</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ad54b8093a5fc5524ff4edac194455300">handlerEgressPaused_</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a7715b02e413859c26426adbbde7e53d8">onEgressResumed</a>();</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    }</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;}</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aa1452a5a8322901be423c0dcd6de76ef"> 1240</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa1452a5a8322901be423c0dcd6de76ef">HTTPTransaction::updateIngressCompressionInfo</a>(</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keyword">const</span> <a class="code" href="structproxygen_1_1CompressionInfo.html">CompressionInfo</a>&amp; tableInfo) {</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac09085e8037607eb496c8f4899f6ab16">tableInfo_</a>.<a class="code" href="structproxygen_1_1CompressionInfo.html#adbf738f1a934cdfe112a41c883bfa5e4">ingressHeaderTableSize_</a> =</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                            tableInfo.<a class="code" href="structproxygen_1_1CompressionInfo.html#adbf738f1a934cdfe112a41c883bfa5e4">ingressHeaderTableSize_</a>;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac09085e8037607eb496c8f4899f6ab16">tableInfo_</a>.<a class="code" href="structproxygen_1_1CompressionInfo.html#afca67204c598e7b76e4c889a2fc7cd97">ingressBytesStored_</a> =</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                            tableInfo.<a class="code" href="structproxygen_1_1CompressionInfo.html#afca67204c598e7b76e4c889a2fc7cd97">ingressBytesStored_</a>;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac09085e8037607eb496c8f4899f6ab16">tableInfo_</a>.<a class="code" href="structproxygen_1_1CompressionInfo.html#a680906edd9c2081d55c6df98db652dbb">ingressHeadersStored_</a> =</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                            tableInfo.<a class="code" href="structproxygen_1_1CompressionInfo.html#a680906edd9c2081d55c6df98db652dbb">ingressHeadersStored_</a>;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a2019b1e0b9d117ac14a2843035913769"> 1250</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2019b1e0b9d117ac14a2843035913769">HTTPTransaction::updateEgressCompressionInfo</a>(</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keyword">const</span> <a class="code" href="structproxygen_1_1CompressionInfo.html">CompressionInfo</a>&amp; tableInfo) {</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac09085e8037607eb496c8f4899f6ab16">tableInfo_</a>.<a class="code" href="structproxygen_1_1CompressionInfo.html#a22477e99d07b08d4f8fdb72b65479de2">egressHeaderTableSize_</a> =</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                            tableInfo.<a class="code" href="structproxygen_1_1CompressionInfo.html#a22477e99d07b08d4f8fdb72b65479de2">egressHeaderTableSize_</a>;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac09085e8037607eb496c8f4899f6ab16">tableInfo_</a>.<a class="code" href="structproxygen_1_1CompressionInfo.html#ab78106ba4defb0d422206c5430a8b7e6">egressBytesStored_</a> =</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                            tableInfo.<a class="code" href="structproxygen_1_1CompressionInfo.html#ab78106ba4defb0d422206c5430a8b7e6">egressBytesStored_</a>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac09085e8037607eb496c8f4899f6ab16">tableInfo_</a>.<a class="code" href="structproxygen_1_1CompressionInfo.html#a8505af2a2798b0e40c86c05600f0a67b">egressHeadersStored_</a> =</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                            tableInfo.<a class="code" href="structproxygen_1_1CompressionInfo.html#a8505af2a2798b0e40c86c05600f0a67b">egressHeadersStored_</a>;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#acc3ee9bf51e57e0b7f9635a093659d8b"> 1260</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structproxygen_1_1CompressionInfo.html">CompressionInfo</a>&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#acc3ee9bf51e57e0b7f9635a093659d8b">HTTPTransaction::getCompressionInfo</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac09085e8037607eb496c8f4899f6ab16">tableInfo_</a>;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;}</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d"> 1264</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">HTTPTransaction::mustQueueIngress</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">ingressPaused_</a> || (<a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>-&gt;empty());</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;}</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30"> 1268</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">HTTPTransaction::checkCreateDeferredIngress</a>() {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a>) {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">deferredIngress_</a> = std::make_unique&lt;std::queue&lt;HTTPEvent&gt;&gt;();</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;}</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a398db3f6032d4e026f765fd63bb0ca83"> 1274</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a398db3f6032d4e026f765fd63bb0ca83">HTTPTransaction::onPushedTransaction</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html">HTTPTransaction</a>* pushTxn) {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  CHECK_EQ(*pushTxn-&gt;<a class="code" href="classproxygen_1_1HTTPTransaction.html#af4cfe0b59bb2946669c46c8757f357e2">assocStreamId_</a>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Cannot add a pushed txn to an unhandled txn&quot;</span>;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a9d65c4524f5e38f10d42e0290d51fea6">onPushedTransaction</a>(pushTxn);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="keywordflow">if</span> (!pushTxn-&gt;<a class="code" href="classproxygen_1_1HTTPTransaction.html#ab639699f42d36d0c814e5ca1a8a73194">getHandler</a>()) {</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Failed to create a handler for push transaction&quot;</span>;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  }</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a1529214f357bb99fe87653378864f2ee">pushedTransactions_</a>.insert(pushTxn-&gt;<a class="code" href="classproxygen_1_1HTTPTransaction.html#a69a9be095ff88eb4c1385933a1483517">getID</a>());</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;}</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a3ea745988332db0c76cf337057d29040"> 1290</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a3ea745988332db0c76cf337057d29040">HTTPTransaction::onExTransaction</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html">HTTPTransaction</a>* exTxn) {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  DestructorGuard g(<span class="keyword">this</span>);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  CHECK_EQ(*(exTxn-&gt;<a class="code" href="classproxygen_1_1HTTPTransaction.html#abb5b09692ca0e43373b82c0160b05939">getControlStream</a>()), <a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>) {</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; <span class="stringliteral">&quot;Cannot add a exTxn to an unhandled txn&quot;</span>;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  }</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">handler_</a>-&gt;<a class="code" href="classproxygen_1_1HTTPTransactionHandler.html#a2a1e6d98064defaccbc8398b81524dd6">onExTransaction</a>(exTxn);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">if</span> (!exTxn-&gt;<a class="code" href="classproxygen_1_1HTTPTransaction.html#ab639699f42d36d0c814e5ca1a8a73194">getHandler</a>()) {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    LOG(<a class="code" href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">ERROR</a>) &lt;&lt; <span class="stringliteral">&quot;Failed to create a handler for ExTransaction&quot;</span>;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  }</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ad1df333c0d5f703c6f0722fdbe099cf9">exTransactions_</a>.insert(exTxn-&gt;<a class="code" href="classproxygen_1_1HTTPTransaction.html#a69a9be095ff88eb4c1385933a1483517">getID</a>());</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;}</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aa6c3daac07778c3ac00f41acd8ef1091"> 1306</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aa6c3daac07778c3ac00f41acd8ef1091">HTTPTransaction::setIdleTimeout</a>(</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    std::chrono::milliseconds transactionTimeout) {</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a657744e4ff7fb16bd16bee71cde33faf">transactionTimeout_</a> = transactionTimeout;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;HTTPTransaction: transaction timeout is set to  &quot;</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;          &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                 transactionTimeout)</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                 .count();</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">refreshTimeout</a>();</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;}</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a122fcfcde3d41c6041829940bad47f08"> 1316</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a122fcfcde3d41c6041829940bad47f08">HTTPTransaction::describe</a>(std::ostream&amp; os)<span class="keyword"> const </span>{</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#ab1907c602f4948511e3c2f4268446364">describe</a>(os);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;, streamID=&quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">id_</a>;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;}</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment"> * TODO: when HTTPSession sends a SETTINGS frame indicating a</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment"> * different initial window, it should call this function on all its</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment"> * transactions.</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01326"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#af62e6acda8c5bb199bb5c7fb74867f6f"> 1326</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#af62e6acda8c5bb199bb5c7fb74867f6f">HTTPTransaction::setReceiveWindow</a>(uint32_t capacity) {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="comment">// Depending on whether delta is positive or negative it will cause the</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="comment">// window to either increase or decrease.</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a>) {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  }</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  int32_t delta = capacity - <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a59e739a83cce8a0fc22c9dce48a0b193">getCapacity</a>();</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">if</span> (delta &lt; 0) {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">// For now, we&#39;re disallowing shrinking the window, since it can lead</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">// to FLOW_CONTROL_ERRORs if there is data in flight.</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Refusing to shrink the recv window&quot;</span>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  }</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a5e0843cdb55c9c3ffd1cfe3e2e1f25f2">setCapacity</a>(capacity)) {</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a> += delta;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a715b0b12bf67788bf0db9318e3d61e14">flushWindowUpdate</a>();</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;}</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a715b0b12bf67788bf0db9318e3d61e14"> 1346</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a715b0b12bf67788bf0db9318e3d61e14">HTTPTransaction::flushWindowUpdate</a>() {</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a> &gt; 0 &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">useFlowControl_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">isIngressEOMSeen</a>() &amp;&amp;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      (<a class="code" href="classproxygen_1_1HTTPTransaction.html#a7e3d429b572296fce7f5873f262004ce">direction_</a> == <a class="code" href="namespaceproxygen.html#a00b4cbb0c54e966bfd87e0e7cb1cb33daf8e7627f40cd51bcb234401511c640fd">TransportDirection::DOWNSTREAM</a> ||</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">egressState_</a> != HTTPTransactionEgressSM::State::Start ||</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <a class="code" href="classproxygen_1_1HTTPTransaction.html#a4635c6fb2e6d001200f39ea32197af09">ingressState_</a> != HTTPTransactionIngressSM::State::Start)) {</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="comment">// Down egress upstream window updates until after headers</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;recv_window is &quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a769103af9c73585fd33b8dc686d06c65">getSize</a>()</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">recvWindow_</a>.<a class="code" href="classproxygen_1_1Window.html#a59e739a83cce8a0fc22c9dce48a0b193">getCapacity</a>() &lt;&lt; <span class="stringliteral">&quot; after acking &quot;</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            &lt;&lt; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *this ;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#aa7b9f0ba2b4f6743a746cb796be14760">sendWindowUpdate</a>(<span class="keyword">this</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a>);</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a> = 0;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  }</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;}</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a5212cf36467144b09c987cce90c64a8d"> 1360</a></span>&#160;int32_t <a class="code" href="classproxygen_1_1HTTPTransaction.html#a5212cf36467144b09c987cce90c64a8d">HTTPTransaction::getRecvToAck</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">recvToAck_</a>;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;}</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;std::ostream&amp;</div><div class="line"><a name="l01365"></a><span class="lineno"><a class="line" href="namespaceproxygen.html#af3a8b69029292653a760cb3f5795a092"> 1365</a></span>&#160;<a class="code" href="namespaceproxygen.html#a1617cb8241e173bf5635c01eae5cc12f">operator&lt;&lt;</a>(std::ostream&amp; os, <span class="keyword">const</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html">HTTPTransaction</a>&amp; txn) {</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  txn.<a class="code" href="classproxygen_1_1HTTPTransaction.html#a122fcfcde3d41c6041829940bad47f08">describe</a>(os);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">return</span> os;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;}</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div><div class="line"><a name="l01370"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#aca321e4ac903ca24e3307ea3d7085546"> 1370</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aca321e4ac903ca24e3307ea3d7085546">HTTPTransaction::updateAndSendPriority</a>(int8_t newPriority) {</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  newPriority = <a class="code" href="classproxygen_1_1HTTPMessage.html#a3533208cb9121a0fc9464ce3f9a9886d">HTTPMessage::normalizePriority</a>(newPriority);</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  CHECK_GE(newPriority, 0);</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae249e38c296d2e391156dab66871aee1">priority_</a>.<a class="code" href="structproxygen_1_1http2_1_1PriorityUpdate.html#a679735d9727d4589b1b12fd3a2f3d8d6">streamDependency</a> =</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a50773010568880d549b9de1cc710f51c">getCodec</a>().<a class="code" href="classproxygen_1_1HTTPCodec.html#ad3f2df6e146618da881c36c5bd68c7e3">mapPriorityToDependency</a>(newPriority);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a> = <a class="code" href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">egressQueue_</a>.<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html#a79981b30f800a1f4872ddbd708c1bc5a">updatePriority</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae249e38c296d2e391156dab66871aee1">priority_</a>);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#aaf57400170e2afde845b45288c4f5609">sendPriority</a>(<span class="keyword">this</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae249e38c296d2e391156dab66871aee1">priority_</a>);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;}</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a359cccc425ebddab7f67b4b68f9ad3ad"> 1379</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#aca321e4ac903ca24e3307ea3d7085546">HTTPTransaction::updateAndSendPriority</a>(</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keyword">const</span> <a class="code" href="structproxygen_1_1http2_1_1PriorityUpdate.html">http2::PriorityUpdate</a>&amp; newPriority) {</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#af27fcc98b59eb4eb42e634130ecb99ae">onPriorityUpdate</a>(newPriority);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">transport_</a>.<a class="code" href="classproxygen_1_1HTTPTransaction_1_1Transport.html#aaf57400170e2afde845b45288c4f5609">sendPriority</a>(<span class="keyword">this</span>, <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae249e38c296d2e391156dab66871aee1">priority_</a>);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;}</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div><div class="line"><a name="l01385"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#af27fcc98b59eb4eb42e634130ecb99ae"> 1385</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#af27fcc98b59eb4eb42e634130ecb99ae">HTTPTransaction::onPriorityUpdate</a>(<span class="keyword">const</span> <a class="code" href="structproxygen_1_1http2_1_1PriorityUpdate.html">http2::PriorityUpdate</a>&amp; priority) {</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae249e38c296d2e391156dab66871aee1">priority_</a> = priority;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a> = <a class="code" href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">egressQueue_</a>.<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html#a79981b30f800a1f4872ddbd708c1bc5a">updatePriority</a>(</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a>,</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#ae249e38c296d2e391156dab66871aee1">priority_</a>,</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      &amp;<a class="code" href="classproxygen_1_1HTTPTransaction.html#add2ec8e1f7d0b23b829d47eccbdc1c2b">currentDepth_</a>);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ae249e38c296d2e391156dab66871aee1">priority_</a>.<a class="code" href="structproxygen_1_1http2_1_1PriorityUpdate.html#a679735d9727d4589b1b12fd3a2f3d8d6">streamDependency</a> != <a class="code" href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">egressQueue_</a>.<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase.html#a84127d301f6e185dd2fdf92d8fbf63f6">getRootId</a>() &amp;&amp;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <a class="code" href="classproxygen_1_1HTTPTransaction.html#add2ec8e1f7d0b23b829d47eccbdc1c2b">currentDepth_</a> == 1) {</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#aacb764e1b4dbc2caa9b8f3a031b4fe4d">priorityFallback_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;}</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div><div class="line"><a name="l01398"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html"> 1398</a></span>&#160;<span class="keyword">class </span><a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html">HTTPTransaction::PrioritySample</a> {</div><div class="line"><a name="l01399"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html"> 1399</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html">WeightedAccumulator</a> {</div><div class="line"><a name="l01400"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a0e48d5522d53c88ec33ad9cc4845e264"> 1400</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a0e48d5522d53c88ec33ad9cc4845e264">accumulate</a>(uint64_t weighted, uint64_t total) {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      weighted_ += weighted;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      total_ += total;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a9a19b9f0e020d8b9188609cfd1e06ed0"> 1405</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a9a19b9f0e020d8b9188609cfd1e06ed0">accumulateWeighted</a>(uint64_t weighted) {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      weighted_ += weighted;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    }</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a3c9724eba927afeff034fc65eb403070"> 1409</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a3c9724eba927afeff034fc65eb403070">accumulateTotal</a>(uint64_t total) {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      total_ += total;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a7b14a6af99901e883402a0a2c9b1b6b2"> 1413</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a7b14a6af99901e883402a0a2c9b1b6b2">getWeightedAverage</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordflow">return</span> total_ ? (double)weighted_ / (<span class="keywordtype">double</span>)total_ : 0;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l01417"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a1b5fd6793bc422153cadeeebe5c95bdd"> 1417</a></span>&#160;    uint64_t weighted_{0};</div><div class="line"><a name="l01418"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a5fd1e28a743f218a789fb0d94dcc8a43"> 1418</a></span>&#160;    uint64_t total_{0};</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  };</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html"> 1421</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html">WeightedValue</a> {</div><div class="line"><a name="l01422"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a13d49b7e43be3991db44472f554173a6"> 1422</a></span>&#160;    uint64_t value_{0};</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div><div class="line"><a name="l01424"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a8cf73c242547c1cf58f0aec25d4622e4"> 1424</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a8cf73c242547c1cf58f0aec25d4622e4">accumulateByTransactionBytes</a>(uint64_t bytes) {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      byTransactionBytesSent_.accumulate(value_ * bytes, bytes);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    }</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#aec10c3b3bd2dbaf063a3e056c112806f"> 1428</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#aec10c3b3bd2dbaf063a3e056c112806f">accumulateBySessionBytes</a>(uint64_t bytes) {</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      bySessionBytesScheduled_.accumulate(value_ * bytes, bytes);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    }</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div><div class="line"><a name="l01432"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a97cea134a36abd566e2ff1363405d424"> 1432</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a97cea134a36abd566e2ff1363405d424">getSummary</a>(<a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage.html">HTTPTransaction::PrioritySampleSummary::WeightedAverage</a>&amp;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    wa)<span class="keyword"> const </span>{</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      wa.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage.html#afe6b9ab950c9bb1a1caded5317e3815a">byTransactionBytes_</a> =</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        byTransactionBytesSent_.getWeightedAverage();</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      wa.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage.html#a40f9381650b7e11492e2b7a77df28dde">bySessionBytes_</a> =</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        bySessionBytesScheduled_.getWeightedAverage();</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    }</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l01440"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a5a6956c3510f046d82492385be234951"> 1440</a></span>&#160;    <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html">WeightedAccumulator</a> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a5a6956c3510f046d82492385be234951">byTransactionBytesSent_</a>;</div><div class="line"><a name="l01441"></a><span class="lineno"><a class="line" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a7b20abfa558fa297e83d11f6ad62dd17"> 1441</a></span>&#160;    <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html">WeightedAccumulator</a> <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a7b20abfa558fa297e83d11f6ad62dd17">bySessionBytesScheduled_</a>;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  };</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l01445"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aa96a73e5678d7647ea4cc03f9142388d"> 1445</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aa96a73e5678d7647ea4cc03f9142388d">PrioritySample</a>(<a class="code" href="classproxygen_1_1HTTPTransaction.html">HTTPTransaction</a>* tnx) :</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    tnx_(tnx),</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    transactionBytesScheduled_(false) {}</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a8d6e9e290af4701d41f367532c21463e"> 1449</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a8d6e9e290af4701d41f367532c21463e">updateContentionsCount</a>(uint64_t contentions, uint64_t depth) {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    transactionBytesScheduled_ = <span class="keyword">false</span>;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    ratio_ = 0.0;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    contentions_.value_ = contentions;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    depth_.value_ = depth;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  }</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a043843d043136715e1a062e509048d40"> 1456</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a043843d043136715e1a062e509048d40">updateTransactionBytesSent</a>(uint64_t bytes) {</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    transactionBytesScheduled_ = <span class="keyword">true</span>;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    measured_weight_.accumulateWeighted(bytes);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">if</span> (contentions_.value_) {</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      contentions_.accumulateByTransactionBytes(bytes);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      VLOG(5) &lt;&lt; <span class="stringliteral">&quot;transfer &quot;</span> &lt;&lt; bytes</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; transaction body bytes while contentions count = 0 &quot;</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;              &lt;&lt; *tnx_;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    }</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    depth_.accumulateByTransactionBytes(bytes);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  }</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#af25b6716fa6640e4fcef4a7595e66b11"> 1469</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#af25b6716fa6640e4fcef4a7595e66b11">updateSessionBytesSheduled</a>(uint64_t bytes) {</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    measured_weight_.accumulateTotal(bytes);</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    expected_weight_.accumulate((ratio_ * bytes) + 0.5, bytes);</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">if</span> (contentions_.value_) {</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      contentions_.accumulateBySessionBytes(bytes);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      VLOG(5) &lt;&lt; <span class="stringliteral">&quot;transfer &quot;</span> &lt;&lt; bytes</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; session body bytes while contentions count = 0 &quot;</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;              &lt;&lt; *tnx_;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    }</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    depth_.accumulateBySessionBytes(bytes);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  }</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div><div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a153d6442538b3a055c38684f6b9affb5"> 1482</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a153d6442538b3a055c38684f6b9affb5">updateRatio</a>(<span class="keywordtype">double</span> ratio) {</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    ratio_ = ratio;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  }</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div><div class="line"><a name="l01486"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a61fd3e69cbb521a04618cd8a81cd164b"> 1486</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a61fd3e69cbb521a04618cd8a81cd164b">isTransactionBytesScheduled</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">return</span> transactionBytesScheduled_;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  }</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#afd2a8c1999c8e55fa028665061f4bd78"> 1490</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#afd2a8c1999c8e55fa028665061f4bd78">getSummary</a>(<a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html">HTTPTransaction::PrioritySampleSummary</a>&amp; summary)<span class="keyword"> const </span>{</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    contentions_.getSummary(summary.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html#a9f9f9c9c297aba9e43494a7dfd4254c8">contentions_</a>);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    depth_.getSummary(summary.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html#ae7a6f6c9d399caa7f9f822d9f9978c29">depth_</a>);</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    summary.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html#a861167815a7cdbba5d0d65cd6f6b9b74">expected_weight_</a> = expected_weight_.getWeightedAverage();</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    summary.<a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html#abca443e784296d54ad69b95a4f0f9e11">measured_weight_</a> = measured_weight_.getWeightedAverage();</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  }</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="comment">// TODO: remove tnx_ when not needed</span></div><div class="line"><a name="l01498"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a292b71139b2237cde4ada3373c07a06e"> 1498</a></span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html">HTTPTransaction</a>* <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a292b71139b2237cde4ada3373c07a06e">tnx_</a>; <span class="comment">// needed for error reporting, will be removed</span></div><div class="line"><a name="l01499"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a1b9eebf6c60e684702be9114cf6faa02"> 1499</a></span>&#160;  <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html">WeightedValue</a> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a1b9eebf6c60e684702be9114cf6faa02">contentions_</a>;</div><div class="line"><a name="l01500"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aae354d8bb159cb5a337048a4e7ed384e"> 1500</a></span>&#160;  <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html">WeightedValue</a> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aae354d8bb159cb5a337048a4e7ed384e">depth_</a>;</div><div class="line"><a name="l01501"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a9ad40a5c63a9c67ebfafcc9a3b44fdf3"> 1501</a></span>&#160;  <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html">WeightedAccumulator</a> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a9ad40a5c63a9c67ebfafcc9a3b44fdf3">expected_weight_</a>;</div><div class="line"><a name="l01502"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aa94aaa58fe18324c2a2449be01253efc"> 1502</a></span>&#160;  <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html">WeightedAccumulator</a> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aa94aaa58fe18324c2a2449be01253efc">measured_weight_</a>;</div><div class="line"><a name="l01503"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a5a62aa5917ef2fa4838e05f3e1f191c7"> 1503</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a5a62aa5917ef2fa4838e05f3e1f191c7">ratio_</a>;</div><div class="line"><a name="l01504"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aee6e104a7fb3787c39c0a52c021b7d80"> 1504</a></span>&#160;  <span class="keywordtype">bool</span> transactionBytesScheduled_:1;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;};</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div><div class="line"><a name="l01507"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a2c3c9818119e8f7db0223f40491f5bca"> 1507</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a2c3c9818119e8f7db0223f40491f5bca">HTTPTransaction::setPrioritySampled</a>(<span class="keywordtype">bool</span> sampled) {</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="keywordflow">if</span> (sampled) {</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a> = std::make_unique&lt;PrioritySample&gt;(<span class="keyword">this</span>);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>.reset();</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  }</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;}</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a3bf5690949bf654120ea1302f01e1d43"> 1515</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a3bf5690949bf654120ea1302f01e1d43">HTTPTransaction::updateContentionsCount</a>(uint64_t contentions) {</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  CHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>);</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>-&gt;updateContentionsCount(contentions,</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                                          <a class="code" href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">queueHandle_</a>-&gt;<a class="code" href="classproxygen_1_1HTTP2PriorityQueueBase_1_1BaseNode.html#ae5abfb9239fce01e8b66097c0a0368f4">calculateDepth</a>(<span class="keyword">false</span>));</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;}</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div><div class="line"><a name="l01521"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a08ccd95211616539ef13b9950f719161"> 1521</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a08ccd95211616539ef13b9950f719161">HTTPTransaction::updateRelativeWeight</a>(<span class="keywordtype">double</span> ratio) {</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  CHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>);</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>-&gt;updateRatio(ratio);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;}</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01526"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a8087cecb501660955abf898a7ed8e0e0"> 1526</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a8087cecb501660955abf898a7ed8e0e0">HTTPTransaction::updateSessionBytesSheduled</a>(uint64_t bytes) {</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  CHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="comment">// Do not accumulate session bytes utill header is sent.</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="comment">// Otherwise, the session bytes could be accumulated for a transaction</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="comment">// that is not allowed to egress yet.</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="comment">// Do not accumulate session bytes if transaction is paused.</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="comment">// On the other hand, if the transaction is part of the egress,</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="comment">// always accumulate the session bytes.</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordflow">if</span> ((bytes &amp;&amp; <a class="code" href="classproxygen_1_1HTTPTransaction.html#a1f981615d0d6d8cd56c3fc1a01d44a29">firstHeaderByteSent_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a9a303a52efdc3a44b3624a4d598d2f4b">egressPaused_</a> &amp;&amp;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    !<a class="code" href="classproxygen_1_1HTTPTransaction.html#ab2728d681b3faa0ebe646adbb1b0b25c">egressRateLimited_</a> &amp;&amp; !<a class="code" href="classproxygen_1_1HTTPTransaction.html#a16fd01bfd8dc6a7e734e3a4cbca74eee">flowControlPaused_</a>)</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    || <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>-&gt;isTransactionBytesScheduled()) {</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>-&gt;updateSessionBytesSheduled(bytes);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  }</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;}</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div><div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a851f8e0daa480bb26f6c3847a1c6f7ec"> 1541</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a851f8e0daa480bb26f6c3847a1c6f7ec">HTTPTransaction::updateTransactionBytesSent</a>(uint64_t bytes) {</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  CHECK(<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>);</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keywordflow">if</span> (bytes) {</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>-&gt;updateTransactionBytesSent(bytes);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  }</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;}</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div><div class="line"><a name="l01548"></a><span class="lineno"><a class="line" href="classproxygen_1_1HTTPTransaction.html#a9d76c7f95693773bb492367fa6a6787a"> 1548</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classproxygen_1_1HTTPTransaction.html#a9d76c7f95693773bb492367fa6a6787a">HTTPTransaction::getPrioritySampleSummary</a>(</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <a class="code" href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html">HTTPTransaction::PrioritySampleSummary</a>&amp; summary)<span class="keyword"> const </span>{</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>) {</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <a class="code" href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">prioritySample_</a>-&gt;getSummary(summary);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  }</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;}</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;} <span class="comment">// proxygen</span></div><div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_html_a9f9f9c9c297aba9e43494a7dfd4254c8"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html#a9f9f9c9c297aba9e43494a7dfd4254c8">proxygen::HTTPTransaction::PrioritySampleSummary::contentions_</a></div><div class="ttdeci">WeightedAverage contentions_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01210">HTTPTransaction.h:1210</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aec29fb741786a8bcfe781a9a809e0159"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aec29fb741786a8bcfe781a9a809e0159">proxygen::HTTPTransaction::isPushed</a></div><div class="ttdeci">bool isPushed() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01011">HTTPTransaction.h:1011</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a35558444e6e7864fdc097e1263a27b3c"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a35558444e6e7864fdc097e1263a27b3c">proxygen::HTTPTransaction::sendDeferredBody</a></div><div class="ttdeci">size_t sendDeferredBody(uint32_t maxEgress)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00823">HTTPTransaction.cpp:823</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a4a2269f00d4980b9799843f94fb2dc09"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a4a2269f00d4980b9799843f94fb2dc09">proxygen::HTTPTransaction::numLimitedBytesEgressed_</a></div><div class="ttdeci">uint64_t numLimitedBytesEgressed_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01488">HTTPTransaction.h:1488</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_a08a22f1b3b1b494d43aa839483f93715"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#a08a22f1b3b1b494d43aa839483f93715">proxygen::HTTPTransactionTransportCallback::lastByteAcked</a></div><div class="ttdeci">virtual void lastByteAcked(std::chrono::milliseconds latency) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2f9237117b2220cf1b495c591d35bdfd"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2f9237117b2220cf1b495c591d35bdfd">proxygen::HTTPTransaction::isPrioritySampled</a></div><div class="ttdeci">bool isPrioritySampled() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01195">HTTPTransaction.h:1195</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a28e1edd6a2239064cc243291f4272234"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a28e1edd6a2239064cc243291f4272234">proxygen::HTTPTransaction::sendAbort</a></div><div class="ttdeci">virtual void sendAbort()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01056">HTTPTransaction.cpp:1056</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_aae354d8bb159cb5a337048a4e7ed384e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aae354d8bb159cb5a337048a4e7ed384e">proxygen::HTTPTransaction::PrioritySample::depth_</a></div><div class="ttdeci">WeightedValue depth_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01500">HTTPTransaction.cpp:1500</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ae964af29eff98740360a8d7a02b88720"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ae964af29eff98740360a8d7a02b88720">proxygen::HTTPTransaction::resumeIngress</a></div><div class="ttdeci">virtual void resumeIngress()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01093">HTTPTransaction.cpp:1093</a></div></div>
<div class="ttc" id="namespaceproxygen_html_ac167448283d2eb2403c01822410d956da71d1707a93df7151bf58b8a5f6030846"><div class="ttname"><a href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da71d1707a93df7151bf58b8a5f6030846">proxygen::kErrorParseBody</a></div><div class="ttdef"><b>Definition:</b> <a href="ProxygenErrorEnum_8h_source.html#l00076">ProxygenErrorEnum.h:76</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_af50de2d1a784ae9eeb207473781103e0"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#af50de2d1a784ae9eeb207473781103e0">proxygen::HTTPTransaction::resumeEgress</a></div><div class="ttdeci">void resumeEgress()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01170">HTTPTransaction.cpp:1170</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a2d5fbaa7d2eb616f56541d3189553cc6"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a2d5fbaa7d2eb616f56541d3189553cc6">proxygen::HTTPTransaction::Transport::resumeIngress</a></div><div class="ttdeci">virtual void resumeIngress(HTTPTransaction *txn) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTP2PriorityQueueBase_html_a84127d301f6e185dd2fdf92d8fbf63f6"><div class="ttname"><a href="classproxygen_1_1HTTP2PriorityQueueBase.html#a84127d301f6e185dd2fdf92d8fbf63f6">proxygen::HTTP2PriorityQueueBase::getRootId</a></div><div class="ttdeci">HTTPCodec::StreamID getRootId()</div><div class="ttdef"><b>Definition:</b> <a href="HTTP2PriorityQueue_8h_source.html#l00061">HTTP2PriorityQueue.h:61</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ac1d43f93fad6acb9c5764e0b0dc8bd16"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ac1d43f93fad6acb9c5764e0b0dc8bd16">proxygen::HTTPTransaction::onError</a></div><div class="ttdeci">void onError(const HTTPException &amp;error)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00535">HTTPTransaction.cpp:535</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a9d65c4524f5e38f10d42e0290d51fea6"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a9d65c4524f5e38f10d42e0290d51fea6">proxygen::HTTPTransactionHandler::onPushedTransaction</a></div><div class="ttdeci">virtual void onPushedTransaction(HTTPTransaction *) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00241">HTTPTransaction.h:241</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_afa5079eadcc6a6efa4b9a5d4b744ed0fa54f5ce060c26e64cc1fdea3c2f602000"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa54f5ce060c26e64cc1fdea3c2f602000">proxygen::HTTPEvent::Type::MESSAGE_COMPLETE</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a4be280b06dbdc5c8f9bc01fa9edd1387"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a4be280b06dbdc5c8f9bc01fa9edd1387">proxygen::HTTPTransaction::egressLimitBytesPerMs_</a></div><div class="ttdeci">uint64_t egressLimitBytesPerMs_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01486">HTTPTransaction.h:1486</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_acf377e6941a4b536de594a81cbe06d8b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#acf377e6941a4b536de594a81cbe06d8b">proxygen::HTTPTransaction::processIngressChunkHeader</a></div><div class="ttdeci">void processIngressChunkHeader(size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00324">HTTPTransaction.cpp:324</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ae5960b3f86681f8df51ac9300cf5595b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ae5960b3f86681f8df51ac9300cf5595b">proxygen::HTTPTransaction::onWriteReady</a></div><div class="ttdeci">bool onWriteReady(uint32_t maxEgress, double ratio)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00810">HTTPTransaction.cpp:810</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a7e3d429b572296fce7f5873f262004ce"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a7e3d429b572296fce7f5873f262004ce">proxygen::HTTPTransaction::direction_</a></div><div class="ttdeci">const TransportDirection direction_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01358">HTTPTransaction.h:1358</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_abaaa6ab586280055cb83a4d5e93634b8"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#abaaa6ab586280055cb83a4d5e93634b8">proxygen::HTTPTransaction::id_</a></div><div class="ttdeci">HTTPCodec::StreamID id_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01359">HTTPTransaction.h:1359</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a0b9d734dcc524c63c05da5939c130c2c"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a0b9d734dcc524c63c05da5939c130c2c">proxygen::HTTPTransaction::recvWindow_</a></div><div class="ttdeci">Window recvWindow_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01376">HTTPTransaction.h:1376</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a3d6f6c837ecc1ee254de4e790826ae9ba20973c7b1b8e3fe85f3926d10271a8d4"><div class="ttname"><a href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba20973c7b1b8e3fe85f3926d10271a8d4">proxygen::ErrorCode::FLOW_CONTROL_ERROR</a></div></div>
<div class="ttc" id="namespaceproxygen_html_ae94f36adf5ce28528d9e34c9ba9cc5f8"><div class="ttname"><a href="namespaceproxygen.html#ae94f36adf5ce28528d9e34c9ba9cc5f8">proxygen::millisecondsBetween</a></div><div class="ttdeci">std::chrono::milliseconds millisecondsBetween(std::chrono::time_point&lt; ClockType &gt; finish, std::chrono::time_point&lt; ClockType &gt; start)</div><div class="ttdef"><b>Definition:</b> <a href="Time_8h_source.html#l00085">Time.h:85</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_afed10e71d54fe38461ed236a0ed411f4"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#afed10e71d54fe38461ed236a0ed411f4">proxygen::HTTPTransaction::isIngressEOMSeen</a></div><div class="ttdeci">bool isIngressEOMSeen() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00731">HTTPTransaction.h:731</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html">proxygen::HTTPEvent</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPEvent_8h_source.html#l00027">HTTPEvent.h:27</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aa82560a6af2507dd29b6429df4e495f8"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aa82560a6af2507dd29b6429df4e495f8">proxygen::HTTPTransaction::processIngressHeadersComplete</a></div><div class="ttdeci">void processIngressHeadersComplete(std::unique_ptr&lt; HTTPMessage &gt; msg)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00204">HTTPTransaction.cpp:204</a></div></div>
<div class="ttc" id="namespaceproxygen_1_1RFC2616_html_a190e9a54e16965094cb9d3e476eb35fb"><div class="ttname"><a href="namespaceproxygen_1_1RFC2616.html#a190e9a54e16965094cb9d3e476eb35fb">proxygen::RFC2616::responseBodyMustBeEmpty</a></div><div class="ttdeci">bool responseBodyMustBeEmpty(unsigned status)</div><div class="ttdef"><b>Definition:</b> <a href="RFC2616_8cpp_source.html#l00054">RFC2616.cpp:54</a></div></div>
<div class="ttc" id="HTTPTransaction_8h_html"><div class="ttname"><a href="HTTPTransaction_8h.html">HTTPTransaction.h</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ab0fac97a4fe14aebb9f05f9751ec428f"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ab0fac97a4fe14aebb9f05f9751ec428f">proxygen::HTTPTransaction::lastResponseStatus_</a></div><div class="ttdeci">uint16_t lastResponseStatus_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01461">HTTPTransaction.h:1461</a></div></div>
<div class="ttc" id="SPDYCodec_8cpp_html_a6d7c29827e855a62945ede0ae6e82786"><div class="ttname"><a href="SPDYCodec_8cpp.html#a6d7c29827e855a62945ede0ae6e82786">statusCode</a></div><div class="ttdeci">spdy::GoawayStatusCode statusCode</div><div class="ttdef"><b>Definition:</b> <a href="SPDYCodec_8cpp_source.html#l00110">SPDYCodec.cpp:110</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a030cb3bae08736b2a9e57877f31cf9c0"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a030cb3bae08736b2a9e57877f31cf9c0">proxygen::HTTPTransaction::rateLimitTimeoutExpired</a></div><div class="ttdeci">void rateLimitTimeoutExpired()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00948">HTTPTransaction.cpp:948</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a9d76c7f95693773bb492367fa6a6787a"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a9d76c7f95693773bb492367fa6a6787a">proxygen::HTTPTransaction::getPrioritySampleSummary</a></div><div class="ttdeci">bool getPrioritySampleSummary(PrioritySampleSummary &amp;summary) const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01548">HTTPTransaction.cpp:1548</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a6df2dac550e90e25d05a86e6f6050944"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a6df2dac550e90e25d05a86e6f6050944">proxygen::HTTPTransaction::processIngressEOM</a></div><div class="ttdeci">void processIngressEOM()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00457">HTTPTransaction.cpp:457</a></div></div>
<div class="ttc" id="classproxygen_1_1Window_html_a59e739a83cce8a0fc22c9dce48a0b193"><div class="ttname"><a href="classproxygen_1_1Window.html#a59e739a83cce8a0fc22c9dce48a0b193">proxygen::Window::getCapacity</a></div><div class="ttdeci">uint32_t getCapacity() const </div><div class="ttdef"><b>Definition:</b> <a href="Window_8cpp_source.html#l00032">Window.cpp:32</a></div></div>
<div class="ttc" id="classproxygen_1_1Exception_html_af1367ee45a543354d6527bcc1f17a059"><div class="ttname"><a href="classproxygen_1_1Exception.html#af1367ee45a543354d6527bcc1f17a059">proxygen::Exception::getProxygenError</a></div><div class="ttdeci">ProxygenError getProxygenError() const </div><div class="ttdef"><b>Definition:</b> <a href="Exception_8h_source.html#l00050">Exception.h:50</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a0a50acdb32cb51ecbf6a72730053a36b"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a0a50acdb32cb51ecbf6a72730053a36b">proxygen::HTTPTransactionHandler::onEgressPaused</a></div><div class="ttdeci">virtual void onEgressPaused() noexcept=0</div></div>
<div class="ttc" id="structproxygen_1_1CompressionInfo_html_a22477e99d07b08d4f8fdb72b65479de2"><div class="ttname"><a href="structproxygen_1_1CompressionInfo.html#a22477e99d07b08d4f8fdb72b65479de2">proxygen::CompressionInfo::egressHeaderTableSize_</a></div><div class="ttdeci">uint32_t egressHeaderTableSize_</div><div class="ttdef"><b>Definition:</b> <a href="CompressionInfo_8h_source.html#l00021">CompressionInfo.h:21</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2019b1e0b9d117ac14a2843035913769"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2019b1e0b9d117ac14a2843035913769">proxygen::HTTPTransaction::updateEgressCompressionInfo</a></div><div class="ttdeci">void updateEgressCompressionInfo(const CompressionInfo &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01250">HTTPTransaction.cpp:1250</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_abd55976c86db66e98b1f45ec5802fee5"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#abd55976c86db66e98b1f45ec5802fee5">proxygen::HTTPTransaction::onEgressBodyFirstByte</a></div><div class="ttdeci">void onEgressBodyFirstByte()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00700">HTTPTransaction.cpp:700</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_afa5079eadcc6a6efa4b9a5d4b744ed0fa786329b34bbe53ab40a54a19cd597f2d"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa786329b34bbe53ab40a54a19cd597f2d">proxygen::HTTPEvent::Type::BODY</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a77e7c4baec66ad683f55a3cc3e39f45c"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a77e7c4baec66ad683f55a3cc3e39f45c">proxygen::HTTPTransaction::isIngressComplete</a></div><div class="ttdeci">bool isIngressComplete() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00724">HTTPTransaction.h:724</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a708d14cbb2dacbfffbe455f5b7941fffae15e216fc1c639f787b1231ecdfa1bf8"><div class="ttname"><a href="namespaceproxygen.html#a708d14cbb2dacbfffbe455f5b7941fffae15e216fc1c639f787b1231ecdfa1bf8">proxygen::HTTPMethod::HEAD</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a5d2dcd1fd37bd350f0f3d096b1f42e30"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a5d2dcd1fd37bd350f0f3d096b1f42e30">proxygen::HTTPTransaction::checkCreateDeferredIngress</a></div><div class="ttdeci">void checkCreateDeferredIngress()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01268">HTTPTransaction.cpp:1268</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPCodec_html_a4e0b7580b74da507c77553ef7891bc0e"><div class="ttname"><a href="classproxygen_1_1HTTPCodec.html#a4e0b7580b74da507c77553ef7891bc0e">proxygen::HTTPCodec::getCompressionInfo</a></div><div class="ttdeci">virtual CompressionInfo getCompressionInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPCodec_8h_source.html#l00338">HTTPCodec.h:338</a></div></div>
<div class="ttc" id="structproxygen_1_1CompressionInfo_html_adbf738f1a934cdfe112a41c883bfa5e4"><div class="ttname"><a href="structproxygen_1_1CompressionInfo.html#adbf738f1a934cdfe112a41c883bfa5e4">proxygen::CompressionInfo::ingressHeaderTableSize_</a></div><div class="ttdeci">uint32_t ingressHeaderTableSize_</div><div class="ttdef"><b>Definition:</b> <a href="CompressionInfo_8h_source.html#l00026">CompressionInfo.h:26</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_ad4befff61cff93d6e2c9459e39556419"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#ad4befff61cff93d6e2c9459e39556419">proxygen::HTTPTransactionHandler::onChunkComplete</a></div><div class="ttdeci">virtual void onChunkComplete() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00180">HTTPTransaction.h:180</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator_html_a3c9724eba927afeff034fc65eb403070"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a3c9724eba927afeff034fc65eb403070">proxygen::HTTPTransaction::PrioritySample::WeightedAccumulator::accumulateTotal</a></div><div class="ttdeci">void accumulateTotal(uint64_t total)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01409">HTTPTransaction.cpp:1409</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a1617cb8241e173bf5635c01eae5cc12f"><div class="ttname"><a href="namespaceproxygen.html#a1617cb8241e173bf5635c01eae5cc12f">proxygen::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, const HeaderTable &amp;table)</div><div class="ttdef"><b>Definition:</b> <a href="HeaderTable_8cpp_source.html#l00254">HeaderTable.cpp:254</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPSessionStats_html"><div class="ttname"><a href="classproxygen_1_1HTTPSessionStats.html">proxygen::HTTPSessionStats</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPSessionStats_8h_source.html#l00019">HTTPSessionStats.h:19</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a7715b02e413859c26426adbbde7e53d8"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a7715b02e413859c26426adbbde7e53d8">proxygen::HTTPTransactionHandler::onEgressResumed</a></div><div class="ttdeci">virtual void onEgressResumed() noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_af62e6acda8c5bb199bb5c7fb74867f6f"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#af62e6acda8c5bb199bb5c7fb74867f6f">proxygen::HTTPTransaction::setReceiveWindow</a></div><div class="ttdeci">virtual void setReceiveWindow(uint32_t capacity)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01326">HTTPTransaction.cpp:1326</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue_html_a8cf73c242547c1cf58f0aec25d4622e4"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a8cf73c242547c1cf58f0aec25d4622e4">proxygen::HTTPTransaction::PrioritySample::WeightedValue::accumulateByTransactionBytes</a></div><div class="ttdeci">void accumulateByTransactionBytes(uint64_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01424">HTTPTransaction.cpp:1424</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_af70fc7a7918b5c087c4d3ce93ba3e73a"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#af70fc7a7918b5c087c4d3ce93ba3e73a">proxygen::HTTPTransaction::trailers_</a></div><div class="ttdeci">std::unique_ptr&lt; HTTPHeaders &gt; trailers_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01389">HTTPTransaction.h:1389</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ab2728d681b3faa0ebe646adbb1b0b25c"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ab2728d681b3faa0ebe646adbb1b0b25c">proxygen::HTTPTransaction::egressRateLimited_</a></div><div class="ttdeci">bool egressRateLimited_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01471">HTTPTransaction.h:1471</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html_a45d6add97607abbb4a2795980850d8ef"><div class="ttname"><a href="classproxygen_1_1HTTPException.html#a45d6add97607abbb4a2795980850d8ef">proxygen::HTTPException::hasCodecStatusCode</a></div><div class="ttdeci">bool hasCodecStatusCode() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPException_8h_source.html#l00095">HTTPException.h:95</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_abe33bf69be66a24c82a38b13ee087b42"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#abe33bf69be66a24c82a38b13ee087b42">proxygen::HTTPTransactionHandler::onGoaway</a></div><div class="ttdeci">virtual void onGoaway(ErrorCode) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00256">HTTPTransaction.h:256</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a4471d40c95555b058e2721955e432fea"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a4471d40c95555b058e2721955e432fea">proxygen::HTTPTransaction::Transport::sendHeaders</a></div><div class="ttdeci">virtual void sendHeaders(HTTPTransaction *txn, const HTTPMessage &amp;headers, HTTPHeaderSize *size, bool eom) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_acdd10519941d283b375243d7420d6fa2"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#acdd10519941d283b375243d7420d6fa2">proxygen::HTTPTransaction::processIngressChunkComplete</a></div><div class="ttdeci">void processIngressChunkComplete()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00350">HTTPTransaction.cpp:350</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ae2a381874a7a920eb1e3c8a6852254f9"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ae2a381874a7a920eb1e3c8a6852254f9">proxygen::HTTPTransaction::handler_</a></div><div class="ttdeci">Handler * handler_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01361">HTTPTransaction.h:1361</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a3229605c4d71bcf5379d0dd133870421"><div class="ttname"><a href="namespaceproxygen.html#a3229605c4d71bcf5379d0dd133870421">proxygen::HTTPHeaderSize</a></div><div class="ttdeci">wangle::HTTPHeaderSize HTTPHeaderSize</div><div class="ttdef"><b>Definition:</b> <a href="HTTPHeaderSize_8h_source.html#l00018">HTTPHeaderSize.h:18</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_a292b71139b2237cde4ada3373c07a06e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a292b71139b2237cde4ada3373c07a06e">proxygen::HTTPTransaction::PrioritySample::tnx_</a></div><div class="ttdeci">HTTPTransaction * tnx_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01498">HTTPTransaction.cpp:1498</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ade30487710a3c3b15441fe518dc4394e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ade30487710a3c3b15441fe518dc4394e">proxygen::HTTPTransaction::onIngressChunkComplete</a></div><div class="ttdeci">void onIngressChunkComplete()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00335">HTTPTransaction.cpp:335</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a585c21327eb30ab85ebdb84f663dab3b"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a585c21327eb30ab85ebdb84f663dab3b">proxygen::HTTPTransactionHandler::onError</a></div><div class="ttdeci">virtual void onError(const HTTPException &amp;error) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_a1b9eebf6c60e684702be9114cf6faa02"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a1b9eebf6c60e684702be9114cf6faa02">proxygen::HTTPTransaction::PrioritySample::contentions_</a></div><div class="ttdeci">WeightedValue contentions_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01499">HTTPTransaction.cpp:1499</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPMessage_html_ac064c15b921026a767bf252aee16e8ef"><div class="ttname"><a href="classproxygen_1_1HTTPMessage.html#ac064c15b921026a767bf252aee16e8ef">proxygen::HTTPMessage::getStatusCode</a></div><div class="ttdeci">uint16_t getStatusCode() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPMessage_8cpp_source.html#l00340">HTTPMessage.cpp:340</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_a5ef8dc83f2158fc452f029e3f3f40a71"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#a5ef8dc83f2158fc452f029e3f3f40a71">proxygen::HTTPTransactionTransportCallback::bodyBytesReceived</a></div><div class="ttdeci">virtual void bodyBytesReceived(size_t size) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_af62ff7bd7b8f57ee839d95fcbdecd498"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#af62ff7bd7b8f57ee839d95fcbdecd498">proxygen::HTTPTransaction::Transport::sendChunkTerminator</a></div><div class="ttdeci">virtual size_t sendChunkTerminator(HTTPTransaction *txn) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_afa5079eadcc6a6efa4b9a5d4b744ed0fa0f2810d6dd9e145dc07a1eb52d1bf7de"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa0f2810d6dd9e145dc07a1eb52d1bf7de">proxygen::HTTPEvent::Type::HEADERS_COMPLETE</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTP2PriorityQueueBase_html_a79981b30f800a1f4872ddbd708c1bc5a"><div class="ttname"><a href="classproxygen_1_1HTTP2PriorityQueueBase.html#a79981b30f800a1f4872ddbd708c1bc5a">proxygen::HTTP2PriorityQueueBase::updatePriority</a></div><div class="ttdeci">virtual Handle updatePriority(Handle handle, http2::PriorityUpdate pri, uint64_t *depth=nullptr)=0</div></div>
<div class="ttc" id="classproxygen_1_1Window_html_a3262de58877c59dd8367caa96088a30e"><div class="ttname"><a href="classproxygen_1_1Window.html#a3262de58877c59dd8367caa96088a30e">proxygen::Window::getOutstanding</a></div><div class="ttdeci">uint32_t getOutstanding() const </div><div class="ttdef"><b>Definition:</b> <a href="Window_8cpp_source.html#l00037">Window.cpp:37</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ac7f3655a5f69420aacf1501ce1d4818d"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ac7f3655a5f69420aacf1501ce1d4818d">proxygen::HTTPTransaction::startRateLimit_</a></div><div class="ttdeci">proxygen::TimePoint startRateLimit_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01487">HTTPTransaction.h:1487</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a715b0b12bf67788bf0db9318e3d61e14"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a715b0b12bf67788bf0db9318e3d61e14">proxygen::HTTPTransaction::flushWindowUpdate</a></div><div class="ttdeci">void flushWindowUpdate()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01346">HTTPTransaction.cpp:1346</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a7e4b1c3f7b3c86f941aab14e76ffcf13"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a7e4b1c3f7b3c86f941aab14e76ffcf13">proxygen::HTTPTransaction::seqNo_</a></div><div class="ttdeci">uint32_t seqNo_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01360">HTTPTransaction.h:1360</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a8c6aa03b14a2f69b5672f8b8b9e61b04"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a8c6aa03b14a2f69b5672f8b8b9e61b04">proxygen::HTTPTransaction::Transport::isDraining</a></div><div class="ttdeci">virtual bool isDraining() const =0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a67eb253d121a26772f4caa56847ed7cd"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a67eb253d121a26772f4caa56847ed7cd">proxygen::HTTPTransactionHandler::detachTransaction</a></div><div class="ttdeci">virtual void detachTransaction() noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2ef41693d605402f44b89b8652feb8c9"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2ef41693d605402f44b89b8652feb8c9">proxygen::HTTPTransaction::reset</a></div><div class="ttdeci">void reset(bool useFlowControl, uint32_t receiveInitialWindowSize, uint32_t receiveStreamWindowSize, uint32_t sendInitialWindowSize)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00149">HTTPTransaction.cpp:149</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aa1452a5a8322901be423c0dcd6de76ef"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aa1452a5a8322901be423c0dcd6de76ef">proxygen::HTTPTransaction::updateIngressCompressionInfo</a></div><div class="ttdeci">void updateIngressCompressionInfo(const CompressionInfo &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01240">HTTPTransaction.cpp:1240</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html_a63d32340ce3200c654122f8e40d27954a5ba463f336572a8840e1e782bb0be238"><div class="ttname"><a href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a5ba463f336572a8840e1e782bb0be238">proxygen::HTTPException::Direction::EGRESS</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_afd2a8c1999c8e55fa028665061f4bd78"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#afd2a8c1999c8e55fa028665061f4bd78">proxygen::HTTPTransaction::PrioritySample::getSummary</a></div><div class="ttdeci">void getSummary(HTTPTransaction::PrioritySampleSummary &amp;summary) const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01490">HTTPTransaction.cpp:1490</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a3d6f6c837ecc1ee254de4e790826ae9ba23f149f0f9ae9ed9e0119e7209178a5d"><div class="ttname"><a href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba23f149f0f9ae9ed9e0119e7209178a5d">proxygen::ErrorCode::PROTOCOL_ERROR</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_html_abca443e784296d54ad69b95a4f0f9e11"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html#abca443e784296d54ad69b95a4f0f9e11">proxygen::HTTPTransaction::PrioritySampleSummary::measured_weight_</a></div><div class="ttdeci">double measured_weight_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01213">HTTPTransaction.h:1213</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1Chunk_html"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1Chunk.html">proxygen::HTTPTransaction::Chunk</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01391">HTTPTransaction.h:1391</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a3ea745988332db0c76cf337057d29040"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a3ea745988332db0c76cf337057d29040">proxygen::HTTPTransaction::onExTransaction</a></div><div class="ttdeci">bool onExTransaction(HTTPTransaction *txn)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01290">HTTPTransaction.cpp:1290</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aa6c3daac07778c3ac00f41acd8ef1091"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aa6c3daac07778c3ac00f41acd8ef1091">proxygen::HTTPTransaction::setIdleTimeout</a></div><div class="ttdeci">void setIdleTimeout(std::chrono::milliseconds transactionTimeout)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01306">HTTPTransaction.cpp:1306</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator_html_a9a19b9f0e020d8b9188609cfd1e06ed0"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a9a19b9f0e020d8b9188609cfd1e06ed0">proxygen::HTTPTransaction::PrioritySample::WeightedAccumulator::accumulateWeighted</a></div><div class="ttdeci">void accumulateWeighted(uint64_t weighted)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01405">HTTPTransaction.cpp:1405</a></div></div>
<div class="ttc" id="classproxygen_1_1Exception_html_a96189a5e5d3636599b7af7337437e77f"><div class="ttname"><a href="classproxygen_1_1Exception.html#a96189a5e5d3636599b7af7337437e77f">proxygen::Exception::setProxygenError</a></div><div class="ttdeci">void setProxygenError(ProxygenError proxygenError)</div><div class="ttdef"><b>Definition:</b> <a href="Exception_8h_source.html#l00046">Exception.h:46</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_acda954bf78c4d2aad951698e78c40a0f"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#acda954bf78c4d2aad951698e78c40a0f">proxygen::HTTPTransactionHandler::onUpgrade</a></div><div class="ttdeci">virtual void onUpgrade(UpgradeProtocol protocol) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_ab689d82403553c69944197d9fbbeedf1"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#ab689d82403553c69944197d9fbbeedf1">proxygen::HTTPTransactionTransportCallback::lastByteFlushed</a></div><div class="ttdeci">virtual void lastByteFlushed() noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_acc3ee9bf51e57e0b7f9635a093659d8b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#acc3ee9bf51e57e0b7f9635a093659d8b">proxygen::HTTPTransaction::getCompressionInfo</a></div><div class="ttdeci">const CompressionInfo &amp; getCompressionInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01260">HTTPTransaction.cpp:1260</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a7be28e684b8611cfdd26bf3207a1f51f"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a7be28e684b8611cfdd26bf3207a1f51f">proxygen::HTTPTransaction::onIngressBody</a></div><div class="ttdeci">void onIngressBody(std::unique_ptr&lt; folly::IOBuf &gt; chain, uint16_t padding)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00216">HTTPTransaction.cpp:216</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_aa760cd4a327aaa62293b1d09c5811298"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#aa760cd4a327aaa62293b1d09c5811298">proxygen::HTTPTransactionHandler::onChunkHeader</a></div><div class="ttdeci">virtual void onChunkHeader(size_t) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00173">HTTPTransaction.h:173</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a130dbdc5432fa4f37f41ef1a595b964c"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a130dbdc5432fa4f37f41ef1a595b964c">proxygen::HTTPTransaction::recvToAck_</a></div><div class="ttdeci">int32_t recvToAck_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01411">HTTPTransaction.h:1411</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_af25b6716fa6640e4fcef4a7595e66b11"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#af25b6716fa6640e4fcef4a7595e66b11">proxygen::HTTPTransaction::PrioritySample::updateSessionBytesSheduled</a></div><div class="ttdeci">void updateSessionBytesSheduled(uint64_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01469">HTTPTransaction.cpp:1469</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html"><div class="ttname"><a href="classproxygen_1_1HTTPException.html">proxygen::HTTPException</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPException_8h_source.html#l00026">HTTPException.h:26</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTP2PriorityQueueBase_html"><div class="ttname"><a href="classproxygen_1_1HTTP2PriorityQueueBase.html">proxygen::HTTP2PriorityQueueBase</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTP2PriorityQueue_8h_source.html#l00027">HTTP2PriorityQueue.h:27</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator_html_a0e48d5522d53c88ec33ad9cc4845e264"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a0e48d5522d53c88ec33ad9cc4845e264">proxygen::HTTPTransaction::PrioritySample::WeightedAccumulator::accumulate</a></div><div class="ttdeci">void accumulate(uint64_t weighted, uint64_t total)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01400">HTTPTransaction.cpp:1400</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a391c4185f224b050a68d2ce6176e6aa3"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a391c4185f224b050a68d2ce6176e6aa3">proxygen::HTTPTransaction::notifyTransportPendingEgress</a></div><div class="ttdeci">void notifyTransportPendingEgress()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01190">HTTPTransaction.cpp:1190</a></div></div>
<div class="ttc" id="namespaceproxygen_html_ac167448283d2eb2403c01822410d956da973718c9a40010086e7ba12e4b1bc07d"><div class="ttname"><a href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da973718c9a40010086e7ba12e4b1bc07d">proxygen::kErrorIngressStateTransition</a></div><div class="ttdef"><b>Definition:</b> <a href="ProxygenErrorEnum_8h_source.html#l00076">ProxygenErrorEnum.h:76</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ab32157f5fafa1cec6e22685c5f7b529e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ab32157f5fafa1cec6e22685c5f7b529e">proxygen::HTTPTransaction::hasPendingEOM</a></div><div class="ttdeci">bool hasPendingEOM() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01289">HTTPTransaction.h:1289</a></div></div>
<div class="ttc" id="namespacefolly_html"><div class="ttname"><a href="namespacefolly.html">folly</a></div><div class="ttdef"><b>Definition:</b> <a href="HeaderCodec_8h_source.html#l00020">HeaderCodec.h:20</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html_a3dc0e569f9753f484a6e26ac0c8ab5c3"><div class="ttname"><a href="classproxygen_1_1HTTPException.html#a3dc0e569f9753f484a6e26ac0c8ab5c3">proxygen::HTTPException::setCodecStatusCode</a></div><div class="ttdeci">void setCodecStatusCode(ErrorCode statusCode)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPException_8h_source.html#l00098">HTTPException.h:98</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTP2PriorityQueueBase_1_1BaseNode_html_ae5abfb9239fce01e8b66097c0a0368f4"><div class="ttname"><a href="classproxygen_1_1HTTP2PriorityQueueBase_1_1BaseNode.html#ae5abfb9239fce01e8b66097c0a0368f4">proxygen::HTTP2PriorityQueueBase::BaseNode::calculateDepth</a></div><div class="ttdeci">virtual uint64_t calculateDepth(bool includeVirtual=true) const =0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a3fb44b6e36a49d30e44e67eb1c789bfc"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a3fb44b6e36a49d30e44e67eb1c789bfc">proxygen::HTTPTransaction::isEgressEOMQueued</a></div><div class="ttdeci">bool isEgressEOMQueued() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00746">HTTPTransaction.h:746</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_html_ae7a6f6c9d399caa7f9f822d9f9978c29"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html#ae7a6f6c9d399caa7f9f822d9f9978c29">proxygen::HTTPTransaction::PrioritySampleSummary::depth_</a></div><div class="ttdeci">WeightedAverage depth_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01211">HTTPTransaction.h:1211</a></div></div>
<div class="ttc" id="structproxygen_1_1http2_1_1PriorityUpdate_html"><div class="ttname"><a href="structproxygen_1_1http2_1_1PriorityUpdate.html">proxygen::http2::PriorityUpdate</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTP2Framer_8h_source.html#l00083">HTTP2Framer.h:83</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a8087cecb501660955abf898a7ed8e0e0"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a8087cecb501660955abf898a7ed8e0e0">proxygen::HTTPTransaction::updateSessionBytesSheduled</a></div><div class="ttdeci">void updateSessionBytesSheduled(uint64_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01526">HTTPTransaction.cpp:1526</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a708d14cbb2dacbfffbe455f5b7941fffab57e2519e26151feacdbe52076bc39ec"><div class="ttname"><a href="namespaceproxygen.html#a708d14cbb2dacbfffbe455f5b7941fffab57e2519e26151feacdbe52076bc39ec">proxygen::HTTPMethod::CONNECT</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a08dccd5abf8db88ded29183b9a81b787"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a08dccd5abf8db88ded29183b9a81b787">proxygen::HTTPTransaction::transport_</a></div><div class="ttdeci">Transport &amp; transport_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01362">HTTPTransaction.h:1362</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a40868f9faa2e3b0a095a56ec4da4057e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a40868f9faa2e3b0a095a56ec4da4057e">proxygen::HTTPTransaction::onIngressChunkHeader</a></div><div class="ttdeci">void onIngressChunkHeader(size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00309">HTTPTransaction.cpp:309</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a7feed732013b7cc0e2213b19c7b82745"><div class="ttname"><a href="namespaceproxygen.html#a7feed732013b7cc0e2213b19c7b82745">proxygen::UpgradeProtocol</a></div><div class="ttdeci">UpgradeProtocol</div><div class="ttdef"><b>Definition:</b> <a href="HTTPConstants_8h_source.html#l00061">HTTPConstants.h:61</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a4e911a58ee03620fe176f2d80572cff6"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a4e911a58ee03620fe176f2d80572cff6">proxygen::HTTPTransaction::exAttributes_</a></div><div class="ttdeci">folly::Optional&lt; HTTPCodec::ExAttributes &gt; exAttributes_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01421">HTTPTransaction.h:1421</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPSessionStats_html_a11caacb735320e219801d594fad7a1a3"><div class="ttname"><a href="classproxygen_1_1HTTPSessionStats.html#a11caacb735320e219801d594fad7a1a3">proxygen::HTTPSessionStats::recordTransactionStalled</a></div><div class="ttdeci">virtual void recordTransactionStalled() noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_a043843d043136715e1a062e509048d40"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a043843d043136715e1a062e509048d40">proxygen::HTTPTransaction::PrioritySample::updateTransactionBytesSent</a></div><div class="ttdeci">void updateTransactionBytesSent(uint64_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01456">HTTPTransaction.cpp:1456</a></div></div>
<div class="ttc" id="classproxygen_1_1Window_html_a769103af9c73585fd33b8dc686d06c65"><div class="ttname"><a href="classproxygen_1_1Window.html#a769103af9c73585fd33b8dc686d06c65">proxygen::Window::getSize</a></div><div class="ttdeci">int32_t getSize() const </div><div class="ttdef"><b>Definition:</b> <a href="Window_8cpp_source.html#l00023">Window.cpp:23</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a06c36e406876539531f70361da43355f"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a06c36e406876539531f70361da43355f">proxygen::HTTPTransaction::validateIngressStateTransition</a></div><div class="ttdeci">bool validateIngressStateTransition(HTTPTransactionIngressSM::Event)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00516">HTTPTransaction.cpp:516</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a59dfab33819a404ebee7989b3961c822"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a59dfab33819a404ebee7989b3961c822">proxygen::HTTPTransaction::maxDeferredIngress_</a></div><div class="ttdeci">uint32_t maxDeferredIngress_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01350">HTTPTransaction.h:1350</a></div></div>
<div class="ttc" id="classproxygen_1_1Window_html_a22bf8e1744def54ee887b2ae894e9e45"><div class="ttname"><a href="classproxygen_1_1Window.html#a22bf8e1744def54ee887b2ae894e9e45">proxygen::Window::reserve</a></div><div class="ttdeci">bool reserve(uint32_t amount, bool strict=true)</div><div class="ttdef"><b>Definition:</b> <a href="Window_8cpp_source.html#l00041">Window.cpp:41</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html">proxygen::HTTPTransaction</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00324">HTTPTransaction.h:324</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aa42ddb3266af71bfe85f7d925f687137"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aa42ddb3266af71bfe85f7d925f687137">proxygen::HTTPTransaction::processIngressTrailers</a></div><div class="ttdeci">void processIngressTrailers(std::unique_ptr&lt; HTTPHeaders &gt; trailers)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00377">HTTPTransaction.cpp:377</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_a9c02c5e17cca8e78b7cd6fe92ccdccba"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#a9c02c5e17cca8e78b7cd6fe92ccdccba">proxygen::HTTPTransactionTransportCallback::firstHeaderByteFlushed</a></div><div class="ttdeci">virtual void firstHeaderByteFlushed() noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_aa94aaa58fe18324c2a2449be01253efc"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aa94aaa58fe18324c2a2449be01253efc">proxygen::HTTPTransaction::PrioritySample::measured_weight_</a></div><div class="ttdeci">WeightedAccumulator measured_weight_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01502">HTTPTransaction.cpp:1502</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_ad3a4d2e4b5ea45e424ce6eae07ba4c3f"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#ad3a4d2e4b5ea45e424ce6eae07ba4c3f">proxygen::HTTPTransaction::Transport::detach</a></div><div class="ttdeci">virtual void detach(HTTPTransaction *txn) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a71da0fca7b035c9c9735aba7095ee4a1"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a71da0fca7b035c9c9735aba7095ee4a1">proxygen::HTTPTransaction::onIngressHeadersComplete</a></div><div class="ttdeci">void onIngressHeadersComplete(std::unique_ptr&lt; HTTPMessage &gt; msg)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00159">HTTPTransaction.cpp:159</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aac4c2173a96b0cad3788385bad57fc44"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aac4c2173a96b0cad3788385bad57fc44">proxygen::HTTPTransaction::onEgressTimeout</a></div><div class="ttdeci">void onEgressTimeout()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00680">HTTPTransaction.cpp:680</a></div></div>
<div class="ttc" id="structproxygen_1_1CompressionInfo_html_a8505af2a2798b0e40c86c05600f0a67b"><div class="ttname"><a href="structproxygen_1_1CompressionInfo.html#a8505af2a2798b0e40c86c05600f0a67b">proxygen::CompressionInfo::egressHeadersStored_</a></div><div class="ttdeci">uint32_t egressHeadersStored_</div><div class="ttdef"><b>Definition:</b> <a href="CompressionInfo_8h_source.html#l00023">CompressionInfo.h:23</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_af4cfe0b59bb2946669c46c8757f357e2"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#af4cfe0b59bb2946669c46c8757f357e2">proxygen::HTTPTransaction::assocStreamId_</a></div><div class="ttdeci">folly::Optional&lt; HTTPCodec::StreamID &gt; assocStreamId_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01416">HTTPTransaction.h:1416</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_ac0fb3a17ef16423dfb2dda5cf547aaa2"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#ac0fb3a17ef16423dfb2dda5cf547aaa2">proxygen::HTTPEvent::getEvent</a></div><div class="ttdeci">Type getEvent() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPEvent_8h_source.html#l00083">HTTPEvent.h:83</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a1312c67091b2326bbe9f2a4a3e9e614d"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a1312c67091b2326bbe9f2a4a3e9e614d">proxygen::HTTPTransaction::mustQueueIngress</a></div><div class="ttdeci">bool mustQueueIngress() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01264">HTTPTransaction.cpp:1264</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a233a1f58c07415b031e1636a6333a172"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a233a1f58c07415b031e1636a6333a172">proxygen::HTTPTransaction::onIngressTrailers</a></div><div class="ttdeci">void onIngressTrailers(std::unique_ptr&lt; HTTPHeaders &gt; trailers)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00361">HTTPTransaction.cpp:361</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a00b4cbb0c54e966bfd87e0e7cb1cb33daf8e7627f40cd51bcb234401511c640fd"><div class="ttname"><a href="namespaceproxygen.html#a00b4cbb0c54e966bfd87e0e7cb1cb33daf8e7627f40cd51bcb234401511c640fd">proxygen::TransportDirection::DOWNSTREAM</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_aa96a73e5678d7647ea4cc03f9142388d"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#aa96a73e5678d7647ea4cc03f9142388d">proxygen::HTTPTransaction::PrioritySample::PrioritySample</a></div><div class="ttdeci">PrioritySample(HTTPTransaction *tnx)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01445">HTTPTransaction.cpp:1445</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_afa5079eadcc6a6efa4b9a5d4b744ed0fae0fc80012eacfd179a3045b6a25d921d"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fae0fc80012eacfd179a3045b6a25d921d">proxygen::HTTPEvent::Type::CHUNK_COMPLETE</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a5a59ec7ac8412d0d45ec93631dacbbd3"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a5a59ec7ac8412d0d45ec93631dacbbd3">proxygen::HTTPTransaction::deleting_</a></div><div class="ttdeci">bool deleting_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01474">HTTPTransaction.h:1474</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aa0acb82e5fec7d6ab61c9e5ac2a54f09"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aa0acb82e5fec7d6ab61c9e5ac2a54f09">proxygen::HTTPTransaction::sendBodyNow</a></div><div class="ttdeci">size_t sendBodyNow(std::unique_ptr&lt; folly::IOBuf &gt; body, size_t bodyLen, bool eom)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00964">HTTPTransaction.cpp:964</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a5aa84f5d6023b600935a8ff16177e28a"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a5aa84f5d6023b600935a8ff16177e28a">proxygen::HTTPTransaction::onGoaway</a></div><div class="ttdeci">void onGoaway(ErrorCode code)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00609">HTTPTransaction.cpp:609</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_af49f69623208256d6af6d317f7ba8cd4"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#af49f69623208256d6af6d317f7ba8cd4">proxygen::HTTPTransaction::onIngressEOM</a></div><div class="ttdeci">void onIngressEOM()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00413">HTTPTransaction.cpp:413</a></div></div>
<div class="ttc" id="namespaceproxygen_html_ac167448283d2eb2403c01822410d956da60580b04a0444f809e2270068d934fa5"><div class="ttname"><a href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da60580b04a0444f809e2270068d934fa5">proxygen::kErrorWriteTimeout</a></div><div class="ttdef"><b>Definition:</b> <a href="ProxygenErrorEnum_8h_source.html#l00076">ProxygenErrorEnum.h:76</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a56a25d7fb8ac5ddf1ed5b16eaca3c5df"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a56a25d7fb8ac5ddf1ed5b16eaca3c5df">proxygen::HTTPTransactionHandler::onBody</a></div><div class="ttdeci">virtual void onBody(std::unique_ptr&lt; folly::IOBuf &gt; chain) noexcept=0</div></div>
<div class="ttc" id="structproxygen_1_1CompressionInfo_html"><div class="ttname"><a href="structproxygen_1_1CompressionInfo.html">proxygen::CompressionInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="CompressionInfo_8h_source.html#l00019">CompressionInfo.h:19</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a9af3fdd59bf5bc30fbac8ff564abe5e9"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a9af3fdd59bf5bc30fbac8ff564abe5e9">proxygen::HTTPTransaction::isExpectingIngress</a></div><div class="ttdeci">bool isExpectingIngress() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00483">HTTPTransaction.cpp:483</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html">proxygen::HTTPTransaction::PrioritySample</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01398">HTTPTransaction.cpp:1398</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPSessionStats_html_a09e2e19fb354bba950e9d38d1fefd697"><div class="ttname"><a href="classproxygen_1_1HTTPSessionStats.html#a09e2e19fb354bba950e9d38d1fefd697">proxygen::HTTPSessionStats::recordTransactionClosed</a></div><div class="ttdeci">virtual void recordTransactionClosed() noexcept=0</div></div>
<div class="ttc" id="structproxygen_1_1http2_1_1PriorityUpdate_html_a679735d9727d4589b1b12fd3a2f3d8d6"><div class="ttname"><a href="structproxygen_1_1http2_1_1PriorityUpdate.html#a679735d9727d4589b1b12fd3a2f3d8d6">proxygen::http2::PriorityUpdate::streamDependency</a></div><div class="ttdeci">HTTPCodec::StreamID streamDependency</div><div class="ttdef"><b>Definition:</b> <a href="HTTP2Framer_8h_source.html#l00086">HTTP2Framer.h:86</a></div></div>
<div class="ttc" id="classproxygen_1_1StateMachine_html_a0bfb6bcff35dc2400f7bdb48b5fe7c61"><div class="ttname"><a href="classproxygen_1_1StateMachine.html#a0bfb6bcff35dc2400f7bdb48b5fe7c61">proxygen::StateMachine::transit</a></div><div class="ttdeci">static bool transit(State &amp;state, Event event)</div><div class="ttdef"><b>Definition:</b> <a href="StateMachine_8h_source.html#l00027">StateMachine.h:27</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1Chunk_html_af044d194d523fbce539790e034449240"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1Chunk.html#af044d194d523fbce539790e034449240">proxygen::HTTPTransaction::Chunk::headerSent</a></div><div class="ttdeci">bool headerSent</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01394">HTTPTransaction.h:1394</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a851f8e0daa480bb26f6c3847a1c6f7ec"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a851f8e0daa480bb26f6c3847a1c6f7ec">proxygen::HTTPTransaction::updateTransactionBytesSent</a></div><div class="ttdeci">void updateTransactionBytesSent(uint64_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01541">HTTPTransaction.cpp:1541</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a5212cf36467144b09c987cce90c64a8d"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a5212cf36467144b09c987cce90c64a8d">proxygen::HTTPTransaction::getRecvToAck</a></div><div class="ttdeci">int32_t getRecvToAck() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01360">HTTPTransaction.cpp:1360</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a6ad638cc955677912c4c10d8b6ddf8ff"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a6ad638cc955677912c4c10d8b6ddf8ff">proxygen::HTTPTransaction::setEgressRateLimit</a></div><div class="ttdeci">void setEgressRateLimit(uint64_t bitsPerSecond)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01181">HTTPTransaction.cpp:1181</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a9ac88e461ed34742fde46678d52392fc"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a9ac88e461ed34742fde46678d52392fc">proxygen::HTTPTransaction::Transport::notifyEgressBodyBuffered</a></div><div class="ttdeci">virtual void notifyEgressBodyBuffered(int64_t bytes) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a86b018f195a82e4838b615839336f4d9"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a86b018f195a82e4838b615839336f4d9">proxygen::HTTPTransaction::rateLimitCallback_</a></div><div class="ttdeci">RateLimitCallback rateLimitCallback_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01342">HTTPTransaction.h:1342</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTP2PriorityQueueBase_html_ab9fda9e325d10dd40994ee45b49c0324"><div class="ttname"><a href="classproxygen_1_1HTTP2PriorityQueueBase.html#ab9fda9e325d10dd40994ee45b49c0324">proxygen::HTTP2PriorityQueueBase::removeTransaction</a></div><div class="ttdeci">virtual void removeTransaction(Handle handle)=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aca321e4ac903ca24e3307ea3d7085546"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aca321e4ac903ca24e3307ea3d7085546">proxygen::HTTPTransaction::updateAndSendPriority</a></div><div class="ttdeci">void updateAndSendPriority(int8_t newPriority)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01370">HTTPTransaction.cpp:1370</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2b1ed029d994147d82f666d1069b1ee7"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2b1ed029d994147d82f666d1069b1ee7">proxygen::HTTPTransaction::onIngressWindowUpdate</a></div><div class="ttdeci">void onIngressWindowUpdate(uint32_t amount)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00646">HTTPTransaction.cpp:646</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPSessionStats_html_a4c0ac2fb3a6fe829a82ddacce8c39175"><div class="ttname"><a href="classproxygen_1_1HTTPSessionStats.html#a4c0ac2fb3a6fe829a82ddacce8c39175">proxygen::HTTPSessionStats::recordTransactionOpened</a></div><div class="ttdeci">virtual void recordTransactionOpened() noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a12c9413175f9eba01ce7c2f794feda10"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a12c9413175f9eba01ce7c2f794feda10">proxygen::HTTPTransaction::onEgressLastByteAck</a></div><div class="ttdeci">void onEgressLastByteAck(std::chrono::milliseconds latency)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00721">HTTPTransaction.cpp:721</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTP2PriorityQueueBase_html_ab88b943c7dc595b06dd998ac7fe61efe"><div class="ttname"><a href="classproxygen_1_1HTTP2PriorityQueueBase.html#ab88b943c7dc595b06dd998ac7fe61efe">proxygen::HTTP2PriorityQueueBase::addTransaction</a></div><div class="ttdeci">virtual Handle addTransaction(HTTPCodec::StreamID id, http2::PriorityUpdate pri, HTTPTransaction *txn, bool permanent=false, uint64_t *depth=nullptr)=0</div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator_html"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html">proxygen::HTTPTransaction::PrioritySample::WeightedAccumulator</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01399">HTTPTransaction.cpp:1399</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html_a18964033ec0f831ef02f6305d7409e46"><div class="ttname"><a href="classproxygen_1_1HTTPException.html#a18964033ec0f831ef02f6305d7409e46">proxygen::HTTPException::getDirection</a></div><div class="ttdeci">Direction getDirection() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPException_8h_source.html#l00067">HTTPException.h:67</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a4635c6fb2e6d001200f39ea32197af09"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a4635c6fb2e6d001200f39ea32197af09">proxygen::HTTPTransaction::ingressState_</a></div><div class="ttdeci">HTTPTransactionIngressSM::State ingressState_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01365">HTTPTransaction.h:1365</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a398db3f6032d4e026f765fd63bb0ca83"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a398db3f6032d4e026f765fd63bb0ca83">proxygen::HTTPTransaction::onPushedTransaction</a></div><div class="ttdeci">bool onPushedTransaction(HTTPTransaction *txn)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01274">HTTPTransaction.cpp:1274</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a721bf03ec05b893acff23f4ca5c63891"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a721bf03ec05b893acff23f4ca5c63891">proxygen::HTTPTransaction::expectedContentLengthRemaining_</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; expectedContentLengthRemaining_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01463">HTTPTransaction.h:1463</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a065ef913a65a188914c3fc13dfcb70c7"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a065ef913a65a188914c3fc13dfcb70c7">proxygen::HTTPTransaction::isEnqueued</a></div><div class="ttdeci">bool isEnqueued() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01282">HTTPTransaction.h:1282</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ac77a1999dac76e625d1174fcb8479582"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ac77a1999dac76e625d1174fcb8479582">proxygen::HTTPTransaction::prioritySample_</a></div><div class="ttdeci">std::unique_ptr&lt; PrioritySample &gt; prioritySample_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01497">HTTPTransaction.h:1497</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a89082f763904815911bb62430ba5f24a"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a89082f763904815911bb62430ba5f24a">proxygen::HTTPTransaction::isExpectingWindowUpdate</a></div><div class="ttdeci">bool isExpectingWindowUpdate() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00478">HTTPTransaction.cpp:478</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2b28fe4653aa8458c53a442d377681c4"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2b28fe4653aa8458c53a442d377681c4">proxygen::HTTPTransaction::sendWindow_</a></div><div class="ttdeci">Window sendWindow_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01382">HTTPTransaction.h:1382</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a0cd2d19638e42b0a0517ecf5813fff37"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a0cd2d19638e42b0a0517ecf5813fff37">proxygen::HTTPTransaction::updateHandlerPauseState</a></div><div class="ttdeci">void updateHandlerPauseState()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01214">HTTPTransaction.cpp:1214</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_abd6a8877e27da8c50a2023936c051e9a"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#abd6a8877e27da8c50a2023936c051e9a">proxygen::HTTPTransaction::onDelayedDestroy</a></div><div class="ttdeci">void onDelayedDestroy(bool delayed) override</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00112">HTTPTransaction.cpp:112</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a196ee69eed048b43bdc900bb97c080fa"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a196ee69eed048b43bdc900bb97c080fa">proxygen::HTTPTransaction::Transport::sendAbort</a></div><div class="ttdeci">virtual size_t sendAbort(HTTPTransaction *txn, ErrorCode statusCode) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ae249e38c296d2e391156dab66871aee1"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ae249e38c296d2e391156dab66871aee1">proxygen::HTTPTransaction::priority_</a></div><div class="ttdeci">http2::PriorityUpdate priority_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01436">HTTPTransaction.h:1436</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a4c679e83df84756777a28364d5632d42"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a4c679e83df84756777a28364d5632d42">proxygen::HTTPTransaction::stats_</a></div><div class="ttdeci">HTTPSessionStats * stats_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01368">HTTPTransaction.h:1368</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a590f2fa2f962dd1c349bd5362c0bb115"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a590f2fa2f962dd1c349bd5362c0bb115">proxygen::HTTPTransaction::chunkHeaders_</a></div><div class="ttdeci">std::list&lt; Chunk &gt; chunkHeaders_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01396">HTTPTransaction.h:1396</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_afa5079eadcc6a6efa4b9a5d4b744ed0fae8f67cbcf442cae7cbb362ea8227b7ee"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fae8f67cbcf442cae7cbb362ea8227b7ee">proxygen::HTTPEvent::Type::MESSAGE_BEGIN</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_a153d6442538b3a055c38684f6b9affb5"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a153d6442538b3a055c38684f6b9affb5">proxygen::HTTPTransaction::PrioritySample::updateRatio</a></div><div class="ttdeci">void updateRatio(double ratio)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01482">HTTPTransaction.cpp:1482</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aa020c58a0e0c82bc5598b01e369bdeb1"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aa020c58a0e0c82bc5598b01e369bdeb1">proxygen::HTTPTransaction::onEgressBodyLastByte</a></div><div class="ttdeci">void onEgressBodyLastByte()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00707">HTTPTransaction.cpp:707</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_adca2bdfeac863b73cbe4c73b5c7d0344"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#adca2bdfeac863b73cbe4c73b5c7d0344">proxygen::HTTPTransaction::egressState_</a></div><div class="ttdeci">HTTPTransactionEgressSM::State egressState_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01363">HTTPTransaction.h:1363</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_ad3e8c25f82c1ab3d38602ce696fcfe70"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#ad3e8c25f82c1ab3d38602ce696fcfe70">proxygen::HTTPTransaction::Transport::sendEOM</a></div><div class="ttdeci">virtual size_t sendEOM(HTTPTransaction *txn, const HTTPHeaders *trailers) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a45de6bc5ca4b8e50b250fd257013ec89"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a45de6bc5ca4b8e50b250fd257013ec89">proxygen::HTTPTransaction::updateReadTimeout</a></div><div class="ttdeci">void updateReadTimeout()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00487">HTTPTransaction.cpp:487</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html_a8a9f5f138aacf5b6c305ae0fd398a0ff"><div class="ttname"><a href="classproxygen_1_1HTTPException.html#a8a9f5f138aacf5b6c305ae0fd398a0ff">proxygen::HTTPException::getCodecStatusCode</a></div><div class="ttdeci">ErrorCode getCodecStatusCode() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPException_8h_source.html#l00101">HTTPException.h:101</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_aa7b9f0ba2b4f6743a746cb796be14760"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#aa7b9f0ba2b4f6743a746cb796be14760">proxygen::HTTPTransaction::Transport::sendWindowUpdate</a></div><div class="ttdeci">virtual size_t sendWindowUpdate(HTTPTransaction *txn, uint32_t bytes) noexcept=0</div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue_html_a5a6956c3510f046d82492385be234951"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a5a6956c3510f046d82492385be234951">proxygen::HTTPTransaction::PrioritySample::WeightedValue::byTransactionBytesSent_</a></div><div class="ttdeci">WeightedAccumulator byTransactionBytesSent_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01440">HTTPTransaction.cpp:1440</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_af2ddc4b6da235a452d2b9b5809ba28c0"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#af2ddc4b6da235a452d2b9b5809ba28c0">proxygen::HTTPTransaction::deferredIngress_</a></div><div class="ttdeci">std::unique_ptr&lt; std::queue&lt; HTTPEvent &gt; &gt; deferredIngress_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01348">HTTPTransaction.h:1348</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ad1df333c0d5f703c6f0722fdbe099cf9"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ad1df333c0d5f703c6f0722fdbe099cf9">proxygen::HTTPTransaction::exTransactions_</a></div><div class="ttdeci">std::set&lt; HTTPCodec::StreamID &gt; exTransactions_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01431">HTTPTransaction.h:1431</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html_a63d32340ce3200c654122f8e40d27954aedb8d33af4486e6873c54224f6cc10ef"><div class="ttname"><a href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954aedb8d33af4486e6873c54224f6cc10ef">proxygen::HTTPException::Direction::INGRESS</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_a5a62aa5917ef2fa4838e05f3e1f191c7"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a5a62aa5917ef2fa4838e05f3e1f191c7">proxygen::HTTPTransaction::PrioritySample::ratio_</a></div><div class="ttdeci">double ratio_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01503">HTTPTransaction.cpp:1503</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_ab1907c602f4948511e3c2f4268446364"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#ab1907c602f4948511e3c2f4268446364">proxygen::HTTPTransaction::Transport::describe</a></div><div class="ttdeci">virtual void describe(std::ostream &amp;) const =0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a854efe446d5edff65c09243eed1bfbb5"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a854efe446d5edff65c09243eed1bfbb5">proxygen::HTTPTransaction::Transport::pauseIngress</a></div><div class="ttdeci">virtual void pauseIngress(HTTPTransaction *txn) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPCodec_html_ad3f2df6e146618da881c36c5bd68c7e3"><div class="ttname"><a href="classproxygen_1_1HTTPCodec.html#ad3f2df6e146618da881c36c5bd68c7e3">proxygen::HTTPCodec::mapPriorityToDependency</a></div><div class="ttdeci">virtual StreamID mapPriorityToDependency(uint8_t) const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPCodec_8h_source.html#l00706">HTTPCodec.h:706</a></div></div>
<div class="ttc" id="namespaceproxygen_html_ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5"><div class="ttname"><a href="namespaceproxygen.html#ab18179a16a0bebed81cf3f62dff11064abb1ca97ec761fc37101737ba0aa2e7c5">proxygen::ZstdStatusType::ERROR</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aea212f62c9bfdd6facd1667a624abce6"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aea212f62c9bfdd6facd1667a624abce6">proxygen::HTTPTransaction::sendBody</a></div><div class="ttdeci">virtual void sendBody(std::unique_ptr&lt; folly::IOBuf &gt; body)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00781">HTTPTransaction.cpp:781</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ab639699f42d36d0c814e5ca1a8a73194"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ab639699f42d36d0c814e5ca1a8a73194">proxygen::HTTPTransaction::getHandler</a></div><div class="ttdeci">const Handler * getHandler() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00484">HTTPTransaction.h:484</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a18c3300cbce5fcdb167dbfb6cc073e65"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a18c3300cbce5fcdb167dbfb6cc073e65">proxygen::HTTPTransaction::sendHeaders</a></div><div class="ttdeci">virtual void sendHeaders(const HTTPMessage &amp;headers)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00777">HTTPTransaction.cpp:777</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a81b96f75e461f7e176e3178040486b56"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a81b96f75e461f7e176e3178040486b56">proxygen::HTTPTransaction::Transport::notifyIngressBodyProcessed</a></div><div class="ttdeci">virtual void notifyIngressBodyProcessed(uint32_t bytes) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a4913894bc6b9ffd5a1fc61fd0913e94e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a4913894bc6b9ffd5a1fc61fd0913e94e">proxygen::HTTPTransaction::timer_</a></div><div class="ttdeci">folly::HHWheelTimer * timer_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01495">HTTPTransaction.h:1495</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ac15f2ce834f719ef4e9350edb51d688d"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ac15f2ce834f719ef4e9350edb51d688d">proxygen::HTTPTransaction::expectedResponseLength_</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; expectedResponseLength_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01464">HTTPTransaction.h:1464</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_afa5079eadcc6a6efa4b9a5d4b744ed0fa7c176223c0dc5d3e1e28b29b6a3d7221"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa7c176223c0dc5d3e1e28b29b6a3d7221">proxygen::HTTPEvent::Type::CHUNK_HEADER</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a2a1e6d98064defaccbc8398b81524dd6"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a2a1e6d98064defaccbc8398b81524dd6">proxygen::HTTPTransactionHandler::onExTransaction</a></div><div class="ttdeci">virtual void onExTransaction(HTTPTransaction *) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00247">HTTPTransaction.h:247</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPMessage_html_a2ba4953e1ab061fe5eb68af08e684772"><div class="ttname"><a href="classproxygen_1_1HTTPMessage.html#a2ba4953e1ab061fe5eb68af08e684772">proxygen::HTTPMessage::getHeaders</a></div><div class="ttdeci">HTTPHeaders &amp; getHeaders()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPMessage_8h_source.html#l00273">HTTPMessage.h:273</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a08ccd95211616539ef13b9950f719161"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a08ccd95211616539ef13b9950f719161">proxygen::HTTPTransaction::updateRelativeWeight</a></div><div class="ttdeci">void updateRelativeWeight(double ratio)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01521">HTTPTransaction.cpp:1521</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a122fcfcde3d41c6041829940bad47f08"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a122fcfcde3d41c6041829940bad47f08">proxygen::HTTPTransaction::describe</a></div><div class="ttdeci">void describe(std::ostream &amp;os) const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01316">HTTPTransaction.cpp:1316</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a1ab458d6f99eaeefa002e8580ecd0f17"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a1ab458d6f99eaeefa002e8580ecd0f17">proxygen::HTTPTransaction::~HTTPTransaction</a></div><div class="ttdeci">~HTTPTransaction() override</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00132">HTTPTransaction.cpp:132</a></div></div>
<div class="ttc" id="namespaceproxygen_html_ac167448283d2eb2403c01822410d956dac8d82d9d46b9904442f90190d8aeb099"><div class="ttname"><a href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956dac8d82d9d46b9904442f90190d8aeb099">proxygen::kErrorTimeout</a></div><div class="ttdef"><b>Definition:</b> <a href="ProxygenErrorEnum_8h_source.html#l00076">ProxygenErrorEnum.h:76</a></div></div>
<div class="ttc" id="classproxygen_1_1StateMachine_html_a35c97a192fb193482e41b6dc2fde9ab1"><div class="ttname"><a href="classproxygen_1_1StateMachine.html#a35c97a192fb193482e41b6dc2fde9ab1">proxygen::StateMachine::Event</a></div><div class="ttdeci">typename T::Event Event</div><div class="ttdef"><b>Definition:</b> <a href="StateMachine_8h_source.html#l00021">StateMachine.h:21</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a70de40060357331a03b389ddfa3256e7"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a70de40060357331a03b389ddfa3256e7">proxygen::HTTPTransaction::pauseIngress</a></div><div class="ttdeci">virtual void pauseIngress()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01081">HTTPTransaction.cpp:1081</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPHeaders_html_aa14bc0e99fc0ebe98fb95b7cff1bb598"><div class="ttname"><a href="classproxygen_1_1HTTPHeaders.html#aa14bc0e99fc0ebe98fb95b7cff1bb598">proxygen::HTTPHeaders::getSingleOrEmpty</a></div><div class="ttdeci">const std::string &amp; getSingleOrEmpty(const T &amp;nameOrCode) const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPHeaders_8h_source.html#l00434">HTTPHeaders.h:434</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage_html_a40f9381650b7e11492e2b7a77df28dde"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage.html#a40f9381650b7e11492e2b7a77df28dde">proxygen::HTTPTransaction::PrioritySampleSummary::WeightedAverage::bySessionBytes_</a></div><div class="ttdeci">double bySessionBytes_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01208">HTTPTransaction.h:1208</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a3d6f6c837ecc1ee254de4e790826ae9b"><div class="ttname"><a href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9b">proxygen::ErrorCode</a></div><div class="ttdeci">ErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="ErrorCode_8h_source.html#l00026">ErrorCode.h:26</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage_html"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage.html">proxygen::HTTPTransaction::PrioritySampleSummary::WeightedAverage</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01206">HTTPTransaction.h:1206</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a14ceaad7dd23c1c0444a1eebc5b6cbdf"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a14ceaad7dd23c1c0444a1eebc5b6cbdf">proxygen::HTTPTransaction::queueHandle_</a></div><div class="ttdeci">HTTP2PriorityQueueBase::Handle queueHandle_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01406">HTTPTransaction.h:1406</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a47f1ba8719ed82a445997ac88320cb4a"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a47f1ba8719ed82a445997ac88320cb4a">proxygen::HTTPTransaction::ingressPaused_</a></div><div class="ttdeci">bool ingressPaused_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01467">HTTPTransaction.h:1467</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_a61fd3e69cbb521a04618cd8a81cd164b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a61fd3e69cbb521a04618cd8a81cd164b">proxygen::HTTPTransaction::PrioritySample::isTransactionBytesScheduled</a></div><div class="ttdeci">bool isTransactionBytesScheduled() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01486">HTTPTransaction.cpp:1486</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a69018258957a810d1753820660d91245"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a69018258957a810d1753820660d91245">proxygen::HTTPTransaction::refreshTimeout</a></div><div class="ttdeci">void refreshTimeout()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01100">HTTPTransaction.h:1100</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_a8d6e9e290af4701d41f367532c21463e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a8d6e9e290af4701d41f367532c21463e">proxygen::HTTPTransaction::PrioritySample::updateContentionsCount</a></div><div class="ttdeci">void updateContentionsCount(uint64_t contentions, uint64_t depth)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01449">HTTPTransaction.cpp:1449</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a00b4cbb0c54e966bfd87e0e7cb1cb33d"><div class="ttname"><a href="namespaceproxygen.html#a00b4cbb0c54e966bfd87e0e7cb1cb33d">proxygen::TransportDirection</a></div><div class="ttdeci">TransportDirection</div><div class="ttdef"><b>Definition:</b> <a href="TransportDirection_8h_source.html#l00017">TransportDirection.h:17</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_afa5079eadcc6a6efa4b9a5d4b744ed0fa1f8ec8636df593e722e9631642eabc74"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa1f8ec8636df593e722e9631642eabc74">proxygen::HTTPEvent::Type::TRAILERS_COMPLETE</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ac1aeab9bd4392274da1b4273ada925ee"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ac1aeab9bd4392274da1b4273ada925ee">proxygen::HTTPTransaction::extraResponseExpected</a></div><div class="ttdeci">virtual bool extraResponseExpected() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00554">HTTPTransaction.h:554</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_abb5b09692ca0e43373b82c0160b05939"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#abb5b09692ca0e43373b82c0160b05939">proxygen::HTTPTransaction::getControlStream</a></div><div class="ttdeci">folly::Optional&lt; HTTPCodec::StreamID &gt; getControlStream() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01056">HTTPTransaction.h:1056</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_af21bcdf1b2e19d5817252a8af9bcc1d6"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#af21bcdf1b2e19d5817252a8af9bcc1d6">proxygen::HTTPTransaction::Transport::sendChunkHeader</a></div><div class="ttdeci">virtual size_t sendChunkHeader(HTTPTransaction *txn, size_t length) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPMessage_html_aca0cf87662b02d51fc9c3588ab93069e"><div class="ttname"><a href="classproxygen_1_1HTTPMessage.html#aca0cf87662b02d51fc9c3588ab93069e">proxygen::HTTPMessage::isResponse</a></div><div class="ttdeci">bool isResponse() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPMessage_8h_source.html#l00675">HTTPMessage.h:675</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a78ceee96254598ebfe317f9adcc170d2"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a78ceee96254598ebfe317f9adcc170d2">proxygen::HTTPTransaction::markEgressComplete</a></div><div class="ttdeci">void markEgressComplete()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00502">HTTPTransaction.cpp:502</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a890d9807de58a1bd4e8ccdf498854456"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a890d9807de58a1bd4e8ccdf498854456">proxygen::HTTPTransaction::transportCallback_</a></div><div class="ttdeci">TransportCallback * transportCallback_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01384">HTTPTransaction.h:1384</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_a464cd5c01e33a077256f95de31463c26"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#a464cd5c01e33a077256f95de31463c26">proxygen::HTTPTransactionTransportCallback::firstByteFlushed</a></div><div class="ttdeci">virtual void firstByteFlushed() noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a4fc154af488feb7538d9dc9413db8df7"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a4fc154af488feb7538d9dc9413db8df7">proxygen::HTTPTransaction::inResume_</a></div><div class="ttdeci">bool inResume_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01477">HTTPTransaction.h:1477</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a6a1acbd434b94259956a083014a485e6"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a6a1acbd434b94259956a083014a485e6">proxygen::HTTPTransaction::headRequest_</a></div><div class="ttdeci">bool headRequest_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01481">HTTPTransaction.h:1481</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a1529214f357bb99fe87653378864f2ee"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a1529214f357bb99fe87653378864f2ee">proxygen::HTTPTransaction::pushedTransactions_</a></div><div class="ttdeci">std::set&lt; HTTPCodec::StreamID &gt; pushedTransactions_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01426">HTTPTransaction.h:1426</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ac09085e8037607eb496c8f4899f6ab16"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ac09085e8037607eb496c8f4899f6ab16">proxygen::HTTPTransaction::tableInfo_</a></div><div class="ttdeci">CompressionInfo tableInfo_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01370">HTTPTransaction.h:1370</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a3d6f6c837ecc1ee254de4e790826ae9ba2027c027133e22c8929e2874dc44dd36"><div class="ttname"><a href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba2027c027133e22c8929e2874dc44dd36">proxygen::ErrorCode::CANCEL</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a3d6f6c837ecc1ee254de4e790826ae9bae8c0c70879b5895c615677261d64a1ee"><div class="ttname"><a href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9bae8c0c70879b5895c615677261d64a1ee">proxygen::ErrorCode::INTERNAL_ERROR</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2a0b9456073184f5b19efccaf5b08c13"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2a0b9456073184f5b19efccaf5b08c13">proxygen::HTTPTransaction::sendHeadersWithEOM</a></div><div class="ttdeci">virtual void sendHeadersWithEOM(const HTTPMessage &amp;headers)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00773">HTTPTransaction.cpp:773</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a5e431cbb4c065285c5ad65acaceb0b22"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a5e431cbb4c065285c5ad65acaceb0b22">proxygen::HTTPTransactionHandler::onHeadersComplete</a></div><div class="ttdeci">virtual void onHeadersComplete(std::unique_ptr&lt; HTTPMessage &gt; msg) noexcept=0</div></div>
<div class="ttc" id="namespaceproxygen_html_a3d6f6c837ecc1ee254de4e790826ae9ba795fcd4a9695a63ff230ad23d4122917"><div class="ttname"><a href="namespaceproxygen.html#a3d6f6c837ecc1ee254de4e790826ae9ba795fcd4a9695a63ff230ad23d4122917">proxygen::ErrorCode::STREAM_CLOSED</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_aaf57400170e2afde845b45288c4f5609"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#aaf57400170e2afde845b45288c4f5609">proxygen::HTTPTransaction::Transport::sendPriority</a></div><div class="ttdeci">virtual size_t sendPriority(HTTPTransaction *txn, const http2::PriorityUpdate &amp;pri) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a0c3f6ac1245cf283d586e216740e5b7d"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a0c3f6ac1245cf283d586e216740e5b7d">proxygen::HTTPTransaction::Transport::sendBody</a></div><div class="ttdeci">virtual size_t sendBody(HTTPTransaction *txn, std::unique_ptr&lt; folly::IOBuf &gt;, bool eom, bool trackLastByteFlushed) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_afdc4d4dec715841ba0c5bb5e58b1d53c"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#afdc4d4dec715841ba0c5bb5e58b1d53c">proxygen::HTTPTransactionHandler::onEOM</a></div><div class="ttdeci">virtual void onEOM() noexcept=0</div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator_html_a7b14a6af99901e883402a0a2c9b1b6b2"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedAccumulator.html#a7b14a6af99901e883402a0a2c9b1b6b2">proxygen::HTTPTransaction::PrioritySample::WeightedAccumulator::getWeightedAverage</a></div><div class="ttdeci">double getWeightedAverage() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01413">HTTPTransaction.cpp:1413</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a50bc3bec88048692b95b2932eb7bbb19"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a50bc3bec88048692b95b2932eb7bbb19">proxygen::HTTPTransaction::HTTPTransaction</a></div><div class="ttdeci">HTTPTransaction(TransportDirection direction, HTTPCodec::StreamID id, uint32_t seqNo, Transport &amp;transport, HTTP2PriorityQueueBase &amp;egressQueue, folly::HHWheelTimer *timer=nullptr, const folly::Optional&lt; std::chrono::milliseconds &gt; &amp;defaultTimeout=folly::Optional&lt; std::chrono::milliseconds &gt;(), HTTPSessionStats *stats=nullptr, bool useFlowControl=false, uint32_t receiveInitialWindowSize=0, uint32_t sendInitialWindowSize=0, http2::PriorityUpdate=http2::DefaultPriority, folly::Optional&lt; HTTPCodec::StreamID &gt; assocStreamId=HTTPCodec::NoStream, folly::Optional&lt; HTTPCodec::ExAttributes &gt; exAttributes=HTTPCodec::NoExAttributes)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00031">HTTPTransaction.cpp:31</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue_html_aec10c3b3bd2dbaf063a3e056c112806f"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#aec10c3b3bd2dbaf063a3e056c112806f">proxygen::HTTPTransaction::PrioritySample::WeightedValue::accumulateBySessionBytes</a></div><div class="ttdeci">void accumulateBySessionBytes(uint64_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01428">HTTPTransaction.cpp:1428</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue_html_a7b20abfa558fa297e83d11f6ad62dd17"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a7b20abfa558fa297e83d11f6ad62dd17">proxygen::HTTPTransaction::PrioritySample::WeightedValue::bySessionBytesScheduled_</a></div><div class="ttdeci">WeightedAccumulator bySessionBytesScheduled_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01441">HTTPTransaction.cpp:1441</a></div></div>
<div class="ttc" id="classproxygen_1_1Window_html_a5e0843cdb55c9c3ffd1cfe3e2e1f25f2"><div class="ttname"><a href="classproxygen_1_1Window.html#a5e0843cdb55c9c3ffd1cfe3e2e1f25f2">proxygen::Window::setCapacity</a></div><div class="ttdeci">bool setCapacity(uint32_t capacity)</div><div class="ttdef"><b>Definition:</b> <a href="Window_8cpp_source.html#l00084">Window.cpp:84</a></div></div>
<div class="ttc" id="HTTPSessionStats_8h_html"><div class="ttname"><a href="HTTPSessionStats_8h.html">HTTPSessionStats.h</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_add2ec8e1f7d0b23b829d47eccbdc1c2b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#add2ec8e1f7d0b23b829d47eccbdc1c2b">proxygen::HTTPTransaction::currentDepth_</a></div><div class="ttdeci">uint64_t currentDepth_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01450">HTTPTransaction.h:1450</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2c3c9818119e8f7db0223f40491f5bca"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2c3c9818119e8f7db0223f40491f5bca">proxygen::HTTPTransaction::setPrioritySampled</a></div><div class="ttdeci">void setPrioritySampled(bool sampled)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01507">HTTPTransaction.cpp:1507</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a6102abd70fb8d9e25302e73cdd0ab73e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a6102abd70fb8d9e25302e73cdd0ab73e">proxygen::HTTPTransaction::onEgressTrackedByte</a></div><div class="ttdeci">void onEgressTrackedByte()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00714">HTTPTransaction.cpp:714</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a924c9548b4cd45d9960e9907a5054c71"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a924c9548b4cd45d9960e9907a5054c71">proxygen::HTTPTransaction::cumulativeRatio_</a></div><div class="ttdeci">double cumulativeRatio_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01451">HTTPTransaction.h:1451</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a9aa4ccd2421c67151b8bbf151e21f320"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a9aa4ccd2421c67151b8bbf151e21f320">proxygen::HTTPTransaction::pauseEgress</a></div><div class="ttdeci">void pauseEgress()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01159">HTTPTransaction.cpp:1159</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a3593cac85cdc7aa01309b908a4103dd6"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a3593cac85cdc7aa01309b908a4103dd6">proxygen::HTTPTransaction::enableLastByteFlushedTracking_</a></div><div class="ttdeci">bool enableLastByteFlushedTracking_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01482">HTTPTransaction.h:1482</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a259ca72274b3d7924710c282eeef5823"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a259ca72274b3d7924710c282eeef5823">proxygen::HTTPTransaction::onIngressUpgrade</a></div><div class="ttdeci">void onIngressUpgrade(UpgradeProtocol protocol)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00388">HTTPTransaction.cpp:388</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_a8c465da22a769b3cae95ce03e71f7456"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#a8c465da22a769b3cae95ce03e71f7456">proxygen::HTTPTransactionTransportCallback::headerBytesGenerated</a></div><div class="ttdeci">virtual void headerBytesGenerated(HTTPHeaderSize &amp;size) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2e8861dbc6a86b7cb4b569737c2768cf"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2e8861dbc6a86b7cb4b569737c2768cf">proxygen::HTTPTransaction::onIngressSetSendWindow</a></div><div class="ttdeci">void onIngressSetSendWindow(uint32_t newWindowSize)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00664">HTTPTransaction.cpp:664</a></div></div>
<div class="ttc" id="namespaceproxygen_html_a09b325f9c0aa18197dfeebb7f0533a49"><div class="ttname"><a href="namespaceproxygen.html#a09b325f9c0aa18197dfeebb7f0533a49">proxygen::getCurrentTime</a></div><div class="ttdeci">std::chrono::time_point&lt; ClockType &gt; getCurrentTime()</div><div class="ttdef"><b>Definition:</b> <a href="Time_8h_source.html#l00041">Time.h:41</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_html_a861167815a7cdbba5d0d65cd6f6b9b74"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html#a861167815a7cdbba5d0d65cd6f6b9b74">proxygen::HTTPTransaction::PrioritySampleSummary::expected_weight_</a></div><div class="ttdeci">double expected_weight_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01212">HTTPTransaction.h:1212</a></div></div>
<div class="ttc" id="namespaceproxygen_html"><div class="ttname"><a href="namespaceproxygen.html">proxygen</a></div><div class="ttdef"><b>Definition:</b> <a href="ExMessageHandler_8h_source.html#l00014">ExMessageHandler.h:14</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1PrioritySample_html_a9ad40a5c63a9c67ebfafcc9a3b44fdf3"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1PrioritySample.html#a9ad40a5c63a9c67ebfafcc9a3b44fdf3">proxygen::HTTPTransaction::PrioritySample::expected_weight_</a></div><div class="ttdeci">WeightedAccumulator expected_weight_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01501">HTTPTransaction.cpp:1501</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a1f981615d0d6d8cd56c3fc1a01d44a29"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a1f981615d0d6d8cd56c3fc1a01d44a29">proxygen::HTTPTransaction::firstHeaderByteSent_</a></div><div class="ttdeci">bool firstHeaderByteSent_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01476">HTTPTransaction.h:1476</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_afe7278404a7436993d005c0ce752931b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#afe7278404a7436993d005c0ce752931b">proxygen::HTTPTransaction::maybeDelayForRateLimit</a></div><div class="ttdeci">bool maybeDelayForRateLimit()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00897">HTTPTransaction.cpp:897</a></div></div>
<div class="ttc" id="namespaceproxygen_html_ac167448283d2eb2403c01822410d956da6e26e85744e3af152c1be71750ec85b0"><div class="ttname"><a href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da6e26e85744e3af152c1be71750ec85b0">proxygen::kErrorStreamAbort</a></div><div class="ttdef"><b>Definition:</b> <a href="ProxygenErrorEnum_8h_source.html#l00076">ProxygenErrorEnum.h:76</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a709cc77ae05afb548fb2f2a2850f9642"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a709cc77ae05afb548fb2f2a2850f9642">proxygen::HTTPTransaction::deferredEgressBody_</a></div><div class="ttdeci">folly::IOBufQueue deferredEgressBody_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01356">HTTPTransaction.h:1356</a></div></div>
<div class="ttc" id="structproxygen_1_1CompressionInfo_html_a680906edd9c2081d55c6df98db652dbb"><div class="ttname"><a href="structproxygen_1_1CompressionInfo.html#a680906edd9c2081d55c6df98db652dbb">proxygen::CompressionInfo::ingressHeadersStored_</a></div><div class="ttdeci">uint32_t ingressHeadersStored_</div><div class="ttdef"><b>Definition:</b> <a href="CompressionInfo_8h_source.html#l00028">CompressionInfo.h:28</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionHandler_html_a219de67110f915deda30d18327f26393"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionHandler.html#a219de67110f915deda30d18327f26393">proxygen::HTTPTransactionHandler::onTrailers</a></div><div class="ttdeci">virtual void onTrailers(std::unique_ptr&lt; HTTPHeaders &gt; trailers) noexcept=0</div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage_html_afe6b9ab950c9bb1a1caded5317e3815a"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_1_1WeightedAverage.html#afe6b9ab950c9bb1a1caded5317e3815a">proxygen::HTTPTransaction::PrioritySampleSummary::WeightedAverage::byTransactionBytes_</a></div><div class="ttdeci">double byTransactionBytes_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01207">HTTPTransaction.h:1207</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPCodec_html_addee32fd97cd4864b2a4b2f8a99c11c1"><div class="ttname"><a href="classproxygen_1_1HTTPCodec.html#addee32fd97cd4864b2a4b2f8a99c11c1">proxygen::HTTPCodec::StreamID</a></div><div class="ttdeci">uint64_t StreamID</div><div class="ttdef"><b>Definition:</b> <a href="HTTPCodec_8h_source.html#l00049">HTTPCodec.h:49</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ac49a1ef5d00655ff061197d8c741b74c"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ac49a1ef5d00655ff061197d8c741b74c">proxygen::HTTPTransaction::actualResponseLength_</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; actualResponseLength_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01465">HTTPTransaction.h:1465</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a50773010568880d549b9de1cc710f51c"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a50773010568880d549b9de1cc710f51c">proxygen::HTTPTransaction::Transport::getCodec</a></div><div class="ttdeci">virtual const HTTPCodec &amp; getCodec() const noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ad54b8093a5fc5524ff4edac194455300"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ad54b8093a5fc5524ff4edac194455300">proxygen::HTTPTransaction::handlerEgressPaused_</a></div><div class="ttdeci">bool handlerEgressPaused_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01470">HTTPTransaction.h:1470</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a81313661e5baf7b3ccacb41a9275eafb"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a81313661e5baf7b3ccacb41a9275eafb">proxygen::HTTPTransaction::processIngressUpgrade</a></div><div class="ttdeci">void processIngressUpgrade(UpgradeProtocol protocol)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00403">HTTPTransaction.cpp:403</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a0e0d2e99d0604ab973cd67a374184b0e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a0e0d2e99d0604ab973cd67a374184b0e">proxygen::HTTPTransaction::processIngressBody</a></div><div class="ttdeci">void processIngressBody(std::unique_ptr&lt; folly::IOBuf &gt; chain, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00279">HTTPTransaction.cpp:279</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPMessage_html"><div class="ttname"><a href="classproxygen_1_1HTTPMessage.html">proxygen::HTTPMessage</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPMessage_8h_source.html#l00039">HTTPMessage.h:39</a></div></div>
<div class="ttc" id="namespaceproxygen_html_ac167448283d2eb2403c01822410d956da60f7c9e48bcca567facd26654ed3b4d8"><div class="ttname"><a href="namespaceproxygen.html#ac167448283d2eb2403c01822410d956da60f7c9e48bcca567facd26654ed3b4d8">proxygen::kErrorEOF</a></div><div class="ttdef"><b>Definition:</b> <a href="ProxygenErrorEnum_8h_source.html#l00076">ProxygenErrorEnum.h:76</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPMessage_html_ac77cbdbc9a043493083ef046870d04c6"><div class="ttname"><a href="classproxygen_1_1HTTPMessage.html#ac77cbdbc9a043493083ef046870d04c6">proxygen::HTTPMessage::isRequest</a></div><div class="ttdeci">bool isRequest() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPMessage_8h_source.html#l00668">HTTPMessage.h:668</a></div></div>
<div class="ttc" id="classproxygen_1_1Window_html_ae0cfefc1b0658621476f39cba28d9505"><div class="ttname"><a href="classproxygen_1_1Window.html#ae0cfefc1b0658621476f39cba28d9505">proxygen::Window::free</a></div><div class="ttdeci">bool free(uint32_t amount)</div><div class="ttdef"><b>Definition:</b> <a href="Window_8cpp_source.html#l00063">Window.cpp:63</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a657744e4ff7fb16bd16bee71cde33faf"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a657744e4ff7fb16bd16bee71cde33faf">proxygen::HTTPTransaction::transactionTimeout_</a></div><div class="ttdeci">folly::Optional&lt; std::chrono::milliseconds &gt; transactionTimeout_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01493">HTTPTransaction.h:1493</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aeb5dc56d3bc03e0dd0b4c41d5996fd53"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aeb5dc56d3bc03e0dd0b4c41d5996fd53">proxygen::HTTPTransaction::useFlowControl_</a></div><div class="ttdeci">bool useFlowControl_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01472">HTTPTransaction.h:1472</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a101815c9d188a04309b686780da3f42d"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a101815c9d188a04309b686780da3f42d">proxygen::HTTPTransaction::egressCalls_</a></div><div class="ttdeci">uint64_t egressCalls_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01452">HTTPTransaction.h:1452</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPMessage_html_ab5c428825d6d2c1d3edb7babd36f5064"><div class="ttname"><a href="classproxygen_1_1HTTPMessage.html#ab5c428825d6d2c1d3edb7babd36f5064">proxygen::HTTPMessage::getMethod</a></div><div class="ttdeci">folly::Optional&lt; HTTPMethod &gt; getMethod() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPMessage_8cpp_source.html#l00235">HTTPMessage.cpp:235</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1Chunk_html_abdf4b50799a3323b6bb5417eb4f010cf"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1Chunk.html#abdf4b50799a3323b6bb5417eb4f010cf">proxygen::HTTPTransaction::Chunk::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01393">HTTPTransaction.h:1393</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_af7143d9168c4daf4b9d973b5091af64b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#af7143d9168c4daf4b9d973b5091af64b">proxygen::HTTPTransaction::isRemoteInitiated</a></div><div class="ttdeci">bool isRemoteInitiated() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00760">HTTPTransaction.h:760</a></div></div>
<div class="ttc" id="HTTPHeaderSize_8h_html"><div class="ttname"><a href="HTTPHeaderSize_8h.html">HTTPHeaderSize.h</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a22ec9e51f55497dc4dca424a463b4a54"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a22ec9e51f55497dc4dca424a463b4a54">proxygen::HTTPTransaction::markIngressComplete</a></div><div class="ttdeci">void markIngressComplete()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00495">HTTPTransaction.cpp:495</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPMessage_html_a3533208cb9121a0fc9464ce3f9a9886d"><div class="ttname"><a href="classproxygen_1_1HTTPMessage.html#a3533208cb9121a0fc9464ce3f9a9886d">proxygen::HTTPMessage::normalizePriority</a></div><div class="ttdeci">static uint8_t normalizePriority(int8_t pri)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPMessage_8h_source.html#l00583">HTTPMessage.h:583</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a69a9be095ff88eb4c1385933a1483517"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a69a9be095ff88eb4c1385933a1483517">proxygen::HTTPTransaction::getID</a></div><div class="ttdeci">HTTPCodec::StreamID getID() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00469">HTTPTransaction.h:469</a></div></div>
<div class="ttc" id="structproxygen_1_1CompressionInfo_html_afca67204c598e7b76e4c889a2fc7cd97"><div class="ttname"><a href="structproxygen_1_1CompressionInfo.html#afca67204c598e7b76e4c889a2fc7cd97">proxygen::CompressionInfo::ingressBytesStored_</a></div><div class="ttdeci">uint32_t ingressBytesStored_</div><div class="ttdef"><b>Definition:</b> <a href="CompressionInfo_8h_source.html#l00027">CompressionInfo.h:27</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a9a303a52efdc3a44b3624a4d598d2f4b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a9a303a52efdc3a44b3624a4d598d2f4b">proxygen::HTTPTransaction::egressPaused_</a></div><div class="ttdeci">bool egressPaused_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01468">HTTPTransaction.h:1468</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary_html"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySampleSummary.html">proxygen::HTTPTransaction::PrioritySampleSummary</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01205">HTTPTransaction.h:1205</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a83b433ee00e2d1ab6a28417dd487345a"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a83b433ee00e2d1ab6a28417dd487345a">proxygen::HTTPTransaction::onEgressHeaderFirstByte</a></div><div class="ttdeci">void onEgressHeaderFirstByte()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00693">HTTPTransaction.cpp:693</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a4e30ff9c01ee4576834fa7831ea3f42c"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a4e30ff9c01ee4576834fa7831ea3f42c">proxygen::HTTPTransaction::dequeue</a></div><div class="ttdeci">void dequeue()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01284">HTTPTransaction.h:1284</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_af27fcc98b59eb4eb42e634130ecb99ae"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#af27fcc98b59eb4eb42e634130ecb99ae">proxygen::HTTPTransaction::onPriorityUpdate</a></div><div class="ttdeci">void onPriorityUpdate(const http2::PriorityUpdate &amp;priority)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01385">HTTPTransaction.cpp:1385</a></div></div>
<div class="ttc" id="structproxygen_1_1CompressionInfo_html_ab78106ba4defb0d422206c5430a8b7e6"><div class="ttname"><a href="structproxygen_1_1CompressionInfo.html#ab78106ba4defb0d422206c5430a8b7e6">proxygen::CompressionInfo::egressBytesStored_</a></div><div class="ttdeci">uint32_t egressBytesStored_</div><div class="ttdef"><b>Definition:</b> <a href="CompressionInfo_8h_source.html#l00022">CompressionInfo.h:22</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a0a599cbbd76e87f15244e4e90de9970f"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a0a599cbbd76e87f15244e4e90de9970f">proxygen::HTTPTransaction::insertDepth_</a></div><div class="ttdeci">uint64_t insertDepth_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01449">HTTPTransaction.h:1449</a></div></div>
<div class="ttc" id="RFC2616_8h_html"><div class="ttname"><a href="RFC2616_8h.html">RFC2616.h</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html_a6f89b92fa724cb3a2591ab01332c18b8"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html#a6f89b92fa724cb3a2591ab01332c18b8">proxygen::HTTPTransaction::Transport::notifyPendingEgress</a></div><div class="ttdeci">virtual void notifyPendingEgress() noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a5a70b3675a5cfdd66137a4243a2c585e"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a5a70b3675a5cfdd66137a4243a2c585e">proxygen::HTTPTransaction::onIngressTimeout</a></div><div class="ttdeci">void onIngressTimeout()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00621">HTTPTransaction.cpp:621</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a73b830ff371293adf976d7b76a7a49bd"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a73b830ff371293adf976d7b76a7a49bd">proxygen::HTTPTransaction::aborted_</a></div><div class="ttdeci">bool aborted_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01473">HTTPTransaction.h:1473</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPEvent_html_afa5079eadcc6a6efa4b9a5d4b744ed0fa7f10b7b76869bf2e029b6ce4632e1323"><div class="ttname"><a href="classproxygen_1_1HTTPEvent.html#afa5079eadcc6a6efa4b9a5d4b744ed0fa7f10b7b76869bf2e029b6ce4632e1323">proxygen::HTTPEvent::Type::UPGRADE</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a3bf5690949bf654120ea1302f01e1d43"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a3bf5690949bf654120ea1302f01e1d43">proxygen::HTTPTransaction::updateContentionsCount</a></div><div class="ttdeci">void updateContentionsCount(uint64_t contentions)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01515">HTTPTransaction.cpp:1515</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aff9120dd43c685875a27e92719a40d05"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aff9120dd43c685875a27e92719a40d05">proxygen::HTTPTransaction::egressQueue_</a></div><div class="ttdeci">HTTP2PriorityQueueBase &amp; egressQueue_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01401">HTTPTransaction.h:1401</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a2bd620e0eb5287c2b63a1a228d7c50e0"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a2bd620e0eb5287c2b63a1a228d7c50e0">proxygen::HTTPTransaction::sendHeadersWithOptionalEOM</a></div><div class="ttdeci">virtual void sendHeadersWithOptionalEOM(const HTTPMessage &amp;headers, bool eom)</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00728">HTTPTransaction.cpp:728</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTP2PriorityQueueBase_html_a775fcd7d7d4c27b71ca700c4f7ef93ff"><div class="ttname"><a href="classproxygen_1_1HTTP2PriorityQueueBase.html#a775fcd7d7d4c27b71ca700c4f7ef93ff">proxygen::HTTP2PriorityQueueBase::clearPendingEgress</a></div><div class="ttdeci">virtual void clearPendingEgress(Handle h)=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPCodec_html_a8dfbc8c5bee0947e718742e541259be2"><div class="ttname"><a href="classproxygen_1_1HTTPCodec.html#a8dfbc8c5bee0947e718742e541259be2">proxygen::HTTPCodec::supportsParallelRequests</a></div><div class="ttdeci">virtual bool supportsParallelRequests() const =0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_a690ec40de2214b704962e7d4af558239"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#a690ec40de2214b704962e7d4af558239">proxygen::HTTPTransactionTransportCallback::trackedByteFlushed</a></div><div class="ttdeci">virtual void trackedByteFlushed() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00309">HTTPTransaction.h:309</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_a3f99aed58bb09a1b4b6bb803d49d83ae"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#a3f99aed58bb09a1b4b6bb803d49d83ae">proxygen::HTTPTransactionTransportCallback::headerBytesReceived</a></div><div class="ttdeci">virtual void headerBytesReceived(const HTTPHeaderSize &amp;size) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html_a63d32340ce3200c654122f8e40d27954"><div class="ttname"><a href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954">proxygen::HTTPException::Direction</a></div><div class="ttdeci">Direction</div><div class="ttdef"><b>Definition:</b> <a href="HTTPException_8h_source.html#l00036">HTTPException.h:36</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_1_1Transport_html"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction_1_1Transport.html">proxygen::HTTPTransaction::Transport</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00331">HTTPTransaction.h:331</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransactionTransportCallback_html_afc053d6a939eec4c3794c07132f7be82"><div class="ttname"><a href="classproxygen_1_1HTTPTransactionTransportCallback.html#afc053d6a939eec4c3794c07132f7be82">proxygen::HTTPTransactionTransportCallback::bodyBytesGenerated</a></div><div class="ttdeci">virtual void bodyBytesGenerated(size_t nbytes) noexcept=0</div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_ad95519e6472228d359c7fb144889f1ac"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#ad95519e6472228d359c7fb144889f1ac">proxygen::HTTPTransaction::sendEOM</a></div><div class="ttdeci">virtual void sendEOM()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01012">HTTPTransaction.cpp:1012</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPException_html_a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb"><div class="ttname"><a href="classproxygen_1_1HTTPException.html#a63d32340ce3200c654122f8e40d27954a0a0e79f0c191fea76fe119a78a42e0eb">proxygen::HTTPException::Direction::INGRESS_AND_EGRESS</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a471d51265eceb6262ac25f9cf115f105"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a471d51265eceb6262ac25f9cf115f105">proxygen::HTTPTransaction::sendEOMNow</a></div><div class="ttdeci">size_t sendEOMNow()</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l00953">HTTPTransaction.cpp:953</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue_html"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html">proxygen::HTTPTransaction::PrioritySample::WeightedValue</a></div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01421">HTTPTransaction.cpp:1421</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a91147cca992f750017bd431e85952006"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a91147cca992f750017bd431e85952006">proxygen::HTTPTransaction::isUpstream</a></div><div class="ttdeci">bool isUpstream() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00511">HTTPTransaction.h:511</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a93621220dbc29ef70ba34d0bcb245913"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a93621220dbc29ef70ba34d0bcb245913">proxygen::HTTPTransaction::ingressErrorSeen_</a></div><div class="ttdeci">bool ingressErrorSeen_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01479">HTTPTransaction.h:1479</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_aacb764e1b4dbc2caa9b8f3a031b4fe4d"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#aacb764e1b4dbc2caa9b8f3a031b4fe4d">proxygen::HTTPTransaction::priorityFallback_</a></div><div class="ttdeci">bool priorityFallback_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01480">HTTPTransaction.h:1480</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_afda40e08e5ec6811253463896924c19b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#afda40e08e5ec6811253463896924c19b">proxygen::HTTPTransaction::pendingByteEvents_</a></div><div class="ttdeci">uint8_t pendingByteEvents_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01462">HTTPTransaction.h:1462</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a16fd01bfd8dc6a7e734e3a4cbca74eee"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a16fd01bfd8dc6a7e734e3a4cbca74eee">proxygen::HTTPTransaction::flowControlPaused_</a></div><div class="ttdeci">bool flowControlPaused_</div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l01469">HTTPTransaction.h:1469</a></div></div>
<div class="ttc" id="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue_html_a97cea134a36abd566e2ff1363405d424"><div class="ttname"><a href="structproxygen_1_1HTTPTransaction_1_1PrioritySample_1_1WeightedValue.html#a97cea134a36abd566e2ff1363405d424">proxygen::HTTPTransaction::PrioritySample::WeightedValue::getSummary</a></div><div class="ttdeci">void getSummary(HTTPTransaction::PrioritySampleSummary::WeightedAverage &amp;wa) const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8cpp_source.html#l01432">HTTPTransaction.cpp:1432</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTPTransaction_html_a0f5cf49d49de555ca71b92b5b5a7e38b"><div class="ttname"><a href="classproxygen_1_1HTTPTransaction.html#a0f5cf49d49de555ca71b92b5b5a7e38b">proxygen::HTTPTransaction::isEgressComplete</a></div><div class="ttdeci">bool isEgressComplete() const </div><div class="ttdef"><b>Definition:</b> <a href="HTTPTransaction_8h_source.html#l00753">HTTPTransaction.h:753</a></div></div>
<div class="ttc" id="classproxygen_1_1HTTP2PriorityQueueBase_html_affc0541d33b92f8ac94bb95faf4d9015"><div class="ttname"><a href="classproxygen_1_1HTTP2PriorityQueueBase.html#affc0541d33b92f8ac94bb95faf4d9015">proxygen::HTTP2PriorityQueueBase::signalPendingEgress</a></div><div class="ttdeci">virtual void signalPendingEgress(Handle h)=0</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d333e33cf903653326082c1f32e03be5.html">proxygen</a></li><li class="navelem"><a class="el" href="dir_baa8b6fadb61b56c035914fe171fd962.html">lib</a></li><li class="navelem"><a class="el" href="dir_bf1b8217360450c8f2328843af490dd2.html">http</a></li><li class="navelem"><a class="el" href="dir_91354efb629f2a2f97c22c183d400178.html">session</a></li><li class="navelem"><a class="el" href="HTTPTransaction_8cpp.html">HTTPTransaction.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
