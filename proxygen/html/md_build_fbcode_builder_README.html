<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: Easy builds for Facebook projects</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_build_fbcode_builder_README.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Easy builds for Facebook projects </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a Python 2.6+ library designed to simplify continuous-integration (and other builds) of Facebook projects.</p>
<p>For external Travis builds, the entry point is <code>travis_docker_build.sh</code>.</p>
<h2>Using Docker to reproduce a CI build</h2>
<p>If you are debugging or enhancing a CI build, you will want to do so from host or virtual machine that can run a reasonably modern version of Docker:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./make_docker_context.py --help  # See available options for OS &amp; compiler</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;# Tiny wrapper that starts a Travis-like build with compile caching:</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;os_image=ubuntu:16.04 \</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  gcc_version=5 \</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  make_parallelism=2 \</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  travis_cache_dir=~/travis_ccache \</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    ./travis_docker_build.sh &amp;&gt; build_at_$(date +&#39;%Y%m%d_%H%M%S&#39;).log</div></div><!-- fragment --><p><b>IMPORTANT</b>: Read <code>fbcode_builder/README.docker</code> before diving in!</p>
<p>Setting <code>travis_cache_dir</code> turns on <a href="https://ccache.samba.org/">ccache</a>, saving a fresh copy of <code>ccache.tgz</code> after every build. This will invalidate Docker's layer cache, foring it to rebuild starting right after OS package setup, but the builds will be fast because all the compiles will be cached. To iterate without invalidating the Docker layer cache, just <code>cd /tmp/docker-context-*</code> and interact with the <code>Dockerfile</code> normally. Note that the <code>docker-context-*</code> dirs preserve a copy of <code>ccache.tgz</code> as they first used it.</p>
<h1>What to read next</h1>
<p>The *.py files are fairly well-documented. You might want to peruse them in this order:</p><ul>
<li><a class="el" href="shell__quoting_8py.html">shell_quoting.py</a></li>
<li><a class="el" href="fbcode__builder_8py.html">fbcode_builder.py</a></li>
<li><a class="el" href="docker__builder_8py.html">docker_builder.py</a></li>
<li><a class="el" href="make__docker__context_8py.html">make_docker_context.py</a></li>
</ul>
<p>As far as runs on Travis go, the control flow is:</p><ul>
<li>.travis.yml calls</li>
<li>travis_docker_build.sh calls</li>
<li>docker_build_with_ccache.sh</li>
</ul>
<p>This library also has an (unpublished) component targeting Facebook's internal continuous-integration platform using the same build-step DSL.</p>
<h1>Contributing</h1>
<p>Please follow the ambient style (or PEP-8), and keep the code Python 2.6 compatible &ndash; since <code><a class="el" href="namespacefbcode__builder.html">fbcode_builder</a></code>'s only dependency is Docker, we want to allow building projects on even fairly ancient base systems. We also wish to be compatible with Python 3, and would appreciate it if you kept that in mind while making changes also. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
