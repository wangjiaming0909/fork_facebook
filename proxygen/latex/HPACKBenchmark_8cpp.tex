\section{proxygen/lib/http/codec/compress/test/\+H\+P\+A\+C\+K\+Benchmark.cpp File Reference}
\label{HPACKBenchmark_8cpp}\index{proxygen/lib/http/codec/compress/test/\+H\+P\+A\+C\+K\+Benchmark.\+cpp@{proxygen/lib/http/codec/compress/test/\+H\+P\+A\+C\+K\+Benchmark.\+cpp}}
{\ttfamily \#include $<$proxygen/lib/http/codec/compress/test/\+Test\+Util.\+h$>$}\\*
{\ttfamily \#include $<$proxygen/lib/http/codec/compress/test/\+Test\+Streaming\+Callback.\+h$>$}\\*
{\ttfamily \#include $<$folly/\+Benchmark.\+h$>$}\\*
{\ttfamily \#include $<$folly/\+Range.\+h$>$}\\*
{\ttfamily \#include $<$algorithm$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
unique\+\_\+ptr$<$ I\+O\+Buf $>$ {\bf encode} (vector$<$ {\bf H\+P\+A\+C\+K\+Header} $>$ \&headers, {\bf H\+P\+A\+C\+K\+Encoder} \&encoder)
\item 
void {\bf encode\+Decode} (vector$<$ {\bf H\+P\+A\+C\+K\+Header} $>$ \&headers, {\bf H\+P\+A\+C\+K\+Encoder} \&encoder, {\bf H\+P\+A\+C\+K\+Decoder} \&decoder)
\item 
vector$<$ {\bf H\+P\+A\+C\+K\+Header} $>$ {\bf get\+Headers} ()
\item 
void {\bf encode\+Bench} (int reencodes, int iters)
\item 
void {\bf encode\+Decode\+Bench} (int reencodes, int iters)
\item 
{\bf B\+E\+N\+C\+H\+M\+A\+RK} (Encode, iters)
\item 
{\bf B\+E\+N\+C\+H\+M\+A\+RK} (Encode1, iters)
\item 
{\bf B\+E\+N\+C\+H\+M\+A\+RK} (Encode2, iters)
\item 
{\bf B\+E\+N\+C\+H\+M\+A\+RK} (Encode\+Decode, iters)
\item 
{\bf B\+E\+N\+C\+H\+M\+A\+RK} (Encode\+Decode1, iters)
\item 
{\bf B\+E\+N\+C\+H\+M\+A\+RK} (Encode\+Decode2, iters)
\item 
int {\bf main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}}
\index{B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{B\+E\+N\+C\+H\+M\+A\+R\+K(\+Encode, iters)}]{\setlength{\rightskip}{0pt plus 5cm}B\+E\+N\+C\+H\+M\+A\+RK (
\begin{DoxyParamCaption}
\item[{Encode}]{, }
\item[{iters}]{}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_a0f237036358de168719d2e7ac1026487}


Definition at line 81 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References encode\+Bench().


\begin{DoxyCode}
81                          \{
82   encodeBench(0, iters);
83 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}}
\index{B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{B\+E\+N\+C\+H\+M\+A\+R\+K(\+Encode1, iters)}]{\setlength{\rightskip}{0pt plus 5cm}B\+E\+N\+C\+H\+M\+A\+RK (
\begin{DoxyParamCaption}
\item[{Encode1}]{, }
\item[{iters}]{}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_afc66ece1a37edc3ad92e73e6664aa71b}


Definition at line 85 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References encode\+Bench().


\begin{DoxyCode}
85                           \{
86   encodeBench(1, iters);
87 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}}
\index{B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{B\+E\+N\+C\+H\+M\+A\+R\+K(\+Encode2, iters)}]{\setlength{\rightskip}{0pt plus 5cm}B\+E\+N\+C\+H\+M\+A\+RK (
\begin{DoxyParamCaption}
\item[{Encode2}]{, }
\item[{iters}]{}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_afec67aaad1e27236b9f5f4a29e46d741}


Definition at line 89 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References encode\+Bench().


\begin{DoxyCode}
89                           \{
90   encodeBench(2, iters);
91 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}}
\index{B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{B\+E\+N\+C\+H\+M\+A\+R\+K(\+Encode\+Decode, iters)}]{\setlength{\rightskip}{0pt plus 5cm}B\+E\+N\+C\+H\+M\+A\+RK (
\begin{DoxyParamCaption}
\item[{Encode\+Decode}]{, }
\item[{iters}]{}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_a576813395e913e2c898a5d791a6cc3df}


Definition at line 93 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References encode\+Decode\+Bench().


\begin{DoxyCode}
93                                \{
94   encodeDecodeBench(0, iters);
95 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}}
\index{B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{B\+E\+N\+C\+H\+M\+A\+R\+K(\+Encode\+Decode1, iters)}]{\setlength{\rightskip}{0pt plus 5cm}B\+E\+N\+C\+H\+M\+A\+RK (
\begin{DoxyParamCaption}
\item[{Encode\+Decode1}]{, }
\item[{iters}]{}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_adbd980fd6a9a5f9d4607b282e33b9ca8}


Definition at line 97 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References encode\+Decode\+Bench().


\begin{DoxyCode}
97                                 \{
98   encodeDecodeBench(1, iters);
99 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}}
\index{B\+E\+N\+C\+H\+M\+A\+RK@{B\+E\+N\+C\+H\+M\+A\+RK}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{B\+E\+N\+C\+H\+M\+A\+R\+K(\+Encode\+Decode2, iters)}]{\setlength{\rightskip}{0pt plus 5cm}B\+E\+N\+C\+H\+M\+A\+RK (
\begin{DoxyParamCaption}
\item[{Encode\+Decode2}]{, }
\item[{iters}]{}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_afae309d9ecb370ad37a5ef9ee61b1877}


Definition at line 101 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References encode\+Decode\+Bench().


\begin{DoxyCode}
101                                 \{
102   encodeDecodeBench(2, iters);
103 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!encode@{encode}}
\index{encode@{encode}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{encode(vector$<$ H\+P\+A\+C\+K\+Header $>$ \&headers, H\+P\+A\+C\+K\+Encoder \&encoder)}]{\setlength{\rightskip}{0pt plus 5cm}unique\+\_\+ptr$<$I\+O\+Buf$>$ encode (
\begin{DoxyParamCaption}
\item[{vector$<$ {\bf H\+P\+A\+C\+K\+Header} $>$ \&}]{headers, }
\item[{{\bf H\+P\+A\+C\+K\+Encoder} \&}]{encoder}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_a860e4ea0c5704e11bd4caccf4a64180f}


Definition at line 22 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode().



Referenced by encode\+Bench(), encode\+Decode(), T\+E\+S\+T(), proxygen\+::\+Base64\+::url\+Encode(), proxygen\+::\+H\+P\+A\+C\+K\+Codec\+::$\sim$\+H\+P\+A\+C\+K\+Codec(), proxygen\+::huffman\+::\+Huff\+Tree\+::$\sim$\+Huff\+Tree(), and proxygen\+::\+Q\+P\+A\+C\+K\+Codec\+::$\sim$\+Q\+P\+A\+C\+K\+Codec().


\begin{DoxyCode}
22                                                                               \{
23   \textcolor{keywordflow}{return} encoder.encode(headers);
24 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!encode\+Bench@{encode\+Bench}}
\index{encode\+Bench@{encode\+Bench}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{encode\+Bench(int reencodes, int iters)}]{\setlength{\rightskip}{0pt plus 5cm}void encode\+Bench (
\begin{DoxyParamCaption}
\item[{int}]{reencodes, }
\item[{int}]{iters}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_a690dad1b28a1b6aa46ed1097de646358}


Definition at line 60 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References encode().



Referenced by B\+E\+N\+C\+H\+M\+A\+R\+K().


\begin{DoxyCode}
60                                            \{
61   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < iters; i++) \{
62     HPACKEncoder encoder(\textcolor{keyword}{true});
63     encode(headers, encoder);
64     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < reencodes; j++) \{
65       encode(headers, encoder);
66     \}
67   \}
68 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!encode\+Decode@{encode\+Decode}}
\index{encode\+Decode@{encode\+Decode}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{encode\+Decode(vector$<$ H\+P\+A\+C\+K\+Header $>$ \&headers, H\+P\+A\+C\+K\+Encoder \&encoder, H\+P\+A\+C\+K\+Decoder \&decoder)}]{\setlength{\rightskip}{0pt plus 5cm}void encode\+Decode (
\begin{DoxyParamCaption}
\item[{vector$<$ {\bf H\+P\+A\+C\+K\+Header} $>$ \&}]{headers, }
\item[{{\bf H\+P\+A\+C\+K\+Encoder} \&}]{encoder, }
\item[{{\bf H\+P\+A\+C\+K\+Decoder} \&}]{decoder}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_ae9c057d347ce40657ee5d01224406e66}


Definition at line 26 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References proxygen\+::\+H\+P\+A\+C\+K\+Decoder\+::decode\+Streaming(), encode(), and proxygen\+::\+Test\+Streaming\+Callback\+::has\+Error().



Referenced by encode\+Decode\+Bench(), is\+Lowercase(), T\+E\+S\+T\+\_\+\+F(), and T\+E\+S\+T\+\_\+\+P().


\begin{DoxyCode}
27                                          \{
28   unique\_ptr<IOBuf> encoded = encode(headers, encoder);
29   CHECK(encoded);
30   TestStreamingCallback cb;
31   folly::io::Cursor c(encoded.get());
32   decoder.decodeStreaming(c, c.totalLength(), &cb);
33   CHECK(!cb.hasError());
34 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!encode\+Decode\+Bench@{encode\+Decode\+Bench}}
\index{encode\+Decode\+Bench@{encode\+Decode\+Bench}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{encode\+Decode\+Bench(int reencodes, int iters)}]{\setlength{\rightskip}{0pt plus 5cm}void encode\+Decode\+Bench (
\begin{DoxyParamCaption}
\item[{int}]{reencodes, }
\item[{int}]{iters}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_a1428b8fbbb815799e5955f28fe051471}


Definition at line 70 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.



References encode\+Decode().



Referenced by B\+E\+N\+C\+H\+M\+A\+R\+K().


\begin{DoxyCode}
70                                                  \{
71   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < iters; i++) \{
72     HPACKEncoder encoder(\textcolor{keyword}{true});
73     HPACKDecoder decoder;
74     encodeDecode(headers, encoder, decoder);
75     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < reencodes; j++) \{
76       encodeDecode(headers, encoder, decoder);
77     \}
78   \}
79 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!get\+Headers@{get\+Headers}}
\index{get\+Headers@{get\+Headers}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{get\+Headers()}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf H\+P\+A\+C\+K\+Header}$>$ get\+Headers (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_a53255307c0512c7891ab7013dd047454}


Definition at line 37 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.


\begin{DoxyCode}
37                                  \{
38   vector<HPACKHeader> headers;
39   headers.emplace\_back(\textcolor{stringliteral}{":authority"}, \textcolor{stringliteral}{"www.facebook.com"});
40   headers.emplace\_back(\textcolor{stringliteral}{":method"}, \textcolor{stringliteral}{"GET"});
41   headers.emplace\_back(\textcolor{stringliteral}{":path"}, \textcolor{stringliteral}{"/graphql"});
42   headers.emplace\_back(\textcolor{stringliteral}{":scheme"}, \textcolor{stringliteral}{"https"});
43   headers.emplace\_back(
44     \textcolor{stringliteral}{"user-agent"},
45     \textcolor{stringliteral}{"Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_12\_6) AppleWebKit/537.36 "}
46     \textcolor{stringliteral}{"(KHTML, like Gecko) Chrome/60.0.3100.0 Safari/537.36"});
47   headers.emplace\_back(\textcolor{stringliteral}{"accept-encoding"}, \textcolor{stringliteral}{"gzip, deflate, br"});
48   headers.emplace\_back(\textcolor{stringliteral}{"accept-language"}, \textcolor{stringliteral}{"en-US,en;q=0.8"});
49   headers.emplace\_back(
50     \textcolor{stringliteral}{"accept"},
51     \textcolor{stringliteral}{"text/html,application/xhtml+xml,application/xml;q=0.9,image/"}
52     \textcolor{stringliteral}{"webp,image/apng,*/*;q=0.8"});
53   \textcolor{keywordflow}{return} headers;
54 \}
\end{DoxyCode}
\index{H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}!main@{main}}
\index{main@{main}!H\+P\+A\+C\+K\+Benchmark.\+cpp@{H\+P\+A\+C\+K\+Benchmark.\+cpp}}
\subsubsection[{main(int argc, char $\ast$$\ast$argv)}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}\label{HPACKBenchmark_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}


Definition at line 105 of file H\+P\+A\+C\+K\+Benchmark.\+cpp.


\begin{DoxyCode}
105                                 \{
106   gflags::ParseCommandLineFlags(&argc, &argv, \textcolor{keyword}{true});
107   folly::runBenchmarks();
108   \textcolor{keywordflow}{return} 0;
109 \}
\end{DoxyCode}
