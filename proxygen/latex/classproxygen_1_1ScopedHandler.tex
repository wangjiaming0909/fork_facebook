\section{proxygen\+:\+:Scoped\+Handler$<$ Handler\+Type $>$ Class Template Reference}
\label{classproxygen_1_1ScopedHandler}\index{proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$@{proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$}}


{\ttfamily \#include $<$Scoped\+H\+T\+T\+P\+Server.\+h$>$}

Inheritance diagram for proxygen\+:\+:Scoped\+Handler$<$ Handler\+Type $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classproxygen_1_1ScopedHandler}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf Scoped\+Handler} (Handler\+Type $\ast$ptr)
\item 
void {\bf on\+Request} (std\+::unique\+\_\+ptr$<$ {\bf H\+T\+T\+P\+Message} $>$ headers) noexceptoverride
\item 
void {\bf on\+Body} (std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$ body) noexceptoverride
\item 
void {\bf on\+Upgrade} ({\bf proxygen\+::\+Upgrade\+Protocol}) noexceptoverride
\item 
void {\bf on\+E\+OM} () noexceptoverride
\item 
void {\bf request\+Complete} () noexceptoverride
\item 
void {\bf on\+Error} ({\bf Proxygen\+Error}) noexceptoverride
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
Handler\+Type $\ast$const {\bf handler\+Ptr\+\_\+} \{{\bf nullptr}\}
\item 
std\+::unique\+\_\+ptr$<$ {\bf H\+T\+T\+P\+Message} $>$ {\bf request\+\_\+}
\item 
folly\+::\+I\+O\+Buf\+Queue {\bf request\+Body\+\_\+}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\subsubsection*{template$<$typename Handler\+Type$>$\\*
class proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$}



Definition at line 21 of file Scoped\+H\+T\+T\+P\+Server.\+h.



\subsection{Constructor \& Destructor Documentation}
\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!Scoped\+Handler@{Scoped\+Handler}}
\index{Scoped\+Handler@{Scoped\+Handler}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{Scoped\+Handler(\+Handler\+Type $\ast$ptr)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::{\bf Scoped\+Handler} (
\begin{DoxyParamCaption}
\item[{Handler\+Type $\ast$}]{ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}\label{classproxygen_1_1ScopedHandler_ade9ef3e13bc48e5269e4e9c22362272b}


Definition at line 23 of file Scoped\+H\+T\+T\+P\+Server.\+h.


\begin{DoxyCode}
23                                           : handlerPtr_(ptr) \{
24   \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!on\+Body@{on\+Body}}
\index{on\+Body@{on\+Body}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{on\+Body(std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$ body) noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ void {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::on\+Body (
\begin{DoxyParamCaption}
\item[{std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$}]{body}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classproxygen_1_1ScopedHandler_aa5088905641ed85f4fd75df52d57f920}
Invoked when we get part of body for the request. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_aaf0ed3bb94384e6240e15cca63de82bb}.



Definition at line 30 of file Scoped\+H\+T\+T\+P\+Server.\+h.



References proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$\+::request\+Body\+\_\+.


\begin{DoxyCode}
30                                                                 \{
31     requestBody_.append(std::move(body));
32   \}
\end{DoxyCode}
\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!on\+E\+OM@{on\+E\+OM}}
\index{on\+E\+OM@{on\+E\+OM}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{on\+E\+O\+M() noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ void {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::on\+E\+OM (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classproxygen_1_1ScopedHandler_a1520d45a186998329fd243ee4cb285aa}
Invoked when we finish receiving the body. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_a24f26d2cf71effaf154ce53aeff51aab}.



Definition at line 36 of file Scoped\+H\+T\+T\+P\+Server.\+h.



References proxygen\+::\+Response\+Builder\+::body(), proxygen\+::\+Request\+Handler\+::downstream\+\_\+, proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$\+::request\+\_\+, proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$\+::request\+Body\+\_\+, proxygen\+::\+Response\+Builder\+::send\+With\+E\+O\+M(), and proxygen\+::\+Response\+Builder\+::status().


\begin{DoxyCode}
36                                  \{
37     \textcolor{keywordflow}{try} \{
38       ResponseBuilder r(downstream_);
39       (*handlerPtr\_)(*request_, requestBody_.move(), r);
40       r.sendWithEOM();
41     \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::exception& ex) \{
42       ResponseBuilder(downstream_)
43           .status(500, \textcolor{stringliteral}{"Internal Server Error"})
44           .body(ex.what())
45           .sendWithEOM();
46     \} \textcolor{keywordflow}{catch} (...) \{
47       ResponseBuilder(downstream_)
48           .status(500, \textcolor{stringliteral}{"Internal Server Error"})
49           .body(\textcolor{stringliteral}{"Unknown exception thrown"})
50           .sendWithEOM();
51     \}
52   \}
\end{DoxyCode}
\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!on\+Error@{on\+Error}}
\index{on\+Error@{on\+Error}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{on\+Error(\+Proxygen\+Error) noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ void {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::on\+Error (
\begin{DoxyParamCaption}
\item[{{\bf Proxygen\+Error}}]{err}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classproxygen_1_1ScopedHandler_ae7e7708a6ba4072b20ecb67da833307c}
Request failed. Maybe because of read/write error on socket or client not being able to send request in time.

N\+O\+TE\+: Can be invoked at any time (except for before on\+Request).

No more callbacks will be invoked after this. You should clean up after yourself. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_ad7e6428b925840a334adc58ff6f4f680}.



Definition at line 56 of file Scoped\+H\+T\+T\+P\+Server.\+h.


\begin{DoxyCode}
56 \{ \textcolor{keyword}{delete} \textcolor{keyword}{this}; \}
\end{DoxyCode}
\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!on\+Request@{on\+Request}}
\index{on\+Request@{on\+Request}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{on\+Request(std\+::unique\+\_\+ptr$<$ H\+T\+T\+P\+Message $>$ headers) noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ void {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::on\+Request (
\begin{DoxyParamCaption}
\item[{std\+::unique\+\_\+ptr$<$ {\bf H\+T\+T\+P\+Message} $>$}]{headers}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classproxygen_1_1ScopedHandler_a9ede42df62860a42d1a7dcb03b1c0cb2}
Invoked when we have successfully fetched headers from client. This will always be the first callback invoked on your handler. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_a61f59e1155f906c7b73062147164320f}.



Definition at line 26 of file Scoped\+H\+T\+T\+P\+Server.\+h.



References proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$\+::request\+\_\+.


\begin{DoxyCode}
26                                                                        \{
27     request_ = std::move(headers);
28   \}
\end{DoxyCode}
\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!on\+Upgrade@{on\+Upgrade}}
\index{on\+Upgrade@{on\+Upgrade}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{on\+Upgrade(proxygen\+::\+Upgrade\+Protocol) noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ void {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::on\+Upgrade (
\begin{DoxyParamCaption}
\item[{{\bf proxygen\+::\+Upgrade\+Protocol}}]{prot}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classproxygen_1_1ScopedHandler_acd64ce67705aa5b1e9fe5c627a4e94c0}
Invoked when the session has been upgraded to a different protocol 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_aefed2946bc5558baf6e36a2d11290b79}.



Definition at line 34 of file Scoped\+H\+T\+T\+P\+Server.\+h.


\begin{DoxyCode}
34 \{\}
\end{DoxyCode}
\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!request\+Complete@{request\+Complete}}
\index{request\+Complete@{request\+Complete}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{request\+Complete() noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ void {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::request\+Complete (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classproxygen_1_1ScopedHandler_aaeac72adf0424305ed63fdc8c20fc75d}
Invoked when request processing has been completed and nothing more needs to be done. This may be a good place to log some stats and clean up resources. This is distinct from \doxyref{on\+E\+O\+M()}{p.}{classproxygen_1_1ScopedHandler_a1520d45a186998329fd243ee4cb285aa} because it is invoked after the response is fully sent. Once this callback has been received, {\ttfamily downstream\+\_\+} should be considered invalid. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_a0ec159751b407bcd3667994c6d8d7cfe}.



Definition at line 54 of file Scoped\+H\+T\+T\+P\+Server.\+h.


\begin{DoxyCode}
54 \{ \textcolor{keyword}{delete} \textcolor{keyword}{this}; \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!handler\+Ptr\+\_\+@{handler\+Ptr\+\_\+}}
\index{handler\+Ptr\+\_\+@{handler\+Ptr\+\_\+}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{handler\+Ptr\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ Handler\+Type$\ast$ const {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::handler\+Ptr\+\_\+ \{{\bf nullptr}\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1ScopedHandler_a4a87a9850cd828d60ed179c8ef6c0962}


Definition at line 58 of file Scoped\+H\+T\+T\+P\+Server.\+h.

\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!request\+\_\+@{request\+\_\+}}
\index{request\+\_\+@{request\+\_\+}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{request\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ std\+::unique\+\_\+ptr$<${\bf H\+T\+T\+P\+Message}$>$ {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::request\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1ScopedHandler_aae5aa6b160f1e421ec4fc282abbec36b}


Definition at line 60 of file Scoped\+H\+T\+T\+P\+Server.\+h.



Referenced by proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$\+::on\+E\+O\+M(), and proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$\+::on\+Request().

\index{proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}!request\+Body\+\_\+@{request\+Body\+\_\+}}
\index{request\+Body\+\_\+@{request\+Body\+\_\+}!proxygen\+::\+Scoped\+Handler@{proxygen\+::\+Scoped\+Handler}}
\subsubsection[{request\+Body\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Handler\+Type $>$ folly\+::\+I\+O\+Buf\+Queue {\bf proxygen\+::\+Scoped\+Handler}$<$ Handler\+Type $>$\+::request\+Body\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1ScopedHandler_aa1e070bde053179b559070f94b4b8488}


Definition at line 61 of file Scoped\+H\+T\+T\+P\+Server.\+h.



Referenced by proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$\+::on\+Body(), and proxygen\+::\+Scoped\+Handler$<$ Handler\+Type $>$\+::on\+E\+O\+M().



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
proxygen/httpserver/{\bf Scoped\+H\+T\+T\+P\+Server.\+h}\end{DoxyCompactItemize}
