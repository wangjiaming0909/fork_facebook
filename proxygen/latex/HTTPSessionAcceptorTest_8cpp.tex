\section{proxygen/lib/http/session/test/\+H\+T\+T\+P\+Session\+Acceptor\+Test.cpp File Reference}
\label{HTTPSessionAcceptorTest_8cpp}\index{proxygen/lib/http/session/test/\+H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{proxygen/lib/http/session/test/\+H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
{\ttfamily \#include $<$proxygen/lib/http/session/\+H\+T\+T\+P\+Session\+Acceptor.\+h$>$}\\*
{\ttfamily \#include $<$proxygen/lib/http/session/test/\+H\+T\+T\+P\+Session\+Mocks.\+h$>$}\\*
{\ttfamily \#include $<$proxygen/lib/utils/\+Test\+Utils.\+h$>$}\\*
{\ttfamily \#include $<$folly/io/async/\+Async\+S\+S\+L\+Socket.\+h$>$}\\*
{\ttfamily \#include $<$folly/io/async/test/\+Mock\+Async\+Server\+Socket.\+h$>$}\\*
{\ttfamily \#include $<$folly/io/async/test/\+Mock\+Async\+Socket.\+h$>$}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class {\bf H\+T\+T\+P\+Target\+Session\+Acceptor}
\item 
class {\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+Base}
\item 
class {\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+PN}
\item 
class {\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Plaintext}
\item 
class {\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Junk}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\bf T\+E\+S\+T\+\_\+P} ({\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+PN}, Npn)
\item 
{\bf I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P} (N\+P\+N\+Positive, {\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+PN},\+::testing\+::\+Values\+In({\bf protos1}))
\item 
{\bf T\+E\+S\+T\+\_\+P} ({\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Plaintext}, Plaintext\+Protocols)
\item 
{\bf I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P} (N\+P\+N\+Plaintext, {\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Plaintext},\+::testing\+::\+Values\+In({\bf protos2}))
\item 
{\bf T\+E\+S\+T\+\_\+F} ({\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Junk}, Npn)
\item 
{\bf T\+E\+S\+T\+\_\+F} ({\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+PN}, Acceptor\+Config\+Capture)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char const $\ast$ {\bf protos1} [$\,$]
\item 
char const $\ast$ {\bf protos2} [$\,$] = \{ \char`\"{}spdy/3\char`\"{}, \char`\"{}h2c\char`\"{} \}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}!I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P@{I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P}}
\index{I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P@{I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P}!H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
\subsubsection[{I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+\+P(\+N\+P\+N\+Positive, H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N,\+::testing\+::\+Values\+In(protos1))}]{\setlength{\rightskip}{0pt plus 5cm}I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P (
\begin{DoxyParamCaption}
\item[{N\+P\+N\+Positive}]{, }
\item[{{\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+PN}}]{, }
\item[{\+::testing\+::\+Values\+In({\bf protos1})}]{}
\end{DoxyParamCaption}
)}\label{HTTPSessionAcceptorTest_8cpp_a0bcf6e7e48080f940cca553bb5e48171}
\index{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}!I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P@{I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P}}
\index{I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P@{I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P}!H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
\subsubsection[{I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+\+P(\+N\+P\+N\+Plaintext, H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Plaintext,\+::testing\+::\+Values\+In(protos2))}]{\setlength{\rightskip}{0pt plus 5cm}I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P (
\begin{DoxyParamCaption}
\item[{N\+P\+N\+Plaintext}]{, }
\item[{{\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Plaintext}}]{, }
\item[{\+::testing\+::\+Values\+In({\bf protos2})}]{}
\end{DoxyParamCaption}
)}\label{HTTPSessionAcceptorTest_8cpp_a95e200349eb0610c597832ca5d35746d}
\index{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}!T\+E\+S\+T\+\_\+F@{T\+E\+S\+T\+\_\+F}}
\index{T\+E\+S\+T\+\_\+F@{T\+E\+S\+T\+\_\+F}!H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
\subsubsection[{T\+E\+S\+T\+\_\+\+F(\+H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Junk, Npn)}]{\setlength{\rightskip}{0pt plus 5cm}T\+E\+S\+T\+\_\+F (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Junk}}]{, }
\item[{Npn}]{}
\end{DoxyParamCaption}
)}\label{HTTPSessionAcceptorTest_8cpp_ab37b7c93bd4353bf4d09c4d1bfd2bfa5}


Definition at line 173 of file H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp.



References proxygen\+::\+N\+O\+NE.


\begin{DoxyCode}
173                                             \{
174   std::string proto(\textcolor{stringliteral}{"/http/1.1"});
175   MockAsyncSocket::UniquePtr sock(\textcolor{keyword}{new} MockAsyncSocket(&eventBase\_));
176   SocketAddress clientAddress;
177   wangle::TransportInfo tinfo;
178   EXPECT\_CALL(*sock.get(), closeNow());
179   acceptor\_->connectionReady(
180       std::move(sock),
181       clientAddress,
182       proto,
183       SecureTransportType::NONE,
184       tinfo);
185   EXPECT\_EQ(acceptor\_->sessionsCreated\_, 0);
186   EXPECT\_EQ(acceptor\_->sessionCreationErrors\_, 1);
187 \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}!T\+E\+S\+T\+\_\+F@{T\+E\+S\+T\+\_\+F}}
\index{T\+E\+S\+T\+\_\+F@{T\+E\+S\+T\+\_\+F}!H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
\subsubsection[{T\+E\+S\+T\+\_\+\+F(\+H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N, Acceptor\+Config\+Capture)}]{\setlength{\rightskip}{0pt plus 5cm}T\+E\+S\+T\+\_\+F (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+PN}}]{, }
\item[{Acceptor\+Config\+Capture}]{}
\end{DoxyParamCaption}
)}\label{HTTPSessionAcceptorTest_8cpp_af6540fb4caca0a3b1eb142945d0d3c35}


Definition at line 189 of file H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp.



References proxygen\+::\+N\+O\+NE.


\begin{DoxyCode}
189                                                           \{
190   newAcceptor();
191   config\_.reset();
192   acceptor\_->expectedProto\_ = \textcolor{stringliteral}{"http/1.1"};
193   AsyncSocket::UniquePtr sock(\textcolor{keyword}{new} AsyncSocket(&eventBase\_));
194   SocketAddress clientAddress;
195   wangle::TransportInfo tinfo;
196   acceptor\_->connectionReady(
197       std::move(sock), clientAddress, \textcolor{stringliteral}{""}, SecureTransportType::NONE, tinfo);
198 \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}!T\+E\+S\+T\+\_\+P@{T\+E\+S\+T\+\_\+P}}
\index{T\+E\+S\+T\+\_\+P@{T\+E\+S\+T\+\_\+P}!H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
\subsubsection[{T\+E\+S\+T\+\_\+\+P(\+H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N, Npn)}]{\setlength{\rightskip}{0pt plus 5cm}T\+E\+S\+T\+\_\+P (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+PN}}]{, }
\item[{Npn}]{}
\end{DoxyParamCaption}
)}\label{HTTPSessionAcceptorTest_8cpp_a0c7d02ae8ead826c4fdd8069d0756f5c}


Definition at line 114 of file H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp.


\begin{DoxyCode}
114                                         \{
115   std::string proto(GetParam());
116   \textcolor{keywordflow}{if} (proto == \textcolor{stringliteral}{""}) \{
117     acceptor\_->expectedProto\_ = \textcolor{stringliteral}{"http/1.1"};
118   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (proto.find(\textcolor{stringliteral}{"h2"}) != std::string::npos) \{
119     acceptor\_->expectedProto\_ = \textcolor{stringliteral}{"http/2"};
120   \} \textcolor{keywordflow}{else} \{
121     acceptor\_->expectedProto\_ = proto;
122   \}
123 
124   \textcolor{keyword}{auto} ctx = std::make\_shared<folly::SSLContext>();
125   AsyncSSLSocket::UniquePtr sock(\textcolor{keyword}{new} AsyncSSLSocket(ctx, &eventBase\_));
126   SocketAddress clientAddress;
127   wangle::TransportInfo tinfo;
128   acceptor\_->connectionReady(
129       std::move(sock),
130       clientAddress,
131       proto,
132       SecureTransportType::TLS,
133       tinfo);
134   EXPECT\_EQ(acceptor\_->sessionsCreated\_, 1);
135   EXPECT\_EQ(acceptor\_->sessionCreationErrors\_, 0);
136 \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}!T\+E\+S\+T\+\_\+P@{T\+E\+S\+T\+\_\+P}}
\index{T\+E\+S\+T\+\_\+P@{T\+E\+S\+T\+\_\+P}!H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
\subsubsection[{T\+E\+S\+T\+\_\+\+P(\+H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Plaintext, Plaintext\+Protocols)}]{\setlength{\rightskip}{0pt plus 5cm}T\+E\+S\+T\+\_\+P (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P\+Session\+Acceptor\+Test\+N\+P\+N\+Plaintext}}]{, }
\item[{Plaintext\+Protocols}]{}
\end{DoxyParamCaption}
)}\label{HTTPSessionAcceptorTest_8cpp_acc67341d0c95a84e5ec30889366e9a52}


Definition at line 145 of file H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp.



References proxygen\+::\+N\+O\+NE.


\begin{DoxyCode}
145                                                                 \{
146   std::string proto(GetParam());
147   config\_->plaintextProtocol = proto;
148   newAcceptor();
149   \textcolor{keywordflow}{if} (proto == \textcolor{stringliteral}{"h2c"}) \{
150     acceptor\_->expectedProto\_ = \textcolor{stringliteral}{"http/2"};
151   \} \textcolor{keywordflow}{else} \{
152     acceptor\_->expectedProto\_ = proto;
153   \}
154   AsyncSocket::UniquePtr sock(\textcolor{keyword}{new} AsyncSocket(&eventBase\_));
155   SocketAddress clientAddress;
156   wangle::TransportInfo tinfo;
157   acceptor\_->connectionReady(
158       std::move(sock),
159       clientAddress,
160       \textcolor{stringliteral}{""},
161       SecureTransportType::NONE,
162       tinfo);
163   EXPECT\_EQ(acceptor\_->sessionsCreated\_, 1);
164   EXPECT\_EQ(acceptor\_->sessionCreationErrors\_, 0);
165 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\index{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}!protos1@{protos1}}
\index{protos1@{protos1}!H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
\subsubsection[{protos1}]{\setlength{\rightskip}{0pt plus 5cm}char const$\ast$ protos1[$\,$]}\label{HTTPSessionAcceptorTest_8cpp_a0883ca8e5891eab14de604d0851500b6}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{ \textcolor{stringliteral}{"h2-14"}, \textcolor{stringliteral}{"h2"}, \textcolor{stringliteral}{"spdy/3.1"}, \textcolor{stringliteral}{"spdy/3"},
                          \textcolor{stringliteral}{"http/1.1"}, \textcolor{stringliteral}{""} \}
\end{DoxyCode}


Definition at line 138 of file H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp.

\index{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}!protos2@{protos2}}
\index{protos2@{protos2}!H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp@{H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp}}
\subsubsection[{protos2}]{\setlength{\rightskip}{0pt plus 5cm}char const$\ast$ protos2[$\,$] = \{ \char`\"{}spdy/3\char`\"{}, \char`\"{}h2c\char`\"{} \}}\label{HTTPSessionAcceptorTest_8cpp_abcaf92cd41f2b96f0a6130b267ee0759}


Definition at line 167 of file H\+T\+T\+P\+Session\+Acceptor\+Test.\+cpp.

