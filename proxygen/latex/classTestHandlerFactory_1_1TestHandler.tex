\section{Test\+Handler\+Factory\+:\+:Test\+Handler Class Reference}
\label{classTestHandlerFactory_1_1TestHandler}\index{Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}}
Inheritance diagram for Test\+Handler\+Factory\+:\+:Test\+Handler\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classTestHandlerFactory_1_1TestHandler}
\end{center}
\end{figure}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void {\bf on\+Request} (std\+::unique\+\_\+ptr$<$ {\bf H\+T\+T\+P\+Message} $>$) noexceptoverride
\item 
void {\bf on\+Body} (std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$) noexceptoverride
\item 
void {\bf on\+Upgrade} ({\bf Upgrade\+Protocol}) noexceptoverride
\item 
void {\bf on\+E\+OM} () noexceptoverride
\item 
void {\bf request\+Complete} () noexceptoverride
\item 
void {\bf on\+Error} ({\bf Proxygen\+Error}) noexceptoverride
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 206 of file H\+T\+T\+P\+Server\+Test.\+cpp.



\subsection{Member Function Documentation}
\index{Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}!on\+Body@{on\+Body}}
\index{on\+Body@{on\+Body}!Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}}
\subsubsection[{on\+Body(std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$) noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}void Test\+Handler\+Factory\+::\+Test\+Handler\+::on\+Body (
\begin{DoxyParamCaption}
\item[{std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$}]{body}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classTestHandlerFactory_1_1TestHandler_a1f42ee88b5ab0d9428510dfb79313c3e}
Invoked when we get part of body for the request. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_aaf0ed3bb94384e6240e15cca63de82bb}.



Definition at line 209 of file H\+T\+T\+P\+Server\+Test.\+cpp.


\begin{DoxyCode}
209 \{\}
\end{DoxyCode}
\index{Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}!on\+E\+OM@{on\+E\+OM}}
\index{on\+E\+OM@{on\+E\+OM}!Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}}
\subsubsection[{on\+E\+O\+M() noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}void Test\+Handler\+Factory\+::\+Test\+Handler\+::on\+E\+OM (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classTestHandlerFactory_1_1TestHandler_add4e2e2fc541ec615c5a4ca09ad8d669}
Invoked when we finish receiving the body. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_a24f26d2cf71effaf154ce53aeff51aab}.



Definition at line 213 of file H\+T\+T\+P\+Server\+Test.\+cpp.



References proxygen\+::\+Response\+Builder\+::body(), proxygen\+::\+Response\+Builder\+::header(), proxygen\+::\+Response\+Builder\+::send\+With\+E\+O\+M(), and proxygen\+::\+Response\+Builder\+::status().


\begin{DoxyCode}
213                                    \{
214       std::string certHeader(\textcolor{stringliteral}{""});
215       \textcolor{keyword}{auto} txn = CHECK\_NOTNULL(downstream_->getTransaction());
216       \textcolor{keyword}{auto}& transport = txn->getTransport();
217       \textcolor{keywordflow}{if} (\textcolor{keyword}{auto} cert = transport.getUnderlyingTransport()->getPeerCert()) \{
218         certHeader = OpenSSLCertUtils::getCommonName(*cert).value\_or(\textcolor{stringliteral}{""});
219       \}
220       ResponseBuilder(downstream_)
221           .status(200, \textcolor{stringliteral}{"OK"})
222           .header(\textcolor{stringliteral}{"X-Client-CN"}, certHeader)
223           .body(IOBuf::copyBuffer(\textcolor{stringliteral}{"hello"}))
224           .sendWithEOM();
225     \}
\end{DoxyCode}
\index{Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}!on\+Error@{on\+Error}}
\index{on\+Error@{on\+Error}!Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}}
\subsubsection[{on\+Error(\+Proxygen\+Error) noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}void Test\+Handler\+Factory\+::\+Test\+Handler\+::on\+Error (
\begin{DoxyParamCaption}
\item[{{\bf Proxygen\+Error}}]{err}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classTestHandlerFactory_1_1TestHandler_a73c20a1e40bf0df739eedf1bd95e5959}
Request failed. Maybe because of read/write error on socket or client not being able to send request in time.

N\+O\+TE\+: Can be invoked at any time (except for before on\+Request).

No more callbacks will be invoked after this. You should clean up after yourself. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_ad7e6428b925840a334adc58ff6f4f680}.



Definition at line 229 of file H\+T\+T\+P\+Server\+Test.\+cpp.


\begin{DoxyCode}
229 \{ \textcolor{keyword}{delete} \textcolor{keyword}{this}; \}
\end{DoxyCode}
\index{Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}!on\+Request@{on\+Request}}
\index{on\+Request@{on\+Request}!Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}}
\subsubsection[{on\+Request(std\+::unique\+\_\+ptr$<$ H\+T\+T\+P\+Message $>$) noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}void Test\+Handler\+Factory\+::\+Test\+Handler\+::on\+Request (
\begin{DoxyParamCaption}
\item[{std\+::unique\+\_\+ptr$<$ {\bf H\+T\+T\+P\+Message} $>$}]{headers}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classTestHandlerFactory_1_1TestHandler_a5b535c2d7848093e8867612a8ab68671}
Invoked when we have successfully fetched headers from client. This will always be the first callback invoked on your handler. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_a61f59e1155f906c7b73062147164320f}.



Definition at line 207 of file H\+T\+T\+P\+Server\+Test.\+cpp.


\begin{DoxyCode}
207                                                                  \{
208     \}
\end{DoxyCode}
\index{Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}!on\+Upgrade@{on\+Upgrade}}
\index{on\+Upgrade@{on\+Upgrade}!Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}}
\subsubsection[{on\+Upgrade(\+Upgrade\+Protocol) noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}void Test\+Handler\+Factory\+::\+Test\+Handler\+::on\+Upgrade (
\begin{DoxyParamCaption}
\item[{{\bf Upgrade\+Protocol}}]{prot}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classTestHandlerFactory_1_1TestHandler_a14ede8817b4fa03b35fbf3667960c988}
Invoked when the session has been upgraded to a different protocol 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_aefed2946bc5558baf6e36a2d11290b79}.



Definition at line 210 of file H\+T\+T\+P\+Server\+Test.\+cpp.


\begin{DoxyCode}
210                                                       \{
211     \}
\end{DoxyCode}
\index{Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}!request\+Complete@{request\+Complete}}
\index{request\+Complete@{request\+Complete}!Test\+Handler\+Factory\+::\+Test\+Handler@{Test\+Handler\+Factory\+::\+Test\+Handler}}
\subsubsection[{request\+Complete() noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}void Test\+Handler\+Factory\+::\+Test\+Handler\+::request\+Complete (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}\label{classTestHandlerFactory_1_1TestHandler_af44c52b07d2de5fc68122f854c5a8bf7}
Invoked when request processing has been completed and nothing more needs to be done. This may be a good place to log some stats and clean up resources. This is distinct from \doxyref{on\+E\+O\+M()}{p.}{classTestHandlerFactory_1_1TestHandler_add4e2e2fc541ec615c5a4ca09ad8d669} because it is invoked after the response is fully sent. Once this callback has been received, {\ttfamily downstream\+\_\+} should be considered invalid. 

Implements {\bf proxygen\+::\+Request\+Handler} \doxyref{}{p.}{classproxygen_1_1RequestHandler_a0ec159751b407bcd3667994c6d8d7cfe}.



Definition at line 227 of file H\+T\+T\+P\+Server\+Test.\+cpp.


\begin{DoxyCode}
227 \{ \textcolor{keyword}{delete} \textcolor{keyword}{this}; \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
proxygen/httpserver/tests/{\bf H\+T\+T\+P\+Server\+Test.\+cpp}\end{DoxyCompactItemize}
