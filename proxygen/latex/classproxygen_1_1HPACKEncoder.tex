\section{proxygen\+:\+:H\+P\+A\+C\+K\+Encoder Class Reference}
\label{classproxygen_1_1HPACKEncoder}\index{proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}}


{\ttfamily \#include $<$H\+P\+A\+C\+K\+Encoder.\+h$>$}

Inheritance diagram for proxygen\+:\+:H\+P\+A\+C\+K\+Encoder\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classproxygen_1_1HPACKEncoder}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf H\+P\+A\+C\+K\+Encoder} (bool huffman, uint32\+\_\+t table\+Size={\bf H\+P\+A\+C\+K\+::k\+Table\+Size})
\item 
std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$ {\bf encode} (const std\+::vector$<$ {\bf H\+P\+A\+C\+K\+Header} $>$ \&headers, uint32\+\_\+t headroom=0)
\item 
void {\bf set\+Header\+Table\+Size} (uint32\+\_\+t size)
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void {\bf encode\+As\+Index} (uint32\+\_\+t index)
\item 
void {\bf encode\+Header} (const {\bf H\+P\+A\+C\+K\+Header} \&header)
\item 
bool {\bf encode\+As\+Literal} (const {\bf H\+P\+A\+C\+K\+Header} \&header, bool indexing)
\item 
void {\bf encode\+Literal} (const {\bf H\+P\+A\+C\+K\+Header} \&header, uint32\+\_\+t {\bf name\+Index}, const {\bf H\+P\+A\+C\+K\+::\+Instruction} \&instruction)
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 19 of file H\+P\+A\+C\+K\+Encoder.\+h.



\subsection{Constructor \& Destructor Documentation}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}!H\+P\+A\+C\+K\+Encoder@{H\+P\+A\+C\+K\+Encoder}}
\index{H\+P\+A\+C\+K\+Encoder@{H\+P\+A\+C\+K\+Encoder}!proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}}
\subsubsection[{H\+P\+A\+C\+K\+Encoder(bool huffman, uint32\+\_\+t table\+Size=\+H\+P\+A\+C\+K\+::k\+Table\+Size)}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::\+H\+P\+A\+C\+K\+Encoder (
\begin{DoxyParamCaption}
\item[{bool}]{huffman, }
\item[{uint32\+\_\+t}]{table\+Size = {\ttfamily {\bf H\+P\+A\+C\+K\+::k\+Table\+Size}}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}\label{classproxygen_1_1HPACKEncoder_a658523b11a50f8a066023e3b1dc49095}


Definition at line 22 of file H\+P\+A\+C\+K\+Encoder.\+h.



References encode().


\begin{DoxyCode}
24       : HPACKEncoderBase(huffman)
25       , HPACKContext(tableSize) \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}!encode@{encode}}
\index{encode@{encode}!proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}}
\subsubsection[{encode(const std\+::vector$<$ H\+P\+A\+C\+K\+Header $>$ \&headers, uint32\+\_\+t headroom=0)}]{\setlength{\rightskip}{0pt plus 5cm}std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$ proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode (
\begin{DoxyParamCaption}
\item[{const std\+::vector$<$ {\bf H\+P\+A\+C\+K\+Header} $>$ \&}]{headers, }
\item[{uint32\+\_\+t}]{headroom = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncoder_acde33b6912f84caa04d6fc27f3b35f63}
Encode the given headers. 

Definition at line 17 of file H\+P\+A\+C\+K\+Encoder.\+cpp.



References proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::add\+Headroom(), proxygen\+::\+Header\+Table\+::capacity(), encode\+Header(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+Base\+::handle\+Pending\+Context\+Update(), proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::release(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+Base\+::stream\+Buffer\+\_\+, and proxygen\+::\+H\+P\+A\+C\+K\+Context\+::table\+\_\+.



Referenced by encode(), proxygen\+::\+H\+P\+A\+C\+K\+Codec\+::encode(), proxygen\+::hpack\+::encode\+Decode(), H\+P\+A\+C\+K\+Encoder(), T\+E\+S\+T\+\_\+\+F(), and T\+E\+S\+T\+\_\+\+P().


\begin{DoxyCode}
17                                                                           \{
18   \textcolor{keywordflow}{if} (headroom) \{
19     streamBuffer_.addHeadroom(headroom);
20   \}
21   handlePendingContextUpdate(streamBuffer_, table_.capacity());
22   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& header : headers) \{
23     encodeHeader(header);
24   \}
25   \textcolor{keywordflow}{return} streamBuffer_.release();
26 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}!encode\+As\+Index@{encode\+As\+Index}}
\index{encode\+As\+Index@{encode\+As\+Index}!proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}}
\subsubsection[{encode\+As\+Index(uint32\+\_\+t index)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode\+As\+Index (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{index}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncoder_a9b47cddd9427be02525e252bee805468}


Definition at line 63 of file H\+P\+A\+C\+K\+Encoder.\+cpp.



References proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Integer(), proxygen\+::\+H\+P\+A\+C\+K\+::\+I\+N\+D\+E\+X\+\_\+\+R\+EF, and proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+Base\+::stream\+Buffer\+\_\+.



Referenced by encode\+Header(), and set\+Header\+Table\+Size().


\begin{DoxyCode}
63                                                \{
64   VLOG(10) << \textcolor{stringliteral}{"encoding index="} << index;
65   streamBuffer_.encodeInteger(index, HPACK::INDEX_REF);
66 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}!encode\+As\+Literal@{encode\+As\+Literal}}
\index{encode\+As\+Literal@{encode\+As\+Literal}!proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}}
\subsubsection[{encode\+As\+Literal(const H\+P\+A\+C\+K\+Header \&header, bool indexing)}]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode\+As\+Literal (
\begin{DoxyParamCaption}
\item[{const {\bf H\+P\+A\+C\+K\+Header} \&}]{header, }
\item[{bool}]{indexing}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncoder_a54fa97bb9b76f9099ca63037beae7cdf}


Definition at line 28 of file H\+P\+A\+C\+K\+Encoder.\+cpp.



References proxygen\+::\+Header\+Table\+::add(), proxygen\+::\+H\+P\+A\+C\+K\+Header\+::bytes(), proxygen\+::\+Header\+Table\+::capacity(), proxygen\+::\+H\+P\+A\+C\+K\+Header\+::copy(), encode\+Literal(), proxygen\+::\+H\+P\+A\+C\+K\+::\+L\+I\+T\+E\+R\+AL, proxygen\+::\+H\+P\+A\+C\+K\+::\+L\+I\+T\+E\+R\+A\+L\+\_\+\+I\+N\+C\+\_\+\+I\+N\+D\+EX, proxygen\+::\+H\+P\+A\+C\+K\+Header\+::name, proxygen\+::\+H\+P\+A\+C\+K\+Context\+::name\+Index(), and proxygen\+::\+H\+P\+A\+C\+K\+Context\+::table\+\_\+.



Referenced by encode\+Header(), and set\+Header\+Table\+Size().


\begin{DoxyCode}
28                                                                            \{
29   \textcolor{keywordflow}{if} (header.bytes() > table_.capacity()) \{
30     \textcolor{comment}{// May want to investigate further whether or not this is wanted.}
31     \textcolor{comment}{// Flushing the table on a large header frees up some memory,}
32     \textcolor{comment}{// however, there will be no compression due to an empty table, and}
33     \textcolor{comment}{// the table will fill up again fairly quickly}
34     indexing = \textcolor{keyword}{false};
35   \}
36 
37   HPACK::Instruction instruction = (indexing) ?
38     HPACK::LITERAL_INC_INDEX : HPACK::LITERAL;
39 
40   encodeLiteral(header, nameIndex(header.name), instruction);
41   \textcolor{comment}{// indexed ones need to get added to the header table}
42   \textcolor{keywordflow}{if} (indexing) \{
43     CHECK(table_.add(header.copy()));
44   \}
45   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
46 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}!encode\+Header@{encode\+Header}}
\index{encode\+Header@{encode\+Header}!proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}}
\subsubsection[{encode\+Header(const H\+P\+A\+C\+K\+Header \&header)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode\+Header (
\begin{DoxyParamCaption}
\item[{const {\bf H\+P\+A\+C\+K\+Header} \&}]{header}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncoder_a2e353a1fa5dbb7b037de087d000303bd}


Definition at line 68 of file H\+P\+A\+C\+K\+Encoder.\+cpp.



References encode\+As\+Index(), encode\+As\+Literal(), proxygen\+::\+H\+P\+A\+C\+K\+Context\+::get\+Index(), proxygen\+::\+Header\+Indexing\+Strategy\+::index\+Header(), and proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+Base\+::indexing\+Strat\+\_\+.



Referenced by encode(), and set\+Header\+Table\+Size().


\begin{DoxyCode}
68                                                          \{
69   \textcolor{comment}{// First determine whether the header is defined as indexable using the}
70   \textcolor{comment}{// set strategy if applicable, else assume it is indexable}
71   \textcolor{keywordtype}{bool} indexable = !indexingStrat_ || indexingStrat_->indexHeader(header);
72 
73   \textcolor{comment}{// If the header was not defined as indexable, its a reasonable assumption}
74   \textcolor{comment}{// that it does not appear in either the static or dynamic table and should}
75   \textcolor{comment}{// not be searched.  The only time this is not true is if the header indexing}
76   \textcolor{comment}{// strat specified an exact header/value pair that is in the static header}
77   \textcolor{comment}{// table although semantically the header indexing strategy should indeed act}
78   \textcolor{comment}{// as an override so we assume this is desired if such a case occurs}
79   uint32\_t index = 0;
80   \textcolor{keywordflow}{if} (indexable) \{
81     index = getIndex(header);
82   \}
83 
84   \textcolor{comment}{// Finally encode the header as determined above}
85   \textcolor{keywordflow}{if} (index) \{
86     encodeAsIndex(index);
87   \} \textcolor{keywordflow}{else} \{
88     encodeAsLiteral(header, indexable);
89   \}
90 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}!encode\+Literal@{encode\+Literal}}
\index{encode\+Literal@{encode\+Literal}!proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}}
\subsubsection[{encode\+Literal(const H\+P\+A\+C\+K\+Header \&header, uint32\+\_\+t name\+Index, const H\+P\+A\+C\+K\+::\+Instruction \&instruction)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode\+Literal (
\begin{DoxyParamCaption}
\item[{const {\bf H\+P\+A\+C\+K\+Header} \&}]{header, }
\item[{uint32\+\_\+t}]{name\+Index, }
\item[{const {\bf H\+P\+A\+C\+K\+::\+Instruction} \&}]{instruction}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncoder_a83e93a93a2c75971d02d4e2ba0df8778}


Definition at line 48 of file H\+P\+A\+C\+K\+Encoder.\+cpp.



References proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Integer(), proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Literal(), proxygen\+::\+H\+P\+A\+C\+K\+Header\+Name\+::get(), proxygen\+::\+H\+P\+A\+C\+K\+Header\+::name, proxygen\+::\+H\+P\+A\+C\+K\+Context\+::name\+Index(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+Base\+::stream\+Buffer\+\_\+, and proxygen\+::\+H\+P\+A\+C\+K\+Header\+::value.



Referenced by encode\+As\+Literal(), and set\+Header\+Table\+Size().


\begin{DoxyCode}
50                                                                       \{
51   \textcolor{comment}{// name}
52   \textcolor{keywordflow}{if} (nameIndex) \{
53     VLOG(10) << \textcolor{stringliteral}{"encoding name index="} << nameIndex;
54     streamBuffer_.encodeInteger(nameIndex, instruction);
55   \} \textcolor{keywordflow}{else} \{
56     streamBuffer_.encodeInteger(0, instruction);
57     streamBuffer_.encodeLiteral(header.name.get());
58   \}
59   \textcolor{comment}{// value}
60   streamBuffer_.encodeLiteral(header.value);
61 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}!set\+Header\+Table\+Size@{set\+Header\+Table\+Size}}
\index{set\+Header\+Table\+Size@{set\+Header\+Table\+Size}!proxygen\+::\+H\+P\+A\+C\+K\+Encoder@{proxygen\+::\+H\+P\+A\+C\+K\+Encoder}}
\subsubsection[{set\+Header\+Table\+Size(uint32\+\_\+t size)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::set\+Header\+Table\+Size (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HPACKEncoder_a3695aaf69d00880b5fdc1795abeea02f}


Definition at line 35 of file H\+P\+A\+C\+K\+Encoder.\+h.



References encode\+As\+Index(), encode\+As\+Literal(), encode\+Header(), encode\+Literal(), proxygen\+::\+H\+P\+A\+C\+K\+Context\+::name\+Index(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+Base\+::set\+Header\+Table\+Size(), and proxygen\+::\+H\+P\+A\+C\+K\+Context\+::table\+\_\+.



Referenced by T\+E\+S\+T\+\_\+\+P().


\begin{DoxyCode}
35                                          \{
36     HPACKEncoderBase::setHeaderTableSize(table_, size);
37   \}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
proxygen/lib/http/codec/compress/{\bf H\+P\+A\+C\+K\+Encoder.\+h}\item 
proxygen/lib/http/codec/compress/{\bf H\+P\+A\+C\+K\+Encoder.\+cpp}\end{DoxyCompactItemize}
