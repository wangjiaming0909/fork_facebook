\section{proxygen\+:\+:Async\+Timeout\+Set\+:\+:Callback Class Reference}
\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback}\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}


{\ttfamily \#include $<$Async\+Timeout\+Set.\+h$>$}

Inheritance diagram for proxygen\+:\+:Async\+Timeout\+Set\+:\+:Callback\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classproxygen_1_1AsyncTimeoutSet_1_1Callback}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf Callback} ()
\item 
virtual {\bf $\sim$\+Callback} ()
\item 
virtual void {\bf timeout\+Expired} () noexcept=0
\item 
void {\bf cancel\+Timeout} ()
\item 
bool {\bf is\+Scheduled} () const 
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
std\+::chrono\+::milliseconds {\bf get\+Time\+Remaining} (std\+::chrono\+::milliseconds now) const 
\item 
void {\bf set\+Scheduled} ({\bf Async\+Timeout\+Set} $\ast$timeout\+Set, {\bf Callback} $\ast$prev)
\item 
void {\bf cancel\+Timeout\+Impl} ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::shared\+\_\+ptr$<$ folly\+::\+Request\+Context $>$ {\bf context\+\_\+}
\item 
{\bf Async\+Timeout\+Set} $\ast$ {\bf timeout\+Set\+\_\+} \{{\bf nullptr}\}
\item 
{\bf Callback} $\ast$ {\bf prev\+\_\+} \{{\bf nullptr}\}
\item 
{\bf Callback} $\ast$ {\bf next\+\_\+} \{{\bf nullptr}\}
\item 
std\+::chrono\+::milliseconds {\bf expiration\+\_\+} \{0\}
\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class {\bf Async\+Timeout\+Set}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
A callback to be notified when a timeout has expired.

\doxyref{Async\+Timeout\+Set\+::\+Callback}{p.}{classproxygen_1_1AsyncTimeoutSet_1_1Callback} is very similar to Async\+Timeout. The primary distinction is that Async\+Timeout can choose its timeout interval each time it is scheduled. On the other hand, \doxyref{Async\+Timeout\+Set\+::\+Callback}{p.}{classproxygen_1_1AsyncTimeoutSet_1_1Callback} always uses the timeout interval defined by the \doxyref{Async\+Timeout\+Set}{p.}{classproxygen_1_1AsyncTimeoutSet} where it is scheduled. 

Definition at line 54 of file Async\+Timeout\+Set.\+h.



\subsection{Constructor \& Destructor Documentation}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!Callback@{Callback}}
\index{Callback@{Callback}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{Callback()}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::\+Callback (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_ac0ac7ccbe0ee6e0e3a27744ad5da42cd}


Definition at line 56 of file Async\+Timeout\+Set.\+h.



References timeout\+Expired(), and $\sim$\+Callback().


\begin{DoxyCode}
56 \{\}
\end{DoxyCode}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!````~Callback@{$\sim$\+Callback}}
\index{````~Callback@{$\sim$\+Callback}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{$\sim$\+Callback()}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::$\sim$\+Callback (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a069f3316cecec4f325a97f2c38c3314e}


Definition at line 32 of file Async\+Timeout\+Set.\+cpp.



Referenced by Callback().


\begin{DoxyCode}
32                                    \{
33   \textcolor{keywordflow}{if} (isScheduled()) \{
34     cancelTimeout();
35   \}
36 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!cancel\+Timeout@{cancel\+Timeout}}
\index{cancel\+Timeout@{cancel\+Timeout}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{cancel\+Timeout()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::cancel\+Timeout (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_ae35ff9307fec26ba32d0e85a0b07ef9b}
Cancel the timeout, if it is running.

If the timeout is not scheduled, \doxyref{cancel\+Timeout()}{p.}{classproxygen_1_1AsyncTimeoutSet_1_1Callback_ae35ff9307fec26ba32d0e85a0b07ef9b} does nothing. 

Definition at line 70 of file Async\+Timeout\+Set.\+h.



References cancel\+Timeout\+Impl(), and timeout\+Set\+\_\+.



Referenced by proxygen\+::\+Async\+Timeout\+Set\+::schedule\+Timeout(), T\+E\+S\+T\+\_\+\+F(), and proxygen\+::\+Async\+Timeout\+Set\+::timeout\+Expired().


\begin{DoxyCode}
70                          \{
71       \textcolor{keywordflow}{if} (timeoutSet_ == \textcolor{keyword}{nullptr}) \{
72         \textcolor{comment}{// We're not scheduled, so there's nothing to do.}
73         \textcolor{keywordflow}{return};
74       \}
75       cancelTimeoutImpl();
76     \}
\end{DoxyCode}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!cancel\+Timeout\+Impl@{cancel\+Timeout\+Impl}}
\index{cancel\+Timeout\+Impl@{cancel\+Timeout\+Impl}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{cancel\+Timeout\+Impl()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::cancel\+Timeout\+Impl (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_ade8480096f82eaa0fa7af769ea58bec8}


Definition at line 52 of file Async\+Timeout\+Set.\+cpp.



References proxygen\+::\+Async\+Timeout\+Set\+::\+Async\+Timeout\+Set(), and proxygen\+::get\+Timeout\+Clock().



Referenced by cancel\+Timeout(), and get\+Time\+Remaining().


\begin{DoxyCode}
52                                                 \{
53   \textcolor{keywordflow}{if} (next_ == \textcolor{keyword}{nullptr}) \{
54     assert(timeoutSet_->tail_ == \textcolor{keyword}{this});
55     timeoutSet_->tail_ = prev_;
56   \} \textcolor{keywordflow}{else} \{
57     assert(timeoutSet_->tail_ != \textcolor{keyword}{this});
58     next_->prev_ = prev_;
59   \}
60 
61   \textcolor{keywordflow}{if} (prev_ == \textcolor{keyword}{nullptr}) \{
62     assert(timeoutSet_->head_ == \textcolor{keyword}{this});
63     timeoutSet_->head_ = next_;
64     timeoutSet_->headChanged();
65   \} \textcolor{keywordflow}{else} \{
66     assert(timeoutSet_->head_ != \textcolor{keyword}{this});
67     prev_->next_ = next_;
68   \}
69 
70   timeoutSet_ = \textcolor{keyword}{nullptr};
71   prev_ = \textcolor{keyword}{nullptr};
72   next_ = \textcolor{keyword}{nullptr};
73   expiration_ = \{\};
74 \}
\end{DoxyCode}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!get\+Time\+Remaining@{get\+Time\+Remaining}}
\index{get\+Time\+Remaining@{get\+Time\+Remaining}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{get\+Time\+Remaining(std\+::chrono\+::milliseconds now) const }]{\setlength{\rightskip}{0pt plus 5cm}std\+::chrono\+::milliseconds proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::get\+Time\+Remaining (
\begin{DoxyParamCaption}
\item[{std\+::chrono\+::milliseconds}]{now}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a1f3f31c99103709f658ce8b92d198f4e}


Definition at line 87 of file Async\+Timeout\+Set.\+h.



References cancel\+Timeout\+Impl(), expiration\+\_\+, and set\+Scheduled().


\begin{DoxyCode}
88                                        \{
89       \textcolor{keywordflow}{if} (now >= expiration_) \{
90         \textcolor{keywordflow}{return} std::chrono::milliseconds(0);
91       \}
92       \textcolor{keywordflow}{return} expiration_ - now;
93     \}
\end{DoxyCode}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!is\+Scheduled@{is\+Scheduled}}
\index{is\+Scheduled@{is\+Scheduled}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{is\+Scheduled() const }]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::is\+Scheduled (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_aabcf8d5c9236f58c456f8f8365b72fd0}
Return true if this timeout is currently scheduled, and false otherwise. 

Definition at line 81 of file Async\+Timeout\+Set.\+h.



References timeout\+Set\+\_\+.


\begin{DoxyCode}
81                              \{
82       \textcolor{keywordflow}{return} timeoutSet_ != \textcolor{keyword}{nullptr};
83     \}
\end{DoxyCode}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!set\+Scheduled@{set\+Scheduled}}
\index{set\+Scheduled@{set\+Scheduled}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{set\+Scheduled(\+Async\+Timeout\+Set $\ast$timeout\+Set, Callback $\ast$prev)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::set\+Scheduled (
\begin{DoxyParamCaption}
\item[{{\bf Async\+Timeout\+Set} $\ast$}]{timeout\+Set, }
\item[{{\bf Callback} $\ast$}]{prev}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a75d1242305382f91672fb8ff79393d47}


Definition at line 38 of file Async\+Timeout\+Set.\+cpp.



References proxygen\+::\+Async\+Timeout\+Set\+::\+Timeout\+Clock\+::milliseconds\+Since\+Epoch(), proxygen\+::\+Async\+Timeout\+Set\+::timeout\+Clock\+\_\+, and proxygen\+::time\+Point\+Initialized().



Referenced by get\+Time\+Remaining(), and proxygen\+::\+Async\+Timeout\+Set\+::schedule\+Timeout().


\begin{DoxyCode}
39                                                              \{
40   assert(timeoutSet_ == \textcolor{keyword}{nullptr});
41   assert(prev_ == \textcolor{keyword}{nullptr});
42   assert(next_ == \textcolor{keyword}{nullptr});
43   assert(!timePointInitialized(expiration_));
44 
45   timeoutSet_ = timeoutSet;
46   prev_ = prev;
47   next_ = \textcolor{keyword}{nullptr};
48   expiration_ = timeoutSet->timeoutClock\_.millisecondsSinceEpoch() +
49     timeoutSet_->getInterval();
50 \}
\end{DoxyCode}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!timeout\+Expired@{timeout\+Expired}}
\index{timeout\+Expired@{timeout\+Expired}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{timeout\+Expired() noexcept=0}]{\setlength{\rightskip}{0pt plus 5cm}virtual void proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::timeout\+Expired (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [pure virtual]}, {\ttfamily [noexcept]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a6c1534935d53209440d6b02c7a69e96c}
\doxyref{timeout\+Expired()}{p.}{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a6c1534935d53209440d6b02c7a69e96c} is invoked when the timeout has expired. 

Implemented in {\bf proxygen\+::\+Ack\+Timeout} \doxyref{}{p.}{classproxygen_1_1AckTimeout_a4e71983dc975851e4720f40d57a58308}, and {\bf Test\+Timeout} \doxyref{}{p.}{classTestTimeout_a66a85a8148ca75d881532948d8537df3}.



Referenced by Callback(), proxygen\+::\+Async\+Timeout\+Set\+::front(), and proxygen\+::\+Async\+Timeout\+Set\+::timeout\+Expired().



\subsection{Friends And Related Function Documentation}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!Async\+Timeout\+Set@{Async\+Timeout\+Set}}
\index{Async\+Timeout\+Set@{Async\+Timeout\+Set}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{Async\+Timeout\+Set}]{\setlength{\rightskip}{0pt plus 5cm}friend class {\bf Async\+Timeout\+Set}\hspace{0.3cm}{\ttfamily [friend]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a7b4aa3c9ceb8920cba3b903ae65d444f}


Definition at line 107 of file Async\+Timeout\+Set.\+h.



Referenced by proxygen\+::\+Async\+Timeout\+Set\+::front(), and proxygen\+::\+Async\+Timeout\+Set\+::\+Timeout\+Clock\+::$\sim$\+Timeout\+Clock().



\subsection{Member Data Documentation}
\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!context\+\_\+@{context\+\_\+}}
\index{context\+\_\+@{context\+\_\+}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{context\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}std\+::shared\+\_\+ptr$<$folly\+::\+Request\+Context$>$ proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::context\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a49a50f72d1e94f385d46d68768efb0ea}


Definition at line 98 of file Async\+Timeout\+Set.\+h.



Referenced by proxygen\+::\+Async\+Timeout\+Set\+::schedule\+Timeout(), and proxygen\+::\+Async\+Timeout\+Set\+::timeout\+Expired().

\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!expiration\+\_\+@{expiration\+\_\+}}
\index{expiration\+\_\+@{expiration\+\_\+}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{expiration\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}std\+::chrono\+::milliseconds proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::expiration\+\_\+ \{0\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a48ccbd0fd034f302c3aff538d52516a7}


Definition at line 103 of file Async\+Timeout\+Set.\+h.



Referenced by get\+Time\+Remaining().

\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!next\+\_\+@{next\+\_\+}}
\index{next\+\_\+@{next\+\_\+}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{next\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Callback}$\ast$ proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::next\+\_\+ \{{\bf nullptr}\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_aa87ca0fb3bd1c15ba444e79400e881ae}


Definition at line 102 of file Async\+Timeout\+Set.\+h.



Referenced by proxygen\+::\+Async\+Timeout\+Set\+::schedule\+Timeout().

\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!prev\+\_\+@{prev\+\_\+}}
\index{prev\+\_\+@{prev\+\_\+}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{prev\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Callback}$\ast$ proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::prev\+\_\+ \{{\bf nullptr}\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_acd9dbea7d0ab73fb26911d92d9817539}


Definition at line 101 of file Async\+Timeout\+Set.\+h.



Referenced by proxygen\+::\+Async\+Timeout\+Set\+::schedule\+Timeout().

\index{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}!timeout\+Set\+\_\+@{timeout\+Set\+\_\+}}
\index{timeout\+Set\+\_\+@{timeout\+Set\+\_\+}!proxygen\+::\+Async\+Timeout\+Set\+::\+Callback@{proxygen\+::\+Async\+Timeout\+Set\+::\+Callback}}
\subsubsection[{timeout\+Set\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Async\+Timeout\+Set}$\ast$ proxygen\+::\+Async\+Timeout\+Set\+::\+Callback\+::timeout\+Set\+\_\+ \{{\bf nullptr}\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1AsyncTimeoutSet_1_1Callback_a2171fde9e91d7c5a52fc59f2a8cdb69b}


Definition at line 100 of file Async\+Timeout\+Set.\+h.



Referenced by cancel\+Timeout(), and is\+Scheduled().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
proxygen/lib/utils/{\bf Async\+Timeout\+Set.\+h}\item 
proxygen/lib/utils/{\bf Async\+Timeout\+Set.\+cpp}\end{DoxyCompactItemize}
