\section{H\+T\+T\+P\+Downstream\+Test$<$ C $>$ Class Template Reference}
\label{classHTTPDownstreamTest}\index{H\+T\+T\+P\+Downstream\+Test$<$ C $>$@{H\+T\+T\+P\+Downstream\+Test$<$ C $>$}}
Inheritance diagram for H\+T\+T\+P\+Downstream\+Test$<$ C $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classHTTPDownstreamTest}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf H\+T\+T\+P\+Downstream\+Test} (std\+::vector$<$ int64\+\_\+t $>$ flow\+Control=\{-\/1,-\/1,-\/1\}, bool start\+Immediately=true)
\item 
{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf send\+Request} (const std\+::string \&url=\char`\"{}/\char`\"{}, int8\+\_\+t priority=0, bool eom=true)
\item 
{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf send\+Request} (const {\bf H\+T\+T\+P\+Message} \&req, bool eom=true)
\item 
{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf send\+Header} ()
\item 
Promise$<$ Unit $>$ {\bf send\+Request\+Later} ({\bf H\+T\+T\+P\+Message} req, bool eof=false)
\item 
void {\bf Set\+Up} () override
\item 
void {\bf cleanup} ()
\item 
std\+::unique\+\_\+ptr$<$ testing\+::\+Strict\+Mock$<$ {\bf Mock\+H\+T\+T\+P\+Handler} $>$ $>$ {\bf add\+Simple\+Strict\+Handler} ()
\item 
std\+::unique\+\_\+ptr$<$ testing\+::\+Nice\+Mock$<$ {\bf Mock\+H\+T\+T\+P\+Handler} $>$ $>$ {\bf add\+Simple\+Nice\+Handler} ()
\item 
void {\bf on\+E\+O\+M\+Terminate\+Handler\+Expect\+Shutdown} ({\bf Mock\+H\+T\+T\+P\+Handler} \&handler)
\item 
void {\bf expect\+Detach\+Session} ()
\item 
void {\bf add\+Single\+Byte\+Reads} (const char $\ast$data, milliseconds delay=\{\})
\item 
void {\bf flush\+Requests\+And\+Loop} (bool eof=false, milliseconds eof\+Delay=milliseconds(0), milliseconds initial\+Delay=milliseconds(0), std\+::function$<$ void()$>$ extra\+Events\+Fn=std\+::function$<$ void()$>$())
\item 
void {\bf flush\+Requests\+And\+LoopN} (uint64\+\_\+t n, bool eof=false, milliseconds eof\+Delay=milliseconds(0), milliseconds initial\+Delay=milliseconds(0), std\+::function$<$ void()$>$ extra\+Events\+Fn=std\+::function$<$ void()$>$())
\item 
void {\bf flush\+Requests} (bool eof=false, milliseconds eof\+Delay=milliseconds(0), milliseconds initial\+Delay=milliseconds(0), std\+::function$<$ void()$>$ extra\+Events\+Fn=std\+::function$<$ void()$>$())
\item 
void {\bf test\+Simple\+Upgrade} (const std\+::string \&upgrade\+Header, {\bf Codec\+Protocol} expected\+Protocol, const std\+::string \&expected\+Upgrade\+Header)
\item 
void {\bf graceful\+Shutdown} ()
\item 
void {\bf test\+Priorities} (uint32\+\_\+t num\+Priorities)
\item 
void {\bf test\+Chunks} (bool trailers)
\item 
void {\bf expect101} ({\bf Codec\+Protocol} expected\+Protocol, const std\+::string \&expected\+Upgrade, bool expect100=false)
\item 
void {\bf expect\+Response} (uint32\+\_\+t code=200, {\bf Error\+Code} error\+Code=Error\+Code\+::\+N\+O\+\_\+\+E\+R\+R\+OR, bool expect100=false, bool expect\+Goaway=false)
\item 
void {\bf expect\+Responses} (uint32\+\_\+t n, uint32\+\_\+t code=200, {\bf Error\+Code} error\+Code=Error\+Code\+::\+N\+O\+\_\+\+E\+R\+R\+OR, bool expect100=false, bool expect\+Goaway=false)
\item 
void {\bf parse\+Output} ({\bf H\+T\+T\+P\+Codec} \&client\+Codec)
\item 
void {\bf resume\+Writes\+In\+Loop} ()
\item 
void {\bf resume\+Writes\+After\+Delay} (milliseconds delay)
\item 
{\bf Mock\+Byte\+Event\+Tracker} $\ast$ {\bf set\+Mock\+Byte\+Event\+Tracker} ()
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
Event\+Base {\bf event\+Base\+\_\+}
\item 
{\bf Test\+Async\+Transport} $\ast$ {\bf transport\+\_\+}
\item 
folly\+::\+H\+H\+Wheel\+Timer\+::\+Unique\+Ptr {\bf transaction\+Timeouts\+\_\+}
\item 
std\+::vector$<$ int64\+\_\+t $>$ {\bf flow\+Control\+\_\+}
\item 
Strict\+Mock$<$ {\bf Mock\+Controller} $>$ {\bf mock\+Controller\+\_\+}
\item 
{\bf H\+T\+T\+P\+Downstream\+Session} $\ast$ {\bf http\+Session\+\_\+}
\item 
I\+O\+Buf\+Queue {\bf requests\+\_\+} \{I\+O\+Buf\+Queue\+::cache\+Chain\+Length()\}
\item 
unique\+\_\+ptr$<$ {\bf H\+T\+T\+P\+Codec} $>$ {\bf client\+Codec\+\_\+}
\item 
Nice\+Mock$<$ {\bf Mock\+H\+T\+T\+P\+Codec\+Callback} $>$ {\bf callbacks\+\_\+}
\item 
I\+O\+Buf\+Queue {\bf parse\+Output\+Stream\+\_\+} \{I\+O\+Buf\+Queue\+::cache\+Chain\+Length()\}
\item 
bool {\bf break\+Parse\+Output\+\_\+} \{false\}
\item 
C\+::\+Codec $\ast$ {\bf raw\+Codec\+\_\+} \{{\bf nullptr}\}
\item 
{\bf Header\+Indexing\+Strategy} {\bf test\+H2\+Indexing\+Strat\+\_\+}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$typename C$>$\\*
class H\+T\+T\+P\+Downstream\+Test$<$ C $>$}



Definition at line 44 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.



\subsection{Constructor \& Destructor Documentation}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{H\+T\+T\+P\+Downstream\+Test(std\+::vector$<$ int64\+\_\+t $>$ flow\+Control=\lcurly{}-\/1,-\/1,-\/1\rcurly{}, bool start\+Immediately=true)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::{\bf H\+T\+T\+P\+Downstream\+Test} (
\begin{DoxyParamCaption}
\item[{std\+::vector$<$ int64\+\_\+t $>$}]{flow\+Control = {\ttfamily \{~-\/1,~-\/1,~-\/1~\}}, }
\item[{bool}]{start\+Immediately = {\ttfamily true}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}\label{classHTTPDownstreamTest_a602d4e3eab6691730f1c91342a0cb092}


Definition at line 46 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
47                                      \{ -1, -1, -1 \},
48     \textcolor{keywordtype}{bool} startImmediately = \textcolor{keyword}{true})
49     : eventBase_(),
50       transport_(\textcolor{keyword}{new} TestAsyncTransport(&eventBase_)),
51       transactionTimeouts_(makeTimeoutSet(&eventBase_)),
52       flowControl_(flowControl) \{
53     EXPECT\_CALL(mockController_, getGracefulShutdownTimeout())
54       .WillRepeatedly(Return(std::chrono::milliseconds(0)));
55     EXPECT\_CALL(mockController_, attachSession(\_))
56       .WillRepeatedly(Invoke([&] (HTTPSessionBase* session) \{
57         session->setPrioritySampled(\textcolor{keyword}{true});
58       \}));
59     HTTPSession::setDefaultReadBufferLimit(65536);
60     \textcolor{keyword}{auto} codec = makeServerCodec<typename C::Codec>(C::version);
61     rawCodec_ = codec.get();
62 
63     \textcolor{comment}{// If the codec is H2, getHeaderIndexingStrategy will be called when setting}
64     \textcolor{comment}{// up the codec}
65     \textcolor{keywordflow}{if} (rawCodec\_->getProtocol() == CodecProtocol::HTTP\_2) \{
66       EXPECT\_CALL(mockController_, getHeaderIndexingStrategy())
67         .WillOnce(
68           Return(&testH2IndexingStrat_)
69       );
70     \}
71 
72     httpSession_ = \textcolor{keyword}{new} HTTPDownstreamSession(
73       transactionTimeouts_.get(),
74       std::move(AsyncTransportWrapper::UniquePtr(transport_)),
75       localAddr, peerAddr,
76       &mockController_,
77       std::move(codec),
78       mockTransportInfo \textcolor{comment}{/* no stats for now */},
79       \textcolor{keyword}{nullptr});
80     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& param: flowControl) \{
81       \textcolor{keywordflow}{if} (param < 0) \{
82         param = rawCodec\_->getDefaultWindowSize();
83       \}
84     \}
85 
86     \textcolor{comment}{// Ensure the H2 header indexing strategy was setup correctly if applicable}
87     \textcolor{keywordflow}{if} (rawCodec\_->getProtocol() == CodecProtocol::HTTP\_2) \{
88       HTTP2Codec* recastedCodec = \textcolor{keyword}{dynamic\_cast<}HTTP2Codec*\textcolor{keyword}{>}(rawCodec_);
89       EXPECT\_EQ(
90         recastedCodec->getHeaderIndexingStrategy(), &testH2IndexingStrat_);
91     \}
92 
93     httpSession_->setFlowControl(flowControl[0], flowControl[1],
94                                  flowControl[2]);
95     httpSession_->setEgressSettings(\{\{ SettingsId::MAX\_CONCURRENT\_STREAMS, 80 \},
96                                      \{ SettingsId::HEADER\_TABLE\_SIZE, 5555 \},
97                                      \{ SettingsId::ENABLE\_PUSH, 1 \},
98                                      \{ SettingsId::ENABLE\_EX\_HEADERS, 1 \}\});
99     \textcolor{keywordflow}{if} (startImmediately) \{
100       httpSession_->startNow();
101     \}
102     clientCodec_ = makeClientCodec<typename C::Codec>(C::version);
103     \textcolor{keywordflow}{if} (clientCodec_->getProtocol() == CodecProtocol::HTTP\_2) \{
104       clientCodec_->getEgressSettings()->setSetting(
105         SettingsId::ENABLE\_EX\_HEADERS, 1);
106     \}
107     clientCodec_->generateConnectionPreface(requests_);
108     clientCodec_->setCallback(&callbacks_);
109   \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!add\+Simple\+Nice\+Handler@{add\+Simple\+Nice\+Handler}}
\index{add\+Simple\+Nice\+Handler@{add\+Simple\+Nice\+Handler}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{add\+Simple\+Nice\+Handler()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ std\+::unique\+\_\+ptr$<$testing\+::\+Nice\+Mock$<${\bf Mock\+H\+T\+T\+P\+Handler}$>$ $>$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::add\+Simple\+Nice\+Handler (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a3114c5718f2c5f6eb188d2aa409b339f}


Definition at line 173 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
173                          \{
174     std::unique\_ptr<testing::NiceMock<MockHTTPHandler>> handler =
175       std::make\_unique<testing::NiceMock<MockHTTPHandler>>();
176 
177     \textcolor{comment}{// See comment above}
178     \textcolor{keyword}{auto} rawHandler = handler.get();
179     EXPECT\_CALL(mockController_, getRequestHandler(testing::\_, testing::\_))
180       .WillOnce(testing::Return(rawHandler))
181       .RetiresOnSaturation();
182 
183     EXPECT\_CALL(*handler, setTransaction(testing::\_))
184       .WillOnce(testing::SaveArg<0>(&handler->txn\_));
185 
186     \textcolor{keywordflow}{return} handler;
187   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!add\+Simple\+Strict\+Handler@{add\+Simple\+Strict\+Handler}}
\index{add\+Simple\+Strict\+Handler@{add\+Simple\+Strict\+Handler}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{add\+Simple\+Strict\+Handler()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ std\+::unique\+\_\+ptr$<$testing\+::\+Strict\+Mock$<${\bf Mock\+H\+T\+T\+P\+Handler}$>$ $>$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::add\+Simple\+Strict\+Handler (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a15ca5ec8573e07ff4ec9aaec3812be41}


Definition at line 155 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
155                            \{
156     std::unique\_ptr<testing::StrictMock<MockHTTPHandler>> handler =
157       std::make\_unique<testing::StrictMock<MockHTTPHandler>>();
158 
159     \textcolor{comment}{// The ownership model here is suspect, but assume the callers won't destroy}
160     \textcolor{comment}{// handler before it's requested}
161     \textcolor{keyword}{auto} rawHandler = handler.get();
162     EXPECT\_CALL(mockController_, getRequestHandler(testing::\_, testing::\_))
163       .WillOnce(testing::Return(rawHandler))
164       .RetiresOnSaturation();
165 
166     EXPECT\_CALL(*handler, setTransaction(testing::\_))
167       .WillOnce(testing::SaveArg<0>(&handler->txn\_));
168 
169     \textcolor{keywordflow}{return} handler;
170   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!add\+Single\+Byte\+Reads@{add\+Single\+Byte\+Reads}}
\index{add\+Single\+Byte\+Reads@{add\+Single\+Byte\+Reads}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{add\+Single\+Byte\+Reads(const char $\ast$data, milliseconds delay=\lcurly{}\rcurly{})}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::add\+Single\+Byte\+Reads (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{data, }
\item[{milliseconds}]{delay = {\ttfamily \{\}}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a5c361b0f34907d7a945ed309a3161cd8}


Definition at line 199 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
199                                                                \{\}) \{
200     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keywordtype}{char}* p = data; *p != \textcolor{charliteral}{'\(\backslash\)0'}; ++p) \{
201       transport_->addReadEvent(p, 1, delay);
202     \}
203   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!cleanup@{cleanup}}
\index{cleanup@{cleanup}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{cleanup()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::cleanup (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a3c6421d5b6f4d9d77c4624c5f20248dd}


Definition at line 148 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
148                  \{
149     EXPECT\_CALL(mockController_, detachSession(\_));
150     httpSession_->dropConnection();
151   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!expect101@{expect101}}
\index{expect101@{expect101}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{expect101(\+Codec\+Protocol expected\+Protocol, const std\+::string \&expected\+Upgrade, bool expect100=false)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::expect101 (
\begin{DoxyParamCaption}
\item[{{\bf Codec\+Protocol}}]{expected\+Protocol, }
\item[{const std\+::string \&}]{expected\+Upgrade, }
\item[{bool}]{expect100 = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_af6838fb25be29dd31a7ad8b7fe1fadee}


Definition at line 253 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
255                                          \{
256     NiceMock<MockHTTPCodecCallback> callbacks;
257 
258     EXPECT\_CALL(callbacks, onMessageBegin(\_, \_));
259     EXPECT\_CALL(callbacks, onNativeProtocolUpgrade(\_, \_, \_, \_))
260       .WillOnce(
261         Invoke([\textcolor{keyword}{this}, expectedUpgrade] (HTTPCodec::StreamID,
262                                         CodecProtocol,
263                                         \textcolor{keyword}{const} std::string&,
264                                         HTTPMessage& msg) \{
265              EXPECT\_EQ(msg.getStatusCode(), 101);
266              EXPECT\_EQ(msg.getStatusMessage(), \textcolor{stringliteral}{"Switching Protocols"});
267              EXPECT\_EQ(msg.getHeaders().getSingleOrEmpty(HTTP\_HEADER\_UPGRADE),
268                        expectedUpgrade);
269              \textcolor{comment}{// also connection and date}
270              EXPECT\_EQ(msg.getHeaders().size(), 3);
271              breakParseOutput_ = \textcolor{keyword}{true};
272              \textcolor{keywordflow}{return} \textcolor{keyword}{true};
273                \}));
274     \textcolor{comment}{// this comes before 101, but due to gmock this is backwards}
275     \textcolor{keywordflow}{if} (expect100) \{
276       EXPECT\_CALL(callbacks, onMessageBegin(\_, \_))
277         .RetiresOnSaturation();
278       EXPECT\_CALL(callbacks, onHeadersComplete(\_, \_))
279         .WillOnce(Invoke([] (HTTPCodec::StreamID,
280                              std::shared\_ptr<HTTPMessage> msg) \{
281                  LOG(INFO) << \textcolor{stringliteral}{"100 headers"};
282                  EXPECT\_EQ(msg->getStatusCode(), 100);
283                          \}))
284         .RetiresOnSaturation();
285       EXPECT\_CALL(callbacks, onMessageComplete(\_, \_))
286         .RetiresOnSaturation();
287     \}
288     clientCodec_->setCallback(&callbacks);
289     parseOutput(*clientCodec_);
290     clientCodec_ = HTTPCodecFactory::getCodec(expectedProtocol,
291                                               TransportDirection::UPSTREAM);
292   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!expect\+Detach\+Session@{expect\+Detach\+Session}}
\index{expect\+Detach\+Session@{expect\+Detach\+Session}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{expect\+Detach\+Session()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::expect\+Detach\+Session (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a48d8bc32715ea1c587abab3714232c78}


Definition at line 195 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
195                              \{
196     EXPECT\_CALL(mockController_, detachSession(testing::\_));
197   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!expect\+Response@{expect\+Response}}
\index{expect\+Response@{expect\+Response}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{expect\+Response(uint32\+\_\+t code=200, Error\+Code error\+Code=\+Error\+Code\+::\+N\+O\+\_\+\+E\+R\+R\+O\+R, bool expect100=false, bool expect\+Goaway=false)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::expect\+Response (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{code = {\ttfamily 200}, }
\item[{{\bf Error\+Code}}]{error\+Code = {\ttfamily ErrorCode\+:\+:NO\+\_\+ERROR}, }
\item[{bool}]{expect100 = {\ttfamily false}, }
\item[{bool}]{expect\+Goaway = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_aec2d1282f50936c6e661ea21fa9e182c}


Definition at line 293 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
295                                                                          \{
296     expectResponses(1, code, errorCode, expect100, expectGoaway);
297   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!expect\+Responses@{expect\+Responses}}
\index{expect\+Responses@{expect\+Responses}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{expect\+Responses(uint32\+\_\+t n, uint32\+\_\+t code=200, Error\+Code error\+Code=\+Error\+Code\+::\+N\+O\+\_\+\+E\+R\+R\+O\+R, bool expect100=false, bool expect\+Goaway=false)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::expect\+Responses (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{n, }
\item[{uint32\+\_\+t}]{code = {\ttfamily 200}, }
\item[{{\bf Error\+Code}}]{error\+Code = {\ttfamily ErrorCode\+:\+:NO\+\_\+ERROR}, }
\item[{bool}]{expect100 = {\ttfamily false}, }
\item[{bool}]{expect\+Goaway = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a0c6f26a3f77028aa03bd9f844ee3e741}


Definition at line 298 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
300                                                                           \{
301     clientCodec_->setCallback(&callbacks_);
302     \textcolor{keywordflow}{if} (isParallelCodecProtocol(clientCodec_->getProtocol())) \{
303       EXPECT\_CALL(callbacks_, onSettings(\_))
304         .WillOnce(Invoke([\textcolor{keyword}{this}] (\textcolor{keyword}{const} SettingsList& settings) \{
305               \textcolor{keywordflow}{if} (flowControl_[0] > 0) \{
306                 \textcolor{keywordtype}{bool} foundInitialWindow = \textcolor{keyword}{false};
307                 \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& setting: settings) \{
308                   \textcolor{keywordflow}{if} (setting.id == SettingsId::INITIAL\_WINDOW\_SIZE) \{
309                     EXPECT\_EQ(flowControl\_[0], setting.value);
310                     foundInitialWindow = true;
311                   \}
312                 \}
313                 EXPECT\_TRUE(foundInitialWindow);
314               \}
315             \}));
316     \}
317     \textcolor{keywordflow}{if} (flowControl_[2] > 0) \{
318       int64\_t sessionDelta =
319         flowControl_[2] - clientCodec_->getDefaultWindowSize();
320       \textcolor{keywordflow}{if} (clientCodec_->supportsSessionFlowControl() && sessionDelta) \{
321         EXPECT\_CALL(callbacks_, onWindowUpdate(0, sessionDelta));
322       \}
323     \}
324     \textcolor{keywordflow}{if} (flowControl_[1] > 0) \{
325       \textcolor{keywordtype}{size\_t} initWindow = flowControl_[0] > 0 ?
326         flowControl_[0] : clientCodec_->getDefaultWindowSize();
327       int64\_t streamDelta = flowControl_[1] - initWindow;
328       \textcolor{keywordflow}{if} (clientCodec_->supportsStreamFlowControl() && streamDelta) \{
329         EXPECT\_CALL(callbacks_, onWindowUpdate(1, streamDelta));
330       \}
331     \}
332 
333     \textcolor{keywordflow}{if} (expectGoaway) \{
334       EXPECT\_CALL(callbacks_, onGoaway(HTTPCodec::StreamID(1),
335                                       ErrorCode::NO\_ERROR, \_));
336     \}
337 
338     \textcolor{keywordflow}{for} (uint32\_t i = 0; i < n; i++) \{
339       uint8\_t times = (expect100) ? 2 : 1;
340       EXPECT\_CALL(callbacks_, onMessageBegin(\_, \_))
341         .Times(times).RetiresOnSaturation();
342       EXPECT\_CALL(callbacks_, onHeadersComplete(\_, \_))
343         .WillOnce(Invoke([code] (HTTPCodec::StreamID,
344                                  std::shared\_ptr<HTTPMessage> msg) \{
345                            EXPECT\_EQ(msg->getStatusCode(), code);
346                          \}));
347       \textcolor{keywordflow}{if} (expect100) \{
348         EXPECT\_CALL(callbacks_, onHeadersComplete(\_, \_))
349           .WillOnce(Invoke([] (HTTPCodec::StreamID,
350                                std::shared\_ptr<HTTPMessage> msg) \{
351                              EXPECT\_EQ(msg->getStatusCode(), 100);
352                            \}))
353           .RetiresOnSaturation();
354       \}
355       \textcolor{keywordflow}{if} (errorCode != ErrorCode::NO\_ERROR) \{
356         EXPECT\_CALL(callbacks_, onAbort(\_, \_))
357           .WillOnce(Invoke([errorCode] (HTTPCodec::StreamID,
358                                         ErrorCode error) \{
359                              EXPECT\_EQ(error, errorCode);
360                          \}));
361       \}
362       EXPECT\_CALL(callbacks_, onBody(\_, \_, \_)).RetiresOnSaturation();
363       EXPECT\_CALL(callbacks_, onMessageComplete(\_, \_)).RetiresOnSaturation();
364     \}
365     parseOutput(*clientCodec_);
366   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!flush\+Requests@{flush\+Requests}}
\index{flush\+Requests@{flush\+Requests}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{flush\+Requests(bool eof=false, milliseconds eof\+Delay=milliseconds(0), milliseconds initial\+Delay=milliseconds(0), std\+::function$<$ void()$>$ extra\+Events\+Fn=std\+::function$<$ void()$>$())}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::flush\+Requests (
\begin{DoxyParamCaption}
\item[{bool}]{eof = {\ttfamily false}, }
\item[{milliseconds}]{eof\+Delay = {\ttfamily milliseconds(0)}, }
\item[{milliseconds}]{initial\+Delay = {\ttfamily milliseconds(0)}, }
\item[{std\+::function$<$ void()$>$}]{extra\+Events\+Fn = {\ttfamily std\+:\+:function$<$void()$>$()}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_ab8976962121af33c3caf0bc9ccfb11a1}


Definition at line 223 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
226                                                                \{
227     transport_->addReadEvent(requests_, initialDelay);
228     \textcolor{keywordflow}{if} (extraEventsFn) \{
229       extraEventsFn();
230     \}
231     \textcolor{keywordflow}{if} (eof) \{
232       transport_->addReadEOF(eofDelay);
233     \}
234     transport_->startReadEvents();
235   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!flush\+Requests\+And\+Loop@{flush\+Requests\+And\+Loop}}
\index{flush\+Requests\+And\+Loop@{flush\+Requests\+And\+Loop}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{flush\+Requests\+And\+Loop(bool eof=false, milliseconds eof\+Delay=milliseconds(0), milliseconds initial\+Delay=milliseconds(0), std\+::function$<$ void()$>$ extra\+Events\+Fn=std\+::function$<$ void()$>$())}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::flush\+Requests\+And\+Loop (
\begin{DoxyParamCaption}
\item[{bool}]{eof = {\ttfamily false}, }
\item[{milliseconds}]{eof\+Delay = {\ttfamily milliseconds(0)}, }
\item[{milliseconds}]{initial\+Delay = {\ttfamily milliseconds(0)}, }
\item[{std\+::function$<$ void()$>$}]{extra\+Events\+Fn = {\ttfamily std\+:\+:function$<$void()$>$()}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_ac883526b2d777a4e131abafd7b998483}


Definition at line 205 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
208                                                                \{
209     flushRequests(eof, eofDelay, initialDelay, extraEventsFn);
210     eventBase_.loop();
211   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!flush\+Requests\+And\+LoopN@{flush\+Requests\+And\+LoopN}}
\index{flush\+Requests\+And\+LoopN@{flush\+Requests\+And\+LoopN}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{flush\+Requests\+And\+Loop\+N(uint64\+\_\+t n, bool eof=false, milliseconds eof\+Delay=milliseconds(0), milliseconds initial\+Delay=milliseconds(0), std\+::function$<$ void()$>$ extra\+Events\+Fn=std\+::function$<$ void()$>$())}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::flush\+Requests\+And\+LoopN (
\begin{DoxyParamCaption}
\item[{uint64\+\_\+t}]{n, }
\item[{bool}]{eof = {\ttfamily false}, }
\item[{milliseconds}]{eof\+Delay = {\ttfamily milliseconds(0)}, }
\item[{milliseconds}]{initial\+Delay = {\ttfamily milliseconds(0)}, }
\item[{std\+::function$<$ void()$>$}]{extra\+Events\+Fn = {\ttfamily std\+:\+:function$<$void()$>$()}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a973662f8c90cfa6516feea2cbe9f0304}


Definition at line 213 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
216                                                                \{
217     flushRequests(eof, eofDelay, initialDelay, extraEventsFn);
218     \textcolor{keywordflow}{for} (uint64\_t i = 0; i < n; i++) \{
219       eventBase_.loopOnce();
220     \}
221   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!graceful\+Shutdown@{graceful\+Shutdown}}
\index{graceful\+Shutdown@{graceful\+Shutdown}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{graceful\+Shutdown()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::graceful\+Shutdown (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_ab03e22df6023ae6b74736af956be93a1}


Definition at line 242 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
242                           \{
243     folly::DelayedDestruction::DestructorGuard g(httpSession_);
244     clientCodec_->generateGoaway(this->requests_, 0, ErrorCode::NO\_ERROR);
245     expectDetachSession();
246     flushRequestsAndLoop(\textcolor{keyword}{true});
247   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!on\+E\+O\+M\+Terminate\+Handler\+Expect\+Shutdown@{on\+E\+O\+M\+Terminate\+Handler\+Expect\+Shutdown}}
\index{on\+E\+O\+M\+Terminate\+Handler\+Expect\+Shutdown@{on\+E\+O\+M\+Terminate\+Handler\+Expect\+Shutdown}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{on\+E\+O\+M\+Terminate\+Handler\+Expect\+Shutdown(\+Mock\+H\+T\+T\+P\+Handler \&handler)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::on\+E\+O\+M\+Terminate\+Handler\+Expect\+Shutdown (
\begin{DoxyParamCaption}
\item[{{\bf Mock\+H\+T\+T\+P\+Handler} \&}]{handler}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a9469020a4dbd46bc15e5132a05e1d935}


Definition at line 189 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
189                                                                      \{
190     handler.expectEOM([&] \{ handler.terminate(); \});
191     handler.expectDetachTransaction();
192     expectDetachSession();
193   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!parse\+Output@{parse\+Output}}
\index{parse\+Output@{parse\+Output}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{parse\+Output(\+H\+T\+T\+P\+Codec \&client\+Codec)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::parse\+Output (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P\+Codec} \&}]{client\+Codec}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_aa800294f65d254f30aea9fa906ff407b}


Definition at line 368 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
368                                            \{
369     \textcolor{keyword}{auto} writeEvents = transport_->getWriteEvents();
370     \textcolor{keywordflow}{while} (!breakParseOutput_ &&
371            (!writeEvents->empty() || !parseOutputStream_.empty())) \{
372       \textcolor{keywordflow}{if} (!writeEvents->empty()) \{
373         \textcolor{keyword}{auto} \textcolor{keyword}{event} = writeEvents->front();
374         \textcolor{keyword}{auto} vec = \textcolor{keyword}{event}->getIoVec();
375         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \textcolor{keyword}{event}->getCount(); i++) \{
376           parseOutputStream_.append(
377             IOBuf::copyBuffer(vec[i].iov\_base, vec[i].iov\_len));
378         \}
379         writeEvents->pop\_front();
380       \}
381       uint32\_t consumed = clientCodec.onIngress(*parseOutputStream_.front());
382       parseOutputStream_.split(consumed);
383     \}
384     \textcolor{keywordflow}{if} (!breakParseOutput_) \{
385       EXPECT\_EQ(parseOutputStream_.chainLength(), 0);
386     \}
387     breakParseOutput_ = \textcolor{keyword}{false};
388   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!resume\+Writes\+After\+Delay@{resume\+Writes\+After\+Delay}}
\index{resume\+Writes\+After\+Delay@{resume\+Writes\+After\+Delay}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{resume\+Writes\+After\+Delay(milliseconds delay)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::resume\+Writes\+After\+Delay (
\begin{DoxyParamCaption}
\item[{milliseconds}]{delay}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a46c58f43ceea76591517372823c41636}


Definition at line 394 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
394                                                   \{
395     eventBase_.runAfterDelay([\textcolor{keyword}{this}] \{ transport_->resumeWrites(); \},
396                              delay.count());
397   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!resume\+Writes\+In\+Loop@{resume\+Writes\+In\+Loop}}
\index{resume\+Writes\+In\+Loop@{resume\+Writes\+In\+Loop}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{resume\+Writes\+In\+Loop()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::resume\+Writes\+In\+Loop (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a208b25dcd27143e557dafe7ec2803a61}


Definition at line 390 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
390                             \{
391     eventBase_.runInLoop([\textcolor{keyword}{this}] \{ transport_->resumeWrites(); \});
392   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!send\+Header@{send\+Header}}
\index{send\+Header@{send\+Header}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{send\+Header()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ {\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::send\+Header (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a7de657b63c7b09c0d6ca8fc221c7a792}


Definition at line 126 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
126                                  \{
127     \textcolor{keywordflow}{return} sendRequest(\textcolor{stringliteral}{"/"}, 0, \textcolor{keyword}{false});
128   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!send\+Request@{send\+Request}}
\index{send\+Request@{send\+Request}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{send\+Request(const std\+::string \&url=""/"", int8\+\_\+t priority=0, bool eom=true)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ {\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::send\+Request (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{url = {\ttfamily \char`\"{}/\char`\"{}}, }
\item[{int8\+\_\+t}]{priority = {\ttfamily 0}, }
\item[{bool}]{eom = {\ttfamily true}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a14b4b86f26d2504888fca13ba2d69044}


Definition at line 111 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
113                                                    \{
114     \textcolor{keyword}{auto} req = getGetRequest();
115     req.setURL(url);
116     req.setPriority(priority);
117     \textcolor{keywordflow}{return} sendRequest(req, eom);
118   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!send\+Request@{send\+Request}}
\index{send\+Request@{send\+Request}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{send\+Request(const H\+T\+T\+P\+Message \&req, bool eom=true)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ {\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::send\+Request (
\begin{DoxyParamCaption}
\item[{const {\bf H\+T\+T\+P\+Message} \&}]{req, }
\item[{bool}]{eom = {\ttfamily true}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_a51344e68e702f00023df7dae96f65820}


Definition at line 120 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
120                                                                          \{
121     \textcolor{keyword}{auto} streamID = clientCodec_->createStream();
122     clientCodec_->generateHeader(requests_, streamID, req, eom);
123     \textcolor{keywordflow}{return} streamID;
124   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!send\+Request\+Later@{send\+Request\+Later}}
\index{send\+Request\+Later@{send\+Request\+Later}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{send\+Request\+Later(\+H\+T\+T\+P\+Message req, bool eof=false)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ Promise$<$Unit$>$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::send\+Request\+Later (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P\+Message}}]{req, }
\item[{bool}]{eof = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_ad7af80b6a258ea7a54f63f79cc05dcaf}


Definition at line 130 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
130                                                                   \{
131     Promise<Unit> reqp;
132     reqp.getFuture().then(&eventBase_, [=] \{
133         sendRequest(req);
134         transport_->addReadEvent(requests_, milliseconds(0));
135         \textcolor{keywordflow}{if} (eof) \{
136           transport_->addReadEOF(milliseconds(0));
137         \}
138       \});
139     \textcolor{keywordflow}{return} reqp;
140   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!set\+Mock\+Byte\+Event\+Tracker@{set\+Mock\+Byte\+Event\+Tracker}}
\index{set\+Mock\+Byte\+Event\+Tracker@{set\+Mock\+Byte\+Event\+Tracker}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{set\+Mock\+Byte\+Event\+Tracker()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ {\bf Mock\+Byte\+Event\+Tracker}$\ast$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::set\+Mock\+Byte\+Event\+Tracker (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classHTTPDownstreamTest_af3949ce20921419c3e82b4fecb661dca}


Definition at line 399 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
399                                                   \{
400     \textcolor{keyword}{auto} byteEventTracker = \textcolor{keyword}{new} MockByteEventTracker(\textcolor{keyword}{nullptr});
401     httpSession_->setByteEventTracker(
402       std::unique\_ptr<ByteEventTracker>(byteEventTracker));
403     EXPECT\_CALL(*byteEventTracker, preSend(\_, \_, \_))
404       .WillRepeatedly(Return(0));
405     EXPECT\_CALL(*byteEventTracker, drainByteEvents())
406       .WillRepeatedly(Return(0));
407     EXPECT\_CALL(*byteEventTracker, processByteEvents(\_, \_))
408       .WillRepeatedly(Invoke([]
409                              (std::shared\_ptr<ByteEventTracker> \textcolor{keyword}{self},
410                               uint64\_t bytesWritten) \{
411                                \textcolor{keywordflow}{return} \textcolor{keyword}{self}->ByteEventTracker::processByteEvents(
412                                  \textcolor{keyword}{self},
413                                  bytesWritten);
414                              \}));
415 
416     \textcolor{keywordflow}{return} byteEventTracker;
417   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!Set\+Up@{Set\+Up}}
\index{Set\+Up@{Set\+Up}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{Set\+Up() override}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::Set\+Up (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}\label{classHTTPDownstreamTest_ac9f3e052750dc7fc9e318df114efae10}


Definition at line 142 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
142                         \{
143     folly::EventBaseManager::get()->clearEventBase();
144     HTTPSession::setDefaultWriteBufferLimit(65536);
145     HTTP2PriorityQueue::setNodeLifetime(std::chrono::milliseconds(2));
146   \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!test\+Chunks@{test\+Chunks}}
\index{test\+Chunks@{test\+Chunks}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{test\+Chunks(bool trailers)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class C $>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::test\+Chunks (
\begin{DoxyParamCaption}
\item[{bool}]{trailers}
\end{DoxyParamCaption}
)}\label{classHTTPDownstreamTest_a2e1e673d970f37f78dcb5c4a5522c40a}


Definition at line 1369 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
1369                                                     \{
1370   InSequence enforceOrder;
1371 
1372   \textcolor{keyword}{auto} handler = addSimpleStrictHandler();
1373   handler->expectHeaders();
1374   handler->expectEOM([&handler, trailers] () \{
1375       handler->sendChunkedReplyWithBody(200, 100, 17, trailers);
1376     \});
1377   handler->expectDetachTransaction();
1378 
1379   HTTPSession::DestructorGuard g(httpSession_);
1380   sendRequest();
1381   flushRequestsAndLoop(\textcolor{keyword}{true}, milliseconds(0));
1382 
1383   EXPECT\_CALL(callbacks_, onMessageBegin(1, \_))
1384     .Times(1);
1385   EXPECT\_CALL(callbacks_, onHeadersComplete(1, \_))
1386     .Times(1);
1387   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 6; i++) \{
1388     EXPECT\_CALL(callbacks_, onChunkHeader(1, \_));
1389     EXPECT\_CALL(callbacks_, onBody(1, \_, \_));
1390     EXPECT\_CALL(callbacks_, onChunkComplete(1));
1391   \}
1392   \textcolor{keywordflow}{if} (trailers) \{
1393     EXPECT\_CALL(callbacks_, onTrailersComplete(1, \_));
1394   \}
1395   EXPECT\_CALL(callbacks_, onMessageComplete(1, \_));
1396 
1397   parseOutput(*clientCodec_);
1398   expectDetachSession();
1399 \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!test\+Priorities@{test\+Priorities}}
\index{test\+Priorities@{test\+Priorities}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{test\+Priorities(uint32\+\_\+t num\+Priorities)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class C $>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::test\+Priorities (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{num\+Priorities}
\end{DoxyParamCaption}
)}\label{classHTTPDownstreamTest_a00b692ddacca59cd6de1c0526467b1a0}


Definition at line 2174 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.


\begin{DoxyCode}
2174                                                                  \{
2175   uint32\_t iterations = 10;
2176   uint32\_t maxPriority = numPriorities - 1;
2177   std::vector<std::unique\_ptr<testing::NiceMock<MockHTTPHandler>>> handlers;
2178   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} pri = numPriorities - 1; pri >= 0; pri--) \{
2179     \textcolor{keywordflow}{for} (uint32\_t i = 0; i < iterations; i++) \{
2180       sendRequest(\textcolor{stringliteral}{"/"}, pri * (8 / numPriorities));
2181       InSequence handlerSequence;
2182       \textcolor{keyword}{auto} handler = addSimpleNiceHandler();
2183       \textcolor{keyword}{auto} rawHandler = handler.get();
2184       handlers.push\_back(std::move(handler));
2185       rawHandler->expectHeaders();
2186       rawHandler->expectEOM([rawHandler] \{
2187           rawHandler->sendReplyWithBody(200, 1000);
2188         \});
2189       rawHandler->expectDetachTransaction([] \{  \});
2190     \}
2191   \}
2192 
2193   \textcolor{keyword}{auto} buf = requests_.move();
2194   buf->coalesce();
2195   requests_.append(std::move(buf));
2196 
2197   flushRequestsAndLoop();
2198 
2199   std::list<HTTPCodec::StreamID> streams;
2200   EXPECT\_CALL(callbacks_, onMessageBegin(\_, \_))
2201     .Times(iterations * numPriorities);
2202   EXPECT\_CALL(callbacks_, onHeadersComplete(\_, \_))
2203     .Times(iterations * numPriorities);
2204   \textcolor{comment}{// body is variable and hence ignored}
2205   EXPECT\_CALL(callbacks_, onMessageComplete(\_, \_))
2206       .Times(iterations * numPriorities)
2207       .WillRepeatedly(Invoke([&](HTTPCodec::StreamID stream, \textcolor{keywordtype}{bool} \textcolor{comment}{/*upgrade*/}) \{
2208         streams.push\_back(stream);
2209       \}));
2210 
2211   parseOutput(*clientCodec_);
2212 
2213   \textcolor{comment}{// transactions finish in priority order (higher streamIDs first)}
2214   EXPECT\_EQ(streams.size(), iterations * numPriorities);
2215   \textcolor{keyword}{auto} txn = streams.begin();
2216   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} band = maxPriority; band >= 0; band--) \{
2217     \textcolor{keyword}{auto} upperID = iterations * 2 * (band + 1);
2218     \textcolor{keyword}{auto} lowerID = iterations * 2 * band;
2219     \textcolor{keywordflow}{for} (uint32\_t i = 0; i < iterations; i++) \{
2220       EXPECT\_LE(lowerID, (uint32\_t)*txn);
2221       EXPECT\_GE(upperID, (uint32\_t)*txn);
2222       ++txn;
2223     \}
2224   \}
2225 \}
\end{DoxyCode}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!test\+Simple\+Upgrade@{test\+Simple\+Upgrade}}
\index{test\+Simple\+Upgrade@{test\+Simple\+Upgrade}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{test\+Simple\+Upgrade(const std\+::string \&upgrade\+Header, Codec\+Protocol expected\+Protocol, const std\+::string \&expected\+Upgrade\+Header)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class C $>$ void {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::test\+Simple\+Upgrade (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{upgrade\+Header, }
\item[{{\bf Codec\+Protocol}}]{expected\+Protocol, }
\item[{const std\+::string \&}]{expected\+Upgrade\+Header}
\end{DoxyParamCaption}
)}\label{classHTTPDownstreamTest_ab700c063a3227a6ac1752fb13ee99e48}


Definition at line 1868 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.



References proxygen\+::\+H\+T\+T\+P2\+Codec\+::get\+Header\+Indexing\+Strategy(), proxygen\+::get\+Upgrade\+Request(), and proxygen\+::http2\+::k\+Protocol\+Cleartext\+String.


\begin{DoxyCode}
1871                                           \{
1872   this->rawCodec_->setAllowedUpgradeProtocols(\{expectedUpgradeHeader\});
1873 
1874   \textcolor{keyword}{auto} handler = addSimpleStrictHandler();
1875 
1876   HeaderIndexingStrategy testH2IndexingStrat;
1877   handler->expectHeaders();
1878   EXPECT\_CALL(mockController_, onSessionCodecChange(httpSession_));
1879   handler->expectEOM(
1880     [&handler, expectedProtocol, expectedUpgradeHeader, &testH2IndexingStrat] \{
1881       EXPECT\_FALSE(handler->txn\_->getSetupTransportInfo().secure);
1882       EXPECT\_EQ(*handler->txn\_->getSetupTransportInfo().appProtocol,
1883                 expectedUpgradeHeader);
1884       \textcolor{keywordflow}{if} (expectedProtocol == CodecProtocol::HTTP\_2) \{
1885         \textcolor{keyword}{const} HTTP2Codec* codec = \textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const }HTTP2Codec*\textcolor{keyword}{>}(
1886           &handler->txn\_->getTransport().getCodec());
1887         ASSERT\_NE(codec, \textcolor{keyword}{nullptr});
1888         EXPECT\_EQ(codec->getHeaderIndexingStrategy(), &testH2IndexingStrat);
1889       \}
1890       handler->sendReplyWithBody(200, 100);
1891     \});
1892   handler->expectDetachTransaction();
1893 
1894   \textcolor{keywordflow}{if} (expectedProtocol == CodecProtocol::HTTP\_2) \{
1895     EXPECT\_CALL(mockController_, getHeaderIndexingStrategy())
1896       .WillOnce(
1897         Return(&testH2IndexingStrat)
1898     );
1899   \}
1900 
1901   HTTPMessage req = getUpgradeRequest(upgradeHeader);
1902   \textcolor{keywordflow}{if} (upgradeHeader == http2::kProtocolCleartextString) \{
1903     HTTP2Codec::requestUpgrade(req);
1904   \}
1905   sendRequest(req);
1906   flushRequestsAndLoop();
1907 
1908   expect101(expectedProtocol, expectedUpgradeHeader);
1909   expectResponse();
1910 
1911   gracefulShutdown();
1912 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!break\+Parse\+Output\+\_\+@{break\+Parse\+Output\+\_\+}}
\index{break\+Parse\+Output\+\_\+@{break\+Parse\+Output\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{break\+Parse\+Output\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ bool {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::break\+Parse\+Output\+\_\+ \{false\}\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_ab1a0c2dbbc7f2f60fc446417b28eb559}


Definition at line 430 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!callbacks\+\_\+@{callbacks\+\_\+}}
\index{callbacks\+\_\+@{callbacks\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{callbacks\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ Nice\+Mock$<${\bf Mock\+H\+T\+T\+P\+Codec\+Callback}$>$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::callbacks\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_a8985275878cd904b62ca6611e19a40ab}


Definition at line 428 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!client\+Codec\+\_\+@{client\+Codec\+\_\+}}
\index{client\+Codec\+\_\+@{client\+Codec\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{client\+Codec\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ unique\+\_\+ptr$<${\bf H\+T\+T\+P\+Codec}$>$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::client\+Codec\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_a36aee26f5b8dde672ff089fec7224ed8}


Definition at line 427 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!event\+Base\+\_\+@{event\+Base\+\_\+}}
\index{event\+Base\+\_\+@{event\+Base\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{event\+Base\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ Event\+Base {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::event\+Base\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_ac46b07afb5858b8e9f61a3f2fedd71f5}


Definition at line 420 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!flow\+Control\+\_\+@{flow\+Control\+\_\+}}
\index{flow\+Control\+\_\+@{flow\+Control\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{flow\+Control\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ std\+::vector$<$int64\+\_\+t$>$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::flow\+Control\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_ae1a64adb2ce35eb25406ec7ee75f7692}


Definition at line 423 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!http\+Session\+\_\+@{http\+Session\+\_\+}}
\index{http\+Session\+\_\+@{http\+Session\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{http\+Session\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ {\bf H\+T\+T\+P\+Downstream\+Session}$\ast$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::http\+Session\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_abad1dfcfd461476fa7e36c2246206672}


Definition at line 425 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!mock\+Controller\+\_\+@{mock\+Controller\+\_\+}}
\index{mock\+Controller\+\_\+@{mock\+Controller\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{mock\+Controller\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ Strict\+Mock$<${\bf Mock\+Controller}$>$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::mock\+Controller\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_aebc16f384387328455eaf6979cee35f9}


Definition at line 424 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!parse\+Output\+Stream\+\_\+@{parse\+Output\+Stream\+\_\+}}
\index{parse\+Output\+Stream\+\_\+@{parse\+Output\+Stream\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{parse\+Output\+Stream\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ I\+O\+Buf\+Queue {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::parse\+Output\+Stream\+\_\+ \{I\+O\+Buf\+Queue\+::cache\+Chain\+Length()\}\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_a0d929e4489f4e8374d7d543d972bc42e}


Definition at line 429 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!raw\+Codec\+\_\+@{raw\+Codec\+\_\+}}
\index{raw\+Codec\+\_\+@{raw\+Codec\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{raw\+Codec\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ C\+::\+Codec$\ast$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::raw\+Codec\+\_\+ \{{\bf nullptr}\}\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_a385606fbd6451c9cedf3b74675d46dd3}


Definition at line 431 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!requests\+\_\+@{requests\+\_\+}}
\index{requests\+\_\+@{requests\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{requests\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ I\+O\+Buf\+Queue {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::requests\+\_\+ \{I\+O\+Buf\+Queue\+::cache\+Chain\+Length()\}\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_a03190a599b98f1d6691dca31fb303d28}


Definition at line 426 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!test\+H2\+Indexing\+Strat\+\_\+@{test\+H2\+Indexing\+Strat\+\_\+}}
\index{test\+H2\+Indexing\+Strat\+\_\+@{test\+H2\+Indexing\+Strat\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{test\+H2\+Indexing\+Strat\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ {\bf Header\+Indexing\+Strategy} {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::test\+H2\+Indexing\+Strat\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_a0a392c199fd91632e7fee519fca15423}


Definition at line 432 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!transaction\+Timeouts\+\_\+@{transaction\+Timeouts\+\_\+}}
\index{transaction\+Timeouts\+\_\+@{transaction\+Timeouts\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{transaction\+Timeouts\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ folly\+::\+H\+H\+Wheel\+Timer\+::\+Unique\+Ptr {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::transaction\+Timeouts\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_a795ecf7e745d3067b28adc343f904360}


Definition at line 422 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.

\index{H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}!transport\+\_\+@{transport\+\_\+}}
\index{transport\+\_\+@{transport\+\_\+}!H\+T\+T\+P\+Downstream\+Test@{H\+T\+T\+P\+Downstream\+Test}}
\subsubsection[{transport\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename C$>$ {\bf Test\+Async\+Transport}$\ast$ {\bf H\+T\+T\+P\+Downstream\+Test}$<$ C $>$\+::transport\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}\label{classHTTPDownstreamTest_ab44b1edf6354c86649b1354696b36f68}


Definition at line 421 of file H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
proxygen/lib/http/session/test/{\bf H\+T\+T\+P\+Downstream\+Session\+Test.\+cpp}\end{DoxyCompactItemize}
