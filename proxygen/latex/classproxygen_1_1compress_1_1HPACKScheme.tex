\section{proxygen\+:\+:compress\+:\+:H\+P\+A\+C\+K\+Scheme Class Reference}
\label{classproxygen_1_1compress_1_1HPACKScheme}\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}


{\ttfamily \#include $<$H\+P\+A\+C\+K\+Scheme.\+h$>$}

Inheritance diagram for proxygen\+:\+:compress\+:\+:H\+P\+A\+C\+K\+Scheme\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classproxygen_1_1compress_1_1HPACKScheme}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf H\+P\+A\+C\+K\+Scheme} ({\bf Compression\+Simulator} $\ast$sim, uint32\+\_\+t table\+Size)
\item 
{\bf $\sim$\+H\+P\+A\+C\+K\+Scheme} ()
\item 
std\+::unique\+\_\+ptr$<$ {\bf Ack} $>$ {\bf get\+Ack} (uint16\+\_\+t) override
\item 
void {\bf recv\+Ack} (std\+::unique\+\_\+ptr$<$ {\bf Ack} $>$) override
\item 
std\+::pair$<$ {\bf Frame\+Flags}, std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$ $>$ {\bf encode} (bool, std\+::vector$<$ {\bf compress\+::\+Header} $>$ all\+Headers, {\bf Sim\+Stats} \&stats) override
\item 
void {\bf decode} ({\bf Frame\+Flags} {\bf flags}, std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$ encoded\+Req, {\bf Sim\+Stats} \&stats, {\bf Sim\+Streaming\+Callback} \&callback) override
\item 
uint32\+\_\+t {\bf get\+Hol\+Block\+Count} () const override
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
{\bf H\+P\+A\+C\+K\+Codec} {\bf client\+\_\+} \{{\bf Transport\+Direction\+::\+U\+P\+S\+T\+R\+E\+AM}\}
\item 
{\bf H\+P\+A\+C\+K\+Codec} {\bf server\+\_\+} \{{\bf Transport\+Direction\+::\+D\+O\+W\+N\+S\+T\+R\+E\+AM}\}
\item 
{\bf H\+P\+A\+C\+K\+Queue} {\bf server\+Queue\+\_\+} \{{\bf server\+\_\+}\}
\item 
bool {\bf allow\+O\+O\+O\+\_\+} \{false\}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
Compression scheme for \doxyref{H\+P\+A\+CK}{p.}{namespaceproxygen_1_1HPACK} with a prepended sequence number 

Definition at line 22 of file H\+P\+A\+C\+K\+Scheme.\+h.



\subsection{Constructor \& Destructor Documentation}
\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!H\+P\+A\+C\+K\+Scheme@{H\+P\+A\+C\+K\+Scheme}}
\index{H\+P\+A\+C\+K\+Scheme@{H\+P\+A\+C\+K\+Scheme}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{H\+P\+A\+C\+K\+Scheme(\+Compression\+Simulator $\ast$sim, uint32\+\_\+t table\+Size)}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::\+H\+P\+A\+C\+K\+Scheme (
\begin{DoxyParamCaption}
\item[{{\bf Compression\+Simulator} $\ast$}]{sim, }
\item[{uint32\+\_\+t}]{table\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}\label{classproxygen_1_1compress_1_1HPACKScheme_a7d34fa2a0bbe69476c4639b3cb2570a1}


Definition at line 24 of file H\+P\+A\+C\+K\+Scheme.\+h.



References allow\+O\+O\+O\+\_\+, client\+\_\+, proxygen\+::\+No\+Path\+Indexing\+Strategy\+::get\+Instance(), server\+\_\+, proxygen\+::\+H\+P\+A\+C\+K\+Codec\+::set\+Decoder\+Header\+Table\+Max\+Size(), proxygen\+::\+Header\+Codec\+::set\+Encode\+Headroom(), proxygen\+::\+H\+P\+A\+C\+K\+Codec\+::set\+Encoder\+Header\+Table\+Size(), and proxygen\+::\+H\+P\+A\+C\+K\+Codec\+::set\+Header\+Indexing\+Strategy().


\begin{DoxyCode}
25       : CompressionScheme(sim) \{
26     client_.setEncodeHeadroom(2);
27     client_.setHeaderIndexingStrategy(NoPathIndexingStrategy::getInstance());
28     server_.setHeaderIndexingStrategy(NoPathIndexingStrategy::getInstance());
29     client_.setEncoderHeaderTableSize(tableSize);
30     server_.setDecoderHeaderTableMaxSize(tableSize);
31     allowOOO_ = (tableSize == 0);
32   \}
\end{DoxyCode}
\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!````~H\+P\+A\+C\+K\+Scheme@{$\sim$\+H\+P\+A\+C\+K\+Scheme}}
\index{````~H\+P\+A\+C\+K\+Scheme@{$\sim$\+H\+P\+A\+C\+K\+Scheme}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{$\sim$\+H\+P\+A\+C\+K\+Scheme()}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::$\sim$\+H\+P\+A\+C\+K\+Scheme (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1compress_1_1HPACKScheme_a40e49a31c1497c4d50732110a4afd61e}


Definition at line 34 of file H\+P\+A\+C\+K\+Scheme.\+h.



References proxygen\+::\+H\+P\+A\+C\+K\+Queue\+::get\+Queued\+Bytes(), and server\+Queue\+\_\+.


\begin{DoxyCode}
34                  \{
35     CHECK\_EQ(serverQueue_.getQueuedBytes(), 0);
36   \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!decode@{decode}}
\index{decode@{decode}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{decode(\+Frame\+Flags flags, std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$ encoded\+Req, Sim\+Stats \&stats, Sim\+Streaming\+Callback \&callback) override}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::decode (
\begin{DoxyParamCaption}
\item[{{\bf Frame\+Flags}}]{flags, }
\item[{std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$}]{encoded\+Req, }
\item[{{\bf Sim\+Stats} \&}]{stats, }
\item[{{\bf Sim\+Streaming\+Callback} \&}]{callback}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}\label{classproxygen_1_1compress_1_1HPACKScheme_a7180bb82bbc7fd4119aad297344306ce}


Implements {\bf proxygen\+::compress\+::\+Compression\+Scheme} \doxyref{}{p.}{classproxygen_1_1compress_1_1CompressionScheme_ac5ddabc82889df4797e1e869dc32e4e2}.



Definition at line 60 of file H\+P\+A\+C\+K\+Scheme.\+h.



References proxygen\+::compress\+::\+Frame\+Flags\+::allow\+O\+OO, proxygen\+::\+H\+P\+A\+C\+K\+Queue\+::enqueue\+Header\+Block(), proxygen\+::\+H\+P\+A\+C\+K\+Queue\+::get\+Queued\+Bytes(), proxygen\+::compress\+::\+Sim\+Stats\+::max\+Queue\+Buffer\+Bytes, proxygen\+::compress\+::\+Sim\+Streaming\+Callback\+::maybe\+Mark\+Hol\+Delay(), proxygen\+::compress\+::\+Sim\+Streaming\+Callback\+::request\+Index, proxygen\+::compress\+::\+Sim\+Streaming\+Callback\+::seqn, and server\+Queue\+\_\+.


\begin{DoxyCode}
63                                                        \{
64     folly::io::Cursor cursor(encodedReq.get());
65     \textcolor{keyword}{auto} seqn = cursor.readBE<uint16\_t>();
66     callback.seqn = seqn;
67     VLOG(1) << \textcolor{stringliteral}{"Decoding request="} << callback.requestIndex
68             << \textcolor{stringliteral}{" header seqn="} << seqn;
69     \textcolor{keyword}{auto} len = cursor.totalLength();
70     encodedReq->trimStart(\textcolor{keyword}{sizeof}(uint16\_t));
71     serverQueue_.enqueueHeaderBlock(
72         seqn, std::move(encodedReq), len, &callback, flags.allowOOO);
73     callback.maybeMarkHolDelay();
74     \textcolor{keywordflow}{if} (serverQueue_.getQueuedBytes() > stats.maxQueueBufferBytes) \{
75       stats.maxQueueBufferBytes = serverQueue_.getQueuedBytes();
76     \}
77   \}
\end{DoxyCode}
\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!encode@{encode}}
\index{encode@{encode}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{encode(bool, std\+::vector$<$ compress\+::\+Header $>$ all\+Headers, Sim\+Stats \&stats) override}]{\setlength{\rightskip}{0pt plus 5cm}std\+::pair$<${\bf Frame\+Flags}, std\+::unique\+\_\+ptr$<$folly\+::\+I\+O\+Buf$>$ $>$ proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::encode (
\begin{DoxyParamCaption}
\item[{bool}]{, }
\item[{std\+::vector$<$ {\bf compress\+::\+Header} $>$}]{all\+Headers, }
\item[{{\bf Sim\+Stats} \&}]{stats}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}\label{classproxygen_1_1compress_1_1HPACKScheme_aafa09cb0b8847355ebb099ffc44e794f}


Implements {\bf proxygen\+::compress\+::\+Compression\+Scheme} \doxyref{}{p.}{classproxygen_1_1compress_1_1CompressionScheme_a4e013945112c438374a2cb99eb753d67}.



Definition at line 45 of file H\+P\+A\+C\+K\+Scheme.\+h.



References allow\+O\+O\+O\+\_\+, client\+\_\+, proxygen\+::compress\+::\+Sim\+Stats\+::compressed, proxygen\+::\+H\+P\+A\+C\+K\+Codec\+::encode(), proxygen\+::\+Header\+Codec\+::get\+Encoded\+Size(), proxygen\+::compress\+::\+Compression\+Scheme\+::index, and proxygen\+::compress\+::\+Sim\+Stats\+::uncompressed.


\begin{DoxyCode}
48                                 \{
49     \textcolor{keyword}{auto} block = client_.encode(allHeaders);
50     block->prepend(\textcolor{keyword}{sizeof}(uint16\_t));
51     folly::io::RWPrivateCursor c(block.get());
52     c.writeBE<uint16\_t>(index++);
53     stats.uncompressed += client_.getEncodedSize().uncompressed;
54     stats.compressed += client_.getEncodedSize().compressed;
55     \textcolor{comment}{// OOO is allowed with 0 table size}
56     FrameFlags flags\{allowOOO_\};
57     \textcolor{keywordflow}{return} \{flags, std::move(block)\};
58   \}
\end{DoxyCode}
\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!get\+Ack@{get\+Ack}}
\index{get\+Ack@{get\+Ack}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{get\+Ack(uint16\+\_\+t) override}]{\setlength{\rightskip}{0pt plus 5cm}std\+::unique\+\_\+ptr$<${\bf Ack}$>$ proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::get\+Ack (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}\label{classproxygen_1_1compress_1_1HPACKScheme_a82816e8390863439eca18e01ff65c7b5}


Implements {\bf proxygen\+::compress\+::\+Compression\+Scheme} \doxyref{}{p.}{classproxygen_1_1compress_1_1CompressionScheme_af8a906f3f6600f903a3f8249478f9ea6}.



Definition at line 39 of file H\+P\+A\+C\+K\+Scheme.\+h.


\begin{DoxyCode}
39                                                  \{
40     \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};
41   \}
\end{DoxyCode}
\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!get\+Hol\+Block\+Count@{get\+Hol\+Block\+Count}}
\index{get\+Hol\+Block\+Count@{get\+Hol\+Block\+Count}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{get\+Hol\+Block\+Count() const override}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::get\+Hol\+Block\+Count (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}\label{classproxygen_1_1compress_1_1HPACKScheme_a7f72f561fdb655de2a57437fc961a33d}


Implements {\bf proxygen\+::compress\+::\+Compression\+Scheme} \doxyref{}{p.}{classproxygen_1_1compress_1_1CompressionScheme_a08043930336620a278f3763256384a38}.



Definition at line 79 of file H\+P\+A\+C\+K\+Scheme.\+h.



References proxygen\+::\+H\+P\+A\+C\+K\+Queue\+::get\+Hol\+Block\+Count(), and server\+Queue\+\_\+.


\begin{DoxyCode}
79                                              \{
80     \textcolor{keywordflow}{return} serverQueue_.getHolBlockCount();
81   \}
\end{DoxyCode}
\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!recv\+Ack@{recv\+Ack}}
\index{recv\+Ack@{recv\+Ack}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{recv\+Ack(std\+::unique\+\_\+ptr$<$ Ack $>$) override}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::recv\+Ack (
\begin{DoxyParamCaption}
\item[{std\+::unique\+\_\+ptr$<$ {\bf Ack} $>$}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}\label{classproxygen_1_1compress_1_1HPACKScheme_a80a8a4f5c57f4aa3436a4d1eede0f90a}


Implements {\bf proxygen\+::compress\+::\+Compression\+Scheme} \doxyref{}{p.}{classproxygen_1_1compress_1_1CompressionScheme_a8b5b9dbfd8f08e0dfdc6415e7432ddbf}.



Definition at line 42 of file H\+P\+A\+C\+K\+Scheme.\+h.


\begin{DoxyCode}
42                                               \{
43   \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!allow\+O\+O\+O\+\_\+@{allow\+O\+O\+O\+\_\+}}
\index{allow\+O\+O\+O\+\_\+@{allow\+O\+O\+O\+\_\+}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{allow\+O\+O\+O\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::allow\+O\+O\+O\+\_\+ \{false\}}\label{classproxygen_1_1compress_1_1HPACKScheme_ac39b90a15a3a3d371704b978e6e7dc9e}


Definition at line 86 of file H\+P\+A\+C\+K\+Scheme.\+h.



Referenced by encode(), and H\+P\+A\+C\+K\+Scheme().

\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!client\+\_\+@{client\+\_\+}}
\index{client\+\_\+@{client\+\_\+}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{client\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+P\+A\+C\+K\+Codec} proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::client\+\_\+ \{{\bf Transport\+Direction\+::\+U\+P\+S\+T\+R\+E\+AM}\}}\label{classproxygen_1_1compress_1_1HPACKScheme_ad505e1a5f730c6510475d0479ef2d8be}


Definition at line 83 of file H\+P\+A\+C\+K\+Scheme.\+h.



Referenced by encode(), and H\+P\+A\+C\+K\+Scheme().

\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!server\+\_\+@{server\+\_\+}}
\index{server\+\_\+@{server\+\_\+}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{server\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+P\+A\+C\+K\+Codec} proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::server\+\_\+ \{{\bf Transport\+Direction\+::\+D\+O\+W\+N\+S\+T\+R\+E\+AM}\}}\label{classproxygen_1_1compress_1_1HPACKScheme_a52de977fa597240a7db4967c59110328}


Definition at line 84 of file H\+P\+A\+C\+K\+Scheme.\+h.



Referenced by H\+P\+A\+C\+K\+Scheme().

\index{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}!server\+Queue\+\_\+@{server\+Queue\+\_\+}}
\index{server\+Queue\+\_\+@{server\+Queue\+\_\+}!proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme@{proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme}}
\subsubsection[{server\+Queue\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+P\+A\+C\+K\+Queue} proxygen\+::compress\+::\+H\+P\+A\+C\+K\+Scheme\+::server\+Queue\+\_\+ \{{\bf server\+\_\+}\}}\label{classproxygen_1_1compress_1_1HPACKScheme_aee2746867a60458aa6c558a9ab2f4634}


Definition at line 85 of file H\+P\+A\+C\+K\+Scheme.\+h.



Referenced by decode(), get\+Hol\+Block\+Count(), and $\sim$\+H\+P\+A\+C\+K\+Scheme().



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
proxygen/lib/http/codec/compress/experimental/simulator/{\bf H\+P\+A\+C\+K\+Scheme.\+h}\end{DoxyCompactItemize}
