\section{proxygen/lib/http/codec/compress/experimental/simulator/\+Main.cpp File Reference}
\label{Main_8cpp}\index{proxygen/lib/http/codec/compress/experimental/simulator/\+Main.\+cpp@{proxygen/lib/http/codec/compress/experimental/simulator/\+Main.\+cpp}}
{\ttfamily \#include $<$folly/init/\+Init.\+h$>$}\\*
{\ttfamily \#include $<$folly/portability/\+G\+Flags.\+h$>$}\\*
{\ttfamily \#include \char`\"{}proxygen/lib/http/codec/compress/experimental/simulator/\+Compression\+Simulator.\+h\char`\"{}}\\*
{\ttfamily \#include $<$proxygen/lib/http/codec/compress/\+H\+P\+A\+C\+K\+Encoder.\+h$>$}\\*
{\ttfamily \#include $<$proxygen/lib/http/codec/compress/\+H\+P\+A\+C\+K\+Header.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+string} (input,\char`\"{}\char`\"{},\char`\"{}File containing {\bf requests}\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+string} (scheme,\char`\"{}qpack\char`\"{},\char`\"{}Scheme\+: $<$qpack$\vert$qmin$\vert$hpack$>$\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+int32} (rtt, 100,\char`\"{}Simulated {\bf R\+TT}\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+double} (lossp, 0.\+0,\char`\"{}Loss Probability\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+double} (delayp, 0.\+05,\char`\"{}Delay Probability\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+int32} (delay, 100,\char`\"{}Max extra delay\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+int32} (ooo\+\_\+thresh, 0,\char`\"{}First seqn to allow ooo\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+int32} (table\+\_\+size, 4096,\char`\"{}H\+P\+A\+CK dynamic table size\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+int64} (seed, 0,\char`\"{}R\+NG seed\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+bool} (blend, true,\char`\"{}Blend all facebook.\+com and fbcdn.\+net domains\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+int32} (max\+\_\+blocking, 100,\char`\"{}Maximum number of vulnerable/blocking header blocks\char`\"{})
\item 
{\bf D\+E\+F\+I\+N\+E\+\_\+bool} (same\+\_\+packet\+\_\+compression, true,\char`\"{}Allow Q\+P\+A\+CK to compress across \char`\"{}\char`\"{}headers the same packet\char`\"{})
\item 
int {\bf main} (int argc, char $\ast$argv[$\,$])
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+bool@{D\+E\+F\+I\+N\+E\+\_\+bool}}
\index{D\+E\+F\+I\+N\+E\+\_\+bool@{D\+E\+F\+I\+N\+E\+\_\+bool}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+bool(blend, true,""Blend all facebook.\+com and fbcdn.\+net domains"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+bool (
\begin{DoxyParamCaption}
\item[{blend}]{, }
\item[{true}]{, }
\item[{\char`\"{}Blend all facebook.\+com and fbcdn.\+net domains\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a86ac24e5feff1318de763da8c20d18e4}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+bool@{D\+E\+F\+I\+N\+E\+\_\+bool}}
\index{D\+E\+F\+I\+N\+E\+\_\+bool@{D\+E\+F\+I\+N\+E\+\_\+bool}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+bool(same\+\_\+packet\+\_\+compression, true,""Allow Q\+P\+A\+C\+K to compress across """"headers the same packet"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+bool (
\begin{DoxyParamCaption}
\item[{same\+\_\+packet\+\_\+compression}]{, }
\item[{true}]{, }
\item[{\char`\"{}Allow Q\+P\+A\+CK to compress across \char`\"{}\char`\"{}headers the same packet\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a5ca9b2421562c7609f8f2eb43cd4d649}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+double@{D\+E\+F\+I\+N\+E\+\_\+double}}
\index{D\+E\+F\+I\+N\+E\+\_\+double@{D\+E\+F\+I\+N\+E\+\_\+double}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+double(lossp, 0.\+0,""Loss Probability"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+double (
\begin{DoxyParamCaption}
\item[{lossp}]{, }
\item[{0.}]{0, }
\item[{\char`\"{}Loss Probability\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a49b8aaf53cb97ca0e7df1b3c718e2c66}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+double@{D\+E\+F\+I\+N\+E\+\_\+double}}
\index{D\+E\+F\+I\+N\+E\+\_\+double@{D\+E\+F\+I\+N\+E\+\_\+double}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+double(delayp, 0.\+05,""Delay Probability"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+double (
\begin{DoxyParamCaption}
\item[{delayp}]{, }
\item[{0.}]{05, }
\item[{\char`\"{}Delay Probability\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a3bbefe660221e7b372ba51937e095c56}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}}
\index{D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+int32(rtt, 100,""Simulated R\+TT"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+int32 (
\begin{DoxyParamCaption}
\item[{rtt}]{, }
\item[{100}]{, }
\item[{\char`\"{}Simulated {\bf R\+TT}\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a17fb47fc24d040f2781ad4021a5c3ad1}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}}
\index{D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+int32(delay, 100,""Max extra delay"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+int32 (
\begin{DoxyParamCaption}
\item[{delay}]{, }
\item[{100}]{, }
\item[{\char`\"{}Max extra delay\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_ac13c61d9c82aa72c4ea1a1e182341df9}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}}
\index{D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+int32(ooo\+\_\+thresh, 0,""First seqn to allow ooo"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+int32 (
\begin{DoxyParamCaption}
\item[{ooo\+\_\+thresh}]{, }
\item[{0}]{, }
\item[{\char`\"{}First seqn to allow ooo\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a7779a5ea5e375b7b4e9fc5c19b638d01}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}}
\index{D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+int32(table\+\_\+size, 4096,""H\+P\+A\+C\+K dynamic table size"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+int32 (
\begin{DoxyParamCaption}
\item[{table\+\_\+size}]{, }
\item[{4096}]{, }
\item[{\char`\"{}H\+P\+A\+CK dynamic table size\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a4b2ef0ffc674c01c8b13ce6e321ceb42}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}}
\index{D\+E\+F\+I\+N\+E\+\_\+int32@{D\+E\+F\+I\+N\+E\+\_\+int32}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+int32(max\+\_\+blocking, 100,""Maximum number of vulnerable/blocking header blocks"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+int32 (
\begin{DoxyParamCaption}
\item[{max\+\_\+blocking}]{, }
\item[{100}]{, }
\item[{\char`\"{}Maximum number of vulnerable/blocking header blocks\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_ab8a0857d23c5baf978500573f1eadd5f}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+int64@{D\+E\+F\+I\+N\+E\+\_\+int64}}
\index{D\+E\+F\+I\+N\+E\+\_\+int64@{D\+E\+F\+I\+N\+E\+\_\+int64}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+int64(seed, 0,""R\+N\+G seed"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+int64 (
\begin{DoxyParamCaption}
\item[{seed}]{, }
\item[{0}]{, }
\item[{\char`\"{}R\+NG seed\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_acdfadb0b1d69f93b2c6bfd34fafce6e6}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+string@{D\+E\+F\+I\+N\+E\+\_\+string}}
\index{D\+E\+F\+I\+N\+E\+\_\+string@{D\+E\+F\+I\+N\+E\+\_\+string}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+string(input,"""",""File containing requests"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+string (
\begin{DoxyParamCaption}
\item[{input}]{, }
\item[{\char`\"{}\char`\"{}}]{, }
\item[{\char`\"{}File containing {\bf requests}\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_ae9581d68522a9838d1771ea498226f21}
\index{Main.\+cpp@{Main.\+cpp}!D\+E\+F\+I\+N\+E\+\_\+string@{D\+E\+F\+I\+N\+E\+\_\+string}}
\index{D\+E\+F\+I\+N\+E\+\_\+string@{D\+E\+F\+I\+N\+E\+\_\+string}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{D\+E\+F\+I\+N\+E\+\_\+string(scheme,""qpack"",""Scheme\+: $<$qpack\texttt{"|}qmin\texttt{"|}hpack$>$"")}]{\setlength{\rightskip}{0pt plus 5cm}D\+E\+F\+I\+N\+E\+\_\+string (
\begin{DoxyParamCaption}
\item[{scheme}]{, }
\item[{\char`\"{}qpack\char`\"{}}]{, }
\item[{\char`\"{}Scheme\+: $<$qpack$\vert$qmin$\vert$hpack$>$\char`\"{}}]{}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a32006cac6e2f7bd8f7d35bffa61e4021}
\index{Main.\+cpp@{Main.\+cpp}!main@{main}}
\index{main@{main}!Main.\+cpp@{Main.\+cpp}}
\subsubsection[{main(int argc, char $\ast$argv[])}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv[$\,$]}
\end{DoxyParamCaption}
)}\label{Main_8cpp_a0ddf1224851353fc92bfbff6f499fa97}


Definition at line 39 of file Main.\+cpp.



References proxygen\+::compress\+::\+H\+P\+A\+CK, proxygen\+::compress\+::\+Q\+M\+IN, proxygen\+::compress\+::\+Q\+P\+A\+CK, proxygen\+::compress\+::\+Compression\+Simulator\+::read\+Input\+From\+File\+And\+Schedule(), and proxygen\+::compress\+::\+Compression\+Simulator\+::run().


\begin{DoxyCode}
39                                  \{
40   folly::init(&argc, &argv, \textcolor{keyword}{true});
41   \textcolor{keywordflow}{if} (FLAGS\_same\_packet\_compression) \{
42     LOG(WARNING) << \textcolor{stringliteral}{"Same packet compression no longer supported"};
43   \}
44 
45   \textcolor{keywordflow}{if} (FLAGS\_input.empty()) \{
46     LOG(ERROR) << \textcolor{stringliteral}{"Must supply a filename"};
47     \textcolor{keywordflow}{return} 1;
48   \}
49 
50   SchemeType t = SchemeType::QPACK;
51   \textcolor{keywordflow}{if} (FLAGS\_scheme == \textcolor{stringliteral}{"qpack"}) \{
52     LOG(INFO) << \textcolor{stringliteral}{"Using QPACK"};
53     t = SchemeType::QPACK;
54   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (FLAGS\_scheme == \textcolor{stringliteral}{"qmin"}) \{
55     LOG(INFO) << \textcolor{stringliteral}{"Using QMIN"};
56     t = SchemeType::QMIN;
57   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (FLAGS\_scheme == \textcolor{stringliteral}{"hpack"}) \{
58     LOG(INFO) << \textcolor{stringliteral}{"Using HPACK with table size="} << FLAGS\_table\_size;
59     t = SchemeType::HPACK;
60   \} \textcolor{keywordflow}{else} \{
61     LOG(ERROR) << \textcolor{stringliteral}{"Unsupported scheme"};
62     \textcolor{keywordflow}{return} 1;
63   \}
64 
65   \textcolor{keywordflow}{if} (FLAGS\_seed == 0) \{
66     FLAGS\_seed = folly::Random::rand64();
67     std::cout << \textcolor{stringliteral}{"Seed: "} << FLAGS\_seed << std::endl;
68   \}
69   SimParams p\{t,
70               FLAGS\_seed,
71               std::chrono::milliseconds(FLAGS\_rtt),
72               FLAGS\_lossp,
73               FLAGS\_delayp,
74               std::chrono::milliseconds(FLAGS\_delay),
75               uint16\_t(FLAGS\_ooo\_thresh),
76               FLAGS\_blend,
77               FLAGS\_same\_packet\_compression,
78               uint32\_t(FLAGS\_table\_size),
79               uint32\_t(FLAGS\_max\_blocking)\};
80   CompressionSimulator sim(p);
81   \textcolor{keywordflow}{if} (sim.readInputFromFileAndSchedule(FLAGS\_input)) \{
82     sim.run();
83   \}
84 
85   \textcolor{keywordflow}{return} 0;
86 \}
\end{DoxyCode}
