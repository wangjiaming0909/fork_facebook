\section{proxygen\+:\+:H\+P\+A\+C\+K\+Encode\+Buffer Class Reference}
\label{classproxygen_1_1HPACKEncodeBuffer}\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}


{\ttfamily \#include $<$H\+P\+A\+C\+K\+Encode\+Buffer.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf H\+P\+A\+C\+K\+Encode\+Buffer} (uint32\+\_\+t growth\+Size, bool huffman\+Enabled)
\item 
{\bf H\+P\+A\+C\+K\+Encode\+Buffer} (uint32\+\_\+t growth\+Size)
\item 
{\bf $\sim$\+H\+P\+A\+C\+K\+Encode\+Buffer} ()
\item 
std\+::unique\+\_\+ptr$<$ folly\+::\+I\+O\+Buf $>$ {\bf release} ()
\item 
void {\bf clear} ()
\item 
void {\bf add\+Headroom} (uint32\+\_\+t bytes)
\item 
uint32\+\_\+t {\bf encode\+Integer} (uint64\+\_\+t value, uint8\+\_\+t instruction, uint8\+\_\+t nbit)
\item 
uint32\+\_\+t {\bf encode\+Integer} (uint64\+\_\+t value, const {\bf H\+P\+A\+C\+K\+::\+Instruction} \&instruction)
\item 
uint32\+\_\+t {\bf encode\+Integer} (uint64\+\_\+t value)
\item 
uint32\+\_\+t {\bf encode\+Literal} (folly\+::\+String\+Piece literal)
\item 
uint32\+\_\+t {\bf encode\+Literal} (uint8\+\_\+t instruction, uint8\+\_\+t nbit, folly\+::\+String\+Piece literal)
\item 
uint32\+\_\+t {\bf encode\+Huffman} (folly\+::\+String\+Piece literal)
\item 
uint32\+\_\+t {\bf encode\+Huffman} (uint8\+\_\+t instruction, uint8\+\_\+t nbit, folly\+::\+String\+Piece literal)
\item 
std\+::string {\bf to\+Bin} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void {\bf append} (uint8\+\_\+t byte)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
folly\+::\+I\+O\+Buf\+Queue {\bf buf\+Queue\+\_\+}
\item 
folly\+::io\+::\+Queue\+Appender {\bf buf\+\_\+}
\item 
uint32\+\_\+t {\bf growth\+Size\+\_\+}
\item 
bool {\bf huffman\+Enabled\+\_\+}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 20 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+h.



\subsection{Constructor \& Destructor Documentation}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!H\+P\+A\+C\+K\+Encode\+Buffer@{H\+P\+A\+C\+K\+Encode\+Buffer}}
\index{H\+P\+A\+C\+K\+Encode\+Buffer@{H\+P\+A\+C\+K\+Encode\+Buffer}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{H\+P\+A\+C\+K\+Encode\+Buffer(uint32\+\_\+t growth\+Size, bool huffman\+Enabled)}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::\+H\+P\+A\+C\+K\+Encode\+Buffer (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{growth\+Size, }
\item[{bool}]{huffman\+Enabled}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_ab4cc11975c20d9a93a505d0e6eda3cf9}


Definition at line 24 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.


\begin{DoxyCode}
26                        :
27     buf_(&bufQueue_, growthSize),
28     growthSize_(growthSize),
29     huffmanEnabled_(huffmanEnabled) \{
30 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!H\+P\+A\+C\+K\+Encode\+Buffer@{H\+P\+A\+C\+K\+Encode\+Buffer}}
\index{H\+P\+A\+C\+K\+Encode\+Buffer@{H\+P\+A\+C\+K\+Encode\+Buffer}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{H\+P\+A\+C\+K\+Encode\+Buffer(uint32\+\_\+t growth\+Size)}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::\+H\+P\+A\+C\+K\+Encode\+Buffer (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{growth\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [explicit]}}\label{classproxygen_1_1HPACKEncodeBuffer_af1c4dbe56be62e8bace4820b7fda0273}


Definition at line 32 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.


\begin{DoxyCode}
32                                                         :
33     buf_(&bufQueue_, growthSize),
34     growthSize_(growthSize),
35     huffmanEnabled_(\textcolor{keyword}{false}) \{
36 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!````~H\+P\+A\+C\+K\+Encode\+Buffer@{$\sim$\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\index{````~H\+P\+A\+C\+K\+Encode\+Buffer@{$\sim$\+H\+P\+A\+C\+K\+Encode\+Buffer}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{$\sim$\+H\+P\+A\+C\+K\+Encode\+Buffer()}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::$\sim$\+H\+P\+A\+C\+K\+Encode\+Buffer (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HPACKEncodeBuffer_a519e45d90fc971f44d27268cf8679e61}


Definition at line 29 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+h.


\begin{DoxyCode}
29 \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!add\+Headroom@{add\+Headroom}}
\index{add\+Headroom@{add\+Headroom}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{add\+Headroom(uint32\+\_\+t bytes)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::add\+Headroom (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{bytes}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_a22db8d25c5d39b46362ea81e4e5f550e}
Add headroom at the beginning of the I\+O\+Buf\+Queue Meant to be called before encoding anything. 

Definition at line 38 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



References buf\+Queue\+\_\+, and growth\+Size\+\_\+.



Referenced by clear(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode(), and proxygen\+::\+Q\+P\+A\+C\+K\+Encoder\+::encode().


\begin{DoxyCode}
38                                                      \{
39   \textcolor{comment}{// we expect that this function is called before any encoding happens}
40   CHECK(bufQueue_.front() == \textcolor{keyword}{nullptr});
41   \textcolor{comment}{// create a custom IOBuf and add it to the queue}
42   unique\_ptr<IOBuf> buf = IOBuf::create(std::max(headroom, growthSize_));
43   buf->advance(headroom);
44   bufQueue_.append(std::move(buf));
45 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!append@{append}}
\index{append@{append}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{append(uint8\+\_\+t byte)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::append (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{byte}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncodeBuffer_a194198e5a1413410d9986da042571672}
append one byte at the end of buffer ensuring we always have enough space 

Definition at line 47 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



References buf\+\_\+.



Referenced by clear(), and encode\+Integer().


\begin{DoxyCode}
47                                            \{
48   buf_.push(&byte, 1);
49 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!clear@{clear}}
\index{clear@{clear}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{clear()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::clear (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HPACKEncodeBuffer_aa1d42ab99cc8969ae5ce4be571c60025}


Definition at line 38 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+h.



References add\+Headroom(), append(), buf\+Queue\+\_\+, encode\+Huffman(), encode\+Integer(), encode\+Literal(), and to\+Bin().


\begin{DoxyCode}
38                \{
39     bufQueue_.clear();
40   \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!encode\+Huffman@{encode\+Huffman}}
\index{encode\+Huffman@{encode\+Huffman}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{encode\+Huffman(folly\+::\+String\+Piece literal)}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Huffman (
\begin{DoxyParamCaption}
\item[{folly\+::\+String\+Piece}]{literal}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_a135f1f792aa6f68b1d917399ae06993c}
encodes a string using huffman encoding 

Definition at line 95 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



Referenced by clear(), and encode\+Literal().


\begin{DoxyCode}
95                                                                   \{
96   \textcolor{keywordflow}{return} encodeHuffman(0, 7, literal);
97 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!encode\+Huffman@{encode\+Huffman}}
\index{encode\+Huffman@{encode\+Huffman}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{encode\+Huffman(uint8\+\_\+t instruction, uint8\+\_\+t nbit, folly\+::\+String\+Piece literal)}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Huffman (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{instruction, }
\item[{uint8\+\_\+t}]{nbit, }
\item[{folly\+::\+String\+Piece}]{literal}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_af103ea6b16263330cd0cd2f19a9eab0d}
encodes a string using huffman encoding Q\+P\+A\+CK style, where literal length has an nbit prefix. 

Definition at line 109 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



References buf\+\_\+, encode\+Integer(), and proxygen\+::huffman\+::huff\+Tree().


\begin{DoxyCode}
110                                                                     \{
111   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keyword}{auto}& huffmanTree = huffman::huffTree();
112   uint32\_t size = huffmanTree.getEncodeSize(literal);
113   \textcolor{comment}{// add the length}
114   DCHECK\_LE(nbit, 7);
115   uint8\_t huffmanOn = uint8\_t(1 << nbit);
116   DCHECK\_EQ(instruction & huffmanOn, 0);
117   uint32\_t count = encodeInteger(size, instruction | huffmanOn, nbit);
118   \textcolor{comment}{// ensure we have enough bytes before performing the encoding}
119   count += huffmanTree.encode(literal, buf_);
120   \textcolor{keywordflow}{return} count;
121 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!encode\+Integer@{encode\+Integer}}
\index{encode\+Integer@{encode\+Integer}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{encode\+Integer(uint64\+\_\+t value, uint8\+\_\+t instruction, uint8\+\_\+t nbit)}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Integer (
\begin{DoxyParamCaption}
\item[{uint64\+\_\+t}]{value, }
\item[{uint8\+\_\+t}]{instruction, }
\item[{uint8\+\_\+t}]{nbit}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_afd120f4281c1491e3444e637c1b347dd}
Encode the integer value using variable-\/length layout and the given instruction using an nbit prefix. Per the spec, prefix is the portion of value that fits in one byte. The instruction is given as 1-\/byte value (not need for shifting) used only for the first byte. It starts from M\+SB.

For example for integer=3, instruction=0x80, nbit=6\+:

M\+SB L\+SB X X 0 0 0 0 1 1 (value) 1 0 X X X X X X (instruction) 1 0 0 0 0 0 1 1 (encoded value)

\begin{DoxyReturn}{Returns}
how many bytes were used to encode the value 
\end{DoxyReturn}


Definition at line 61 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



References append(), and proxygen\+::\+H\+P\+A\+C\+K\+::\+N\+B\+I\+T\+\_\+\+M\+A\+S\+KS.



Referenced by clear(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode\+As\+Index(), proxygen\+::\+Q\+P\+A\+C\+K\+Decoder\+::encode\+Cancel\+Stream(), proxygen\+::\+Q\+P\+A\+C\+K\+Encoder\+::encode\+Duplicate(), proxygen\+::\+Q\+P\+A\+C\+K\+Decoder\+::encode\+Header\+Ack(), proxygen\+::\+Q\+P\+A\+C\+K\+Encoder\+::encode\+Header\+Q(), encode\+Huffman(), encode\+Integer(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode\+Literal(), encode\+Literal(), proxygen\+::\+Q\+P\+A\+C\+K\+Encoder\+::encode\+Literal\+Q\+Helper(), proxygen\+::\+Q\+P\+A\+C\+K\+Encoder\+::encode\+Q(), proxygen\+::\+Q\+P\+A\+C\+K\+Decoder\+::encode\+Table\+State\+Sync(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+Base\+::handle\+Pending\+Context\+Update(), and T\+E\+S\+T\+\_\+\+F().


\begin{DoxyCode}
62                                                         \{
63   CHECK(nbit > 0 && nbit <= 8);
64   uint32\_t count = 0;
65   uint8\_t mask = HPACK::NBIT_MASKS[nbit];
66   \textcolor{comment}{// The instruction should not extend into mask}
67   DCHECK\_EQ(instruction & mask, 0);
68 
69   \textcolor{comment}{// write the first byte}
70   uint8\_t byte = instruction;
71   \textcolor{keywordflow}{if} (value < mask) \{
72     \textcolor{comment}{// fits in the first byte}
73     byte |= value;
74     append(byte);
75     \textcolor{keywordflow}{return} 1;
76   \}
77 
78   byte |= mask;
79   value -= mask;
80   ++count;
81   append(byte);
82   \textcolor{comment}{// variable length encoding}
83   \textcolor{keywordflow}{while} (value >= 128) \{
84     byte = 128 | (127 & value);
85     append(byte);
86     value = value >> 7;
87     ++count;
88   \}
89   \textcolor{comment}{// last byte, which should always fit on 1 byte}
90   append(value);
91   ++count;
92   \textcolor{keywordflow}{return} count;
93 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!encode\+Integer@{encode\+Integer}}
\index{encode\+Integer@{encode\+Integer}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{encode\+Integer(uint64\+\_\+t value, const H\+P\+A\+C\+K\+::\+Instruction \&instruction)}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Integer (
\begin{DoxyParamCaption}
\item[{uint64\+\_\+t}]{value, }
\item[{const {\bf H\+P\+A\+C\+K\+::\+Instruction} \&}]{instruction}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_a328c360edc665b12cc18de790f1d0727}


Definition at line 55 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



References proxygen\+::\+H\+P\+A\+C\+K\+::\+Instruction\+::code, encode\+Integer(), and proxygen\+::\+H\+P\+A\+C\+K\+::\+Instruction\+::prefix\+Length.


\begin{DoxyCode}
57                                        \{
58   \textcolor{keywordflow}{return} encodeInteger(value, instruction.code, instruction.prefixLength);
59 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!encode\+Integer@{encode\+Integer}}
\index{encode\+Integer@{encode\+Integer}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{encode\+Integer(uint64\+\_\+t value)}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Integer (
\begin{DoxyParamCaption}
\item[{uint64\+\_\+t}]{value}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_ae007b7d43e04a19277e9d9c687ac52d6}


Definition at line 51 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



References encode\+Integer().


\begin{DoxyCode}
51                                                         \{
52   \textcolor{keywordflow}{return} encodeInteger(value, 0, 8);
53 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!encode\+Literal@{encode\+Literal}}
\index{encode\+Literal@{encode\+Literal}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{encode\+Literal(folly\+::\+String\+Piece literal)}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Literal (
\begin{DoxyParamCaption}
\item[{folly\+::\+String\+Piece}]{literal}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_a50d72b2742c16eacdfada93a61943c50}
encodes a string, either header name or header value

\begin{DoxyReturn}{Returns}
bytes used for encoding 
\end{DoxyReturn}


Definition at line 123 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



Referenced by clear(), proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode\+Literal(), proxygen\+::\+Q\+P\+A\+C\+K\+Encoder\+::encode\+Literal\+Q\+Helper(), and T\+E\+S\+T\+\_\+\+F().


\begin{DoxyCode}
123                                                                   \{
124   \textcolor{keywordflow}{return} encodeLiteral(0, 7, literal);
125 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!encode\+Literal@{encode\+Literal}}
\index{encode\+Literal@{encode\+Literal}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{encode\+Literal(uint8\+\_\+t instruction, uint8\+\_\+t nbit, folly\+::\+String\+Piece literal)}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::encode\+Literal (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{instruction, }
\item[{uint8\+\_\+t}]{nbit, }
\item[{folly\+::\+String\+Piece}]{literal}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_a90454503760066076dce01c190c7a458}
encodes a string, either header name or header value Q\+P\+A\+CK style, where literal length has an nbit prefix.

\begin{DoxyReturn}{Returns}
bytes used for encoding 
\end{DoxyReturn}


Definition at line 127 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



References buf\+\_\+, encode\+Huffman(), encode\+Integer(), and huffman\+Enabled\+\_\+.


\begin{DoxyCode}
128                                                                     \{
129   \textcolor{keywordflow}{if} (huffmanEnabled_) \{
130     \textcolor{keywordflow}{return} encodeHuffman(instruction, nbit, literal);
131   \}
132   \textcolor{comment}{// otherwise use simple layout}
133   uint32\_t count =
134     encodeInteger(literal.size(), instruction, nbit);
135   \textcolor{comment}{// copy the entire string}
136   buf_.push((uint8\_t*)literal.data(), literal.size());
137   count += literal.size();
138   \textcolor{keywordflow}{return} count;
139 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!release@{release}}
\index{release@{release}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{release()}]{\setlength{\rightskip}{0pt plus 5cm}std\+::unique\+\_\+ptr$<$folly\+::\+I\+O\+Buf$>$ proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::release (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HPACKEncodeBuffer_ac98e41352ccc13c8b8fb3e5b9e10c083}
transfer ownership of the underlying I\+O\+Buf\textquotesingle{}s 

Definition at line 34 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+h.



References buf\+Queue\+\_\+.



Referenced by proxygen\+::\+H\+P\+A\+C\+K\+Encoder\+::encode(), proxygen\+::\+Q\+P\+A\+C\+K\+Decoder\+::encode\+Cancel\+Stream(), proxygen\+::\+Q\+P\+A\+C\+K\+Decoder\+::encode\+Header\+Ack(), proxygen\+::\+Q\+P\+A\+C\+K\+Encoder\+::encode\+Q(), proxygen\+::\+Q\+P\+A\+C\+K\+Decoder\+::encode\+Table\+State\+Sync(), H\+P\+A\+C\+K\+Buffer\+Tests\+::release\+Data(), and T\+E\+S\+T\+\_\+\+F().


\begin{DoxyCode}
34                                       \{
35     \textcolor{keywordflow}{return} bufQueue_.move();
36   \}
\end{DoxyCode}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!to\+Bin@{to\+Bin}}
\index{to\+Bin@{to\+Bin}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{to\+Bin()}]{\setlength{\rightskip}{0pt plus 5cm}string proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::to\+Bin (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HPACKEncodeBuffer_ae9e5d7cf5c3b5d189f6dfc04a783f0e6}
prints the content of an I\+O\+Buf in binary format. Useful for debugging. 

Definition at line 141 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp.



References buf\+Queue\+\_\+, and proxygen\+::\+I\+O\+Buf\+Printer\+::print\+Bin().



Referenced by clear(), and T\+E\+S\+T\+\_\+\+F().


\begin{DoxyCode}
141                                 \{
142   \textcolor{keywordflow}{return} IOBufPrinter::printBin(bufQueue_.front());
143 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!buf\+\_\+@{buf\+\_\+}}
\index{buf\+\_\+@{buf\+\_\+}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{buf\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}folly\+::io\+::\+Queue\+Appender proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::buf\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncodeBuffer_a3e6843672b7fefe3abb197f52633b015}


Definition at line 111 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+h.



Referenced by append(), encode\+Huffman(), and encode\+Literal().

\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!buf\+Queue\+\_\+@{buf\+Queue\+\_\+}}
\index{buf\+Queue\+\_\+@{buf\+Queue\+\_\+}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{buf\+Queue\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}folly\+::\+I\+O\+Buf\+Queue proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::buf\+Queue\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncodeBuffer_a47d0ed0e5780e4048bd4d89ea84e0268}


Definition at line 110 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+h.



Referenced by add\+Headroom(), clear(), release(), and to\+Bin().

\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!growth\+Size\+\_\+@{growth\+Size\+\_\+}}
\index{growth\+Size\+\_\+@{growth\+Size\+\_\+}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{growth\+Size\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::growth\+Size\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncodeBuffer_a811a967d64460e57436d9089b071403f}


Definition at line 112 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+h.



Referenced by add\+Headroom().

\index{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}!huffman\+Enabled\+\_\+@{huffman\+Enabled\+\_\+}}
\index{huffman\+Enabled\+\_\+@{huffman\+Enabled\+\_\+}!proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer@{proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer}}
\subsubsection[{huffman\+Enabled\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+P\+A\+C\+K\+Encode\+Buffer\+::huffman\+Enabled\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HPACKEncodeBuffer_a89d7c562d1fe25d4edaf4cdab1de5e38}


Definition at line 113 of file H\+P\+A\+C\+K\+Encode\+Buffer.\+h.



Referenced by encode\+Literal().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
proxygen/lib/http/codec/compress/{\bf H\+P\+A\+C\+K\+Encode\+Buffer.\+h}\item 
proxygen/lib/http/codec/compress/{\bf H\+P\+A\+C\+K\+Encode\+Buffer.\+cpp}\end{DoxyCompactItemize}
