\section{proxygen\+:\+:H\+T\+T\+P2\+Priority\+Queue\+:\+:Node Class Reference}
\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node}\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
Inheritance diagram for proxygen\+:\+:H\+T\+T\+P2\+Priority\+Queue\+:\+:Node\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.098039cm]{classproxygen_1_1HTTP2PriorityQueue_1_1Node}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct {\bf Id\+Hash}
\item 
struct {\bf Id\+Node\+Equal}
\item 
struct {\bf Pending\+Node}
\end{DoxyCompactItemize}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
using {\bf Pending\+List} = std\+::deque$<$ {\bf Pending\+Node} $>$
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf Node} ({\bf H\+T\+T\+P2\+Priority\+Queue} \&queue, {\bf Node} $\ast$in\+Parent, {\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} id, uint8\+\_\+t weight, {\bf H\+T\+T\+P\+Transaction} $\ast$txn)
\item 
{\bf $\sim$\+Node} () override
\item 
void {\bf set\+Permanent} ()
\item 
{\bf Node} $\ast$ {\bf get\+Parent} () const 
\item 
{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf get\+ID} () const 
\item 
{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf parent\+ID} () const 
\item 
{\bf H\+T\+T\+P\+Transaction} $\ast$ {\bf get\+Transaction} () const 
\item 
void {\bf clear\+Transaction} ()
\item 
{\bf Node} $\ast$ {\bf emplace\+Node} (std\+::unique\+\_\+ptr$<$ {\bf Node} $>$ node, bool exclusive)
\item 
void {\bf remove\+From\+Tree} ()
\item 
void {\bf signal\+Pending\+Egress} ()
\item 
void {\bf clear\+Pending\+Egress} ()
\item 
uint16\+\_\+t {\bf get\+Weight} () const 
\item 
void {\bf update\+Weight} (uint8\+\_\+t weight)
\item 
{\bf Node} $\ast$ {\bf reparent} ({\bf Node} $\ast$new\+Parent, bool exclusive)
\item 
bool {\bf is\+Descendant\+Of} ({\bf Node} $\ast$node) const 
\item 
bool {\bf is\+Enqueued} () const override
\item 
bool {\bf in\+Egress\+Tree} () const 
\item 
double {\bf get\+Relative\+Weight} () const 
\item 
double {\bf get\+Relative\+Enqueued\+Weight} () const 
\item 
bool {\bf iterate} (const std\+::function$<$ bool({\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID}, {\bf H\+T\+T\+P\+Transaction} $\ast$, double)$>$ \&fn, const std\+::function$<$ bool()$>$ \&stop\+Fn, bool all)
\item 
bool {\bf visit\+B\+FS} (double relative\+Parent\+Weight, const std\+::function$<$ bool({\bf H\+T\+T\+P2\+Priority\+Queue} \&queue, {\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID}, {\bf H\+T\+T\+P\+Transaction} $\ast$, double)$>$ \&fn, bool all, {\bf Pending\+List} \&pending\+Nodes, bool enqueued\+Children)
\item 
void {\bf update\+Enqueued\+Weight} (bool active\+Nodes)
\item 
void {\bf drop\+Priority\+Nodes} ()
\item 
void {\bf convert\+Virtual\+Node} ({\bf H\+T\+T\+P\+Transaction} $\ast$txn)
\item 
uint64\+\_\+t {\bf calculate\+Depth} (bool include\+Virtual=true) const override
\item 
void {\bf flatten\+Subtree} ()
\item 
void {\bf flatten\+Subtree\+D\+FS} ({\bf Node} $\ast$subtree\+Root)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void {\bf add\+Child\+To\+New\+Subtree\+Root} (std\+::unique\+\_\+ptr$<$ {\bf Node} $>$ child, {\bf Node} $\ast$subtree\+Root)
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static const uint16\+\_\+t {\bf k\+Default\+Weight} = 16
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf Node} $\ast$ {\bf add\+Child} (std\+::unique\+\_\+ptr$<$ {\bf Node} $>$ child)
\item 
void {\bf add\+Children} (std\+::list$<$ std\+::unique\+\_\+ptr$<$ {\bf Node} $>$$>$ \&\&children)
\item 
std\+::unique\+\_\+ptr$<$ {\bf Node} $>$ {\bf detach\+Child} ({\bf Node} $\ast$node)
\item 
void {\bf add\+Enqueued\+Child} ({\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$node)
\item 
void {\bf remove\+Enqueued\+Child} ({\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$node)
\item 
void {\bf timeout\+Expired} () noexceptoverride
\item 
void {\bf refresh\+Timeout} ()
\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static void {\bf propagate\+Pending\+Egress\+Signal} ({\bf Node} $\ast$node)
\item 
static void {\bf propagate\+Pending\+Egress\+Clear} ({\bf Node} $\ast$node)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
{\bf H\+T\+T\+P2\+Priority\+Queue} \& {\bf queue\+\_\+}
\item 
{\bf Node} $\ast$ {\bf parent\+\_\+} \{{\bf nullptr}\}
\item 
{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} {\bf id\+\_\+}
\item 
uint16\+\_\+t {\bf weight\+\_\+} \{{\bf k\+Default\+Weight}\}
\item 
{\bf H\+T\+T\+P\+Transaction} $\ast$ {\bf txn\+\_\+} \{{\bf nullptr}\}
\item 
bool {\bf is\+Permanent\+\_\+} \{false\}
\item 
bool {\bf enqueued\+\_\+} \{false\}
\item 
uint64\+\_\+t {\bf total\+Enqueued\+Weight\+Check\+\_\+} \{0\}
\item 
uint64\+\_\+t {\bf total\+Enqueued\+Weight\+\_\+} \{0\}
\item 
uint64\+\_\+t {\bf total\+Child\+Weight\+\_\+} \{0\}
\item 
std\+::list$<$ std\+::unique\+\_\+ptr$<$ {\bf Node} $>$ $>$ {\bf children\+\_\+}
\item 
std\+::list$<$ std\+::unique\+\_\+ptr$<$ {\bf Node} $>$ $>$\+::iterator {\bf self\+\_\+}
\item 
folly\+::\+Intrusive\+List\+Hook {\bf enqueued\+Hook\+\_\+}
\item 
folly\+::\+Intrusive\+List$<$ {\bf Node},\&{\bf Node\+::enqueued\+Hook\+\_\+} $>$ {\bf enqueued\+Children\+\_\+}
\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
bool {\bf operator==} (const {\bf Node} \&lhs, const {\bf Node} \&rhs)
\item 
std\+::size\+\_\+t {\bf hash\+\_\+value} (const {\bf Node} \&node)
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 210 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



\subsection{Member Typedef Documentation}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!Pending\+List@{Pending\+List}}
\index{Pending\+List@{Pending\+List}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{Pending\+List}]{\setlength{\rightskip}{0pt plus 5cm}using {\bf proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::\+Pending\+List} =  std\+::deque$<${\bf Pending\+Node}$>$}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_aaf3bf0b35d43a6bb0792f569ec90d7cc}


Definition at line 350 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



\subsection{Constructor \& Destructor Documentation}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!Node@{Node}}
\index{Node@{Node}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{Node(\+H\+T\+T\+P2\+Priority\+Queue \&queue, Node $\ast$in\+Parent, H\+T\+T\+P\+Codec\+::\+Stream\+I\+D id, uint8\+\_\+t weight, H\+T\+T\+P\+Transaction $\ast$txn)}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::\+Node (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P2\+Priority\+Queue} \&}]{queue, }
\item[{{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$}]{in\+Parent, }
\item[{{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID}}]{id, }
\item[{uint8\+\_\+t}]{weight, }
\item[{{\bf H\+T\+T\+P\+Transaction} $\ast$}]{txn}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a9033e928265da09cacbd899119fdda7a}


Definition at line 21 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References id\+\_\+, proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::nodes\+\_\+, and queue\+\_\+.


\begin{DoxyCode}
25     : queue_(queue),
26       parent_(inParent),
27       id_(\textcolor{keywordtype}{id}),
28       weight_(weight + 1),
29       txn_(txn) \{
30   DCHECK(queue_.nodes_.find(id_,
31                             IdHash(), IdNodeEqual()) == queue_.nodes_.end());
32   queue_.nodes_.insert(*\textcolor{keyword}{this});
33 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!````~Node@{$\sim$\+Node}}
\index{````~Node@{$\sim$\+Node}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{$\sim$\+Node() override}]{\setlength{\rightskip}{0pt plus 5cm}proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::$\sim$\+Node (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [override]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a115a2cd01a2ffc02af0a52d232ca5c59}


Definition at line 35 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::num\+Virtual\+Nodes\+\_\+, queue\+\_\+, and txn\+\_\+.


\begin{DoxyCode}
35                               \{
36   \textcolor{keywordflow}{if} (!txn_) \{
37     queue_.numVirtualNodes_--;
38   \}
39 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!add\+Child@{add\+Child}}
\index{add\+Child@{add\+Child}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{add\+Child(std\+::unique\+\_\+ptr$<$ Node $>$ child)}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::add\+Child (
\begin{DoxyParamCaption}
\item[{std\+::unique\+\_\+ptr$<$ {\bf Node} $>$}]{child}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a1417f04b3180f005c08c2a7b9cfae7d1}


Definition at line 91 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References children\+\_\+, id\+\_\+, self\+\_\+, and total\+Child\+Weight\+\_\+.



Referenced by add\+Children(), and emplace\+Node().


\begin{DoxyCode}
92                                             \{
93   CHECK\_NE(id_, child->id\_) << \textcolor{stringliteral}{"Tried to create a loop in the tree"};
94   child->parent\_ = \textcolor{keyword}{this};
95   totalChildWeight_ += child->weight\_;
96   Node* raw = child.get();
97   raw->self\_ = children_.insert(children_.end(), std::move(child));
98   cancelTimeout();
99   \textcolor{keywordflow}{return} raw;
100 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!add\+Children@{add\+Children}}
\index{add\+Children@{add\+Children}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{add\+Children(std\+::list$<$ std\+::unique\+\_\+ptr$<$ Node $>$$>$ \&\&children)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::add\+Children (
\begin{DoxyParamCaption}
\item[{std\+::list$<$ std\+::unique\+\_\+ptr$<$ {\bf Node} $>$$>$ \&\&}]{children}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a327dbb63732308ba5b1e718ab2012ad0}


Definition at line 67 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References add\+Child(), add\+Enqueued\+Child(), in\+Egress\+Tree(), propagate\+Pending\+Egress\+Signal(), and total\+Enqueued\+Weight\+\_\+.



Referenced by remove\+From\+Tree().


\begin{DoxyCode}
67                                                                      \{
68   list<unique\_ptr<Node>> emptyChilden;
69   uint64\_t totalEnqueuedWeight = 0;
70   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& child: children) \{
71     \textcolor{keywordflow}{if} (child->inEgressTree()) \{
72       totalEnqueuedWeight += child->weight\_;
73       child->parent\_->removeEnqueuedChild(child.get());
74       CHECK(!child->enqueuedHook\_.is\_linked());
75       addEnqueuedChild(child.get());
76     \} \textcolor{keywordflow}{else} \{
77       CHECK(!child->enqueuedHook\_.is\_linked());
78     \}
79     addChild(std::move(child));
80   \}
81   std::swap(children, emptyChilden);
82   \textcolor{keywordflow}{if} (totalEnqueuedWeight > 0) \{
83     \textcolor{keywordflow}{if} (!inEgressTree()) \{
84       propagatePendingEgressSignal(\textcolor{keyword}{this});
85     \}
86     totalEnqueuedWeight_ += totalEnqueuedWeight;
87   \}
88 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!add\+Child\+To\+New\+Subtree\+Root@{add\+Child\+To\+New\+Subtree\+Root}}
\index{add\+Child\+To\+New\+Subtree\+Root@{add\+Child\+To\+New\+Subtree\+Root}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{add\+Child\+To\+New\+Subtree\+Root(std\+::unique\+\_\+ptr$<$ Node $>$ child, Node $\ast$subtree\+Root)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::add\+Child\+To\+New\+Subtree\+Root (
\begin{DoxyParamCaption}
\item[{std\+::unique\+\_\+ptr$<$ {\bf Node} $>$}]{child, }
\item[{{\bf Node} $\ast$}]{subtree\+Root}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a904dad326d193c80eaf6d7d94a112113}


Definition at line 417 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References children\+\_\+, k\+Default\+Weight, and self\+\_\+.



Referenced by flatten\+Subtree(), and flatten\+Subtree\+D\+F\+S().


\begin{DoxyCode}
418                                                                       \{
419   child->children\_.clear();
420   child->parent\_ = subtreeRoot;
421   child->weight\_ = kDefaultWeight;
422   child->totalChildWeight\_ = 0;
423   child->totalEnqueuedWeight\_ = 0;
424 \textcolor{preprocessor}{#ifndef NDEBUG}
425   child->totalEnqueuedWeightCheck\_ = 0;
426 \textcolor{preprocessor}{#endif}
427   Node* raw = child.get();
428   raw->self\_ = subtreeRoot->children\_.insert(subtreeRoot->children\_.end(),
429                                              std::move(child));
430 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!add\+Enqueued\+Child@{add\+Enqueued\+Child}}
\index{add\+Enqueued\+Child@{add\+Enqueued\+Child}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{add\+Enqueued\+Child(\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node $\ast$node)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::add\+Enqueued\+Child (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_ab999ac2fcfdabf68a2cc18923b627dac}


Definition at line 160 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References enqueued\+Children\+\_\+, and enqueued\+Hook\+\_\+.



Referenced by add\+Children(), and propagate\+Pending\+Egress\+Signal().


\begin{DoxyCode}
160                                                                      \{
161   CHECK(!node->enqueuedHook\_.is\_linked());
162   enqueuedChildren_.push\_back(*node);
163 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!calculate\+Depth@{calculate\+Depth}}
\index{calculate\+Depth@{calculate\+Depth}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{calculate\+Depth(bool include\+Virtual=true) const override}]{\setlength{\rightskip}{0pt plus 5cm}uint64\+\_\+t proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::calculate\+Depth (
\begin{DoxyParamCaption}
\item[{bool}]{include\+Virtual = {\ttfamily true}}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [override]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a5455c11c07553f0f43bd6e51e0a7f770}


Definition at line 365 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References get\+Parent(), and txn\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::update\+Priority().


\begin{DoxyCode}
365                                                                 \{
366   uint64\_t depth = 0;
367   \textcolor{keyword}{const} Node* cur = \textcolor{keyword}{this};
368   \textcolor{keywordflow}{while} (cur->getParent() != \textcolor{keyword}{nullptr}) \{
369     \textcolor{keywordflow}{if} (cur->txn\_ || includeVirtual) \{
370       depth += 1;
371     \}
372     cur = cur->getParent();
373   \}
374   \textcolor{keywordflow}{return} depth;
375 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!clear\+Pending\+Egress@{clear\+Pending\+Egress}}
\index{clear\+Pending\+Egress@{clear\+Pending\+Egress}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{clear\+Pending\+Egress()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::clear\+Pending\+Egress (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a900c8538a16249ceaa12c52a8bc3e61b}


Definition at line 195 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References enqueued\+\_\+, and propagate\+Pending\+Egress\+Clear().



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::remove\+Transaction().


\begin{DoxyCode}
195                                            \{
196   CHECK(enqueued_);
197   enqueued_ = \textcolor{keyword}{false};
198   propagatePendingEgressClear(\textcolor{keyword}{this});
199 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!clear\+Transaction@{clear\+Transaction}}
\index{clear\+Transaction@{clear\+Transaction}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{clear\+Transaction()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::clear\+Transaction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_af5eaeac856ada0e89d0ed38f7f4a8a48}


Definition at line 270 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



References proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+Base\+::clear\+Pending\+Egress(), and proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+Base\+::signal\+Pending\+Egress().



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::remove\+Transaction().


\begin{DoxyCode}
270                             \{
271       txn_ = \textcolor{keyword}{nullptr};
272     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!convert\+Virtual\+Node@{convert\+Virtual\+Node}}
\index{convert\+Virtual\+Node@{convert\+Virtual\+Node}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{convert\+Virtual\+Node(\+H\+T\+T\+P\+Transaction $\ast$txn)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::convert\+Virtual\+Node (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P\+Transaction} $\ast$}]{txn}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a4743f8346a95664871f16eb8d4a14aa7}


Definition at line 355 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References is\+Permanent\+\_\+, proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::num\+Virtual\+Nodes\+\_\+, queue\+\_\+, and txn\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::add\+Transaction().


\begin{DoxyCode}
355                                                                \{
356   CHECK(!txn_);
357   CHECK(!isPermanent_);
358   CHECK\_GT(queue_.numVirtualNodes_, 0);
359   queue_.numVirtualNodes_--;
360   txn_ = txn;
361   cancelTimeout();
362 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!detach\+Child@{detach\+Child}}
\index{detach\+Child@{detach\+Child}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{detach\+Child(\+Node $\ast$node)}]{\setlength{\rightskip}{0pt plus 5cm}unique\+\_\+ptr$<$ {\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $>$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::detach\+Child (
\begin{DoxyParamCaption}
\item[{{\bf Node} $\ast$}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a6c8f2adf3a17dddee3bd810883b47042}


Definition at line 103 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References children\+\_\+, is\+Enqueued(), is\+Permanent\+\_\+, parent\+\_\+, queue\+\_\+, proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::schedule\+Node\+Expiration(), self\+\_\+, total\+Child\+Weight\+\_\+, txn\+\_\+, and weight\+\_\+.



Referenced by remove\+From\+Tree(), and reparent().


\begin{DoxyCode}
103                                               \{
104   CHECK(!node->isEnqueued());
105   totalChildWeight_ -= node->weight\_;
106   \textcolor{keyword}{auto} it = node->self\_;
107   \textcolor{keyword}{auto} res = std::move(*node->self\_);
108   children_.erase(it);
109   node->parent\_ = \textcolor{keyword}{nullptr};
110   \textcolor{keywordflow}{if} (children_.empty() && !txn_ && !isPermanent_) \{
111     queue_.scheduleNodeExpiration(\textcolor{keyword}{this});
112   \}
113   \textcolor{keywordflow}{return} res;
114 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!drop\+Priority\+Nodes@{drop\+Priority\+Nodes}}
\index{drop\+Priority\+Nodes@{drop\+Priority\+Nodes}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{drop\+Priority\+Nodes()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::drop\+Priority\+Nodes (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_abbd3a594a0661cf6bb3409ab126b4e16}


Definition at line 344 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References children\+\_\+, is\+Permanent\+\_\+, remove\+From\+Tree(), and txn\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::detach\+Thread\+Locals().


\begin{DoxyCode}
344                                           \{
345   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} it = children_.begin(); it != children_.end(); ) \{
346     \textcolor{keyword}{auto}& child = *it++;
347     child->dropPriorityNodes();
348   \}
349   \textcolor{keywordflow}{if} (!txn_ && !isPermanent_) \{
350     removeFromTree();
351   \}
352 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!emplace\+Node@{emplace\+Node}}
\index{emplace\+Node@{emplace\+Node}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{emplace\+Node(std\+::unique\+\_\+ptr$<$ Node $>$ node, bool exclusive)}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::emplace\+Node (
\begin{DoxyParamCaption}
\item[{std\+::unique\+\_\+ptr$<$ {\bf Node} $>$}]{node, }
\item[{bool}]{exclusive}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_afde4c62c46668610b6ab68f577ed1b99}


Definition at line 43 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References add\+Child(), children\+\_\+, id\+\_\+, in\+Egress\+Tree(), propagate\+Pending\+Egress\+Clear(), total\+Child\+Weight\+\_\+, total\+Enqueued\+Weight\+\_\+, and total\+Enqueued\+Weight\+Check\+\_\+.



Referenced by reparent().


\begin{DoxyCode}
44                                                            \{
45   CHECK(!node->isEnqueued());
46   list<unique\_ptr<Node>> children;
47   CHECK\_NE(id_, node->id\_) << \textcolor{stringliteral}{"Tried to create a loop in the tree"};
48   \textcolor{keywordflow}{if} (exclusive) \{
49     \textcolor{comment}{// this->children become new node's children}
50     std::swap(children, children_);
51     totalChildWeight_ = 0;
52     \textcolor{keywordtype}{bool} wasInEgressTree = inEgressTree();
53     totalEnqueuedWeight_ = 0;
54 \textcolor{preprocessor}{#ifndef NDEBUG}
55     totalEnqueuedWeightCheck_ = 0;
56 \textcolor{preprocessor}{#endif}
57     \textcolor{keywordflow}{if} (wasInEgressTree && !inEgressTree()) \{
58       propagatePendingEgressClear(\textcolor{keyword}{this});
59     \}
60   \}
61   \textcolor{keyword}{auto} res = addChild(std::move(node));
62   res->addChildren(std::move(children));
63   \textcolor{keywordflow}{return} res;
64 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!flatten\+Subtree@{flatten\+Subtree}}
\index{flatten\+Subtree@{flatten\+Subtree}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{flatten\+Subtree()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::flatten\+Subtree (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a5e6f404fe3a0e252a9e9eeff6909b6ae}


Definition at line 378 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References add\+Child\+To\+New\+Subtree\+Root(), children\+\_\+, total\+Child\+Weight\+\_\+, total\+Enqueued\+Weight\+\_\+, and total\+Enqueued\+Weight\+Check\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::rebuild\+Tree().


\begin{DoxyCode}
378                                        \{
379   std::list<std::unique\_ptr<Node>> oldChildren\_;
380   \textcolor{comment}{// Move the old children to a temporary list}
381   std::swap(oldChildren\_, children_);
382   \textcolor{comment}{// Reparent the children}
383   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& child : oldChildren\_) \{
384     child->flattenSubtreeDFS(\textcolor{keyword}{this});
385     addChildToNewSubtreeRoot(std::move(child), \textcolor{keyword}{this});
386   \}
387   \textcolor{comment}{// Update the weights}
388   totalEnqueuedWeight_ = 0;
389 \textcolor{preprocessor}{#ifndef NDEBUG}
390   totalEnqueuedWeightCheck_ = 0;
391 \textcolor{preprocessor}{#endif}
392   totalChildWeight_ = 0;
393   std::for\_each(
394     children_.begin(),
395     children_.end(),
396     [\textcolor{keyword}{this}](\textcolor{keyword}{const} std::unique\_ptr<Node>& child) \{
397       totalChildWeight_ += child->weight\_;
398       \textcolor{keywordflow}{if} (child->enqueued\_) \{
399         totalEnqueuedWeight_ += child->weight\_;
400 \textcolor{preprocessor}{#ifndef NDEBUG}
401         totalEnqueuedWeightCheck_ += child->weight\_;
402 \textcolor{preprocessor}{#endif}
403       \}
404     \}
405   );
406 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!flatten\+Subtree\+D\+FS@{flatten\+Subtree\+D\+FS}}
\index{flatten\+Subtree\+D\+FS@{flatten\+Subtree\+D\+FS}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{flatten\+Subtree\+D\+F\+S(\+Node $\ast$subtree\+Root)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::flatten\+Subtree\+D\+FS (
\begin{DoxyParamCaption}
\item[{{\bf Node} $\ast$}]{subtree\+Root}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a7cd1b9e8bb480806e99e2eb77a6376c2}


Definition at line 409 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References add\+Child\+To\+New\+Subtree\+Root(), and children\+\_\+.


\begin{DoxyCode}
409                                                            \{
410   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& child : children_) \{
411     child->flattenSubtreeDFS(subtreeRoot);
412     addChildToNewSubtreeRoot(std::move(child), subtreeRoot);
413   \}
414 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!get\+ID@{get\+ID}}
\index{get\+ID@{get\+ID}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{get\+I\+D() const }]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::get\+ID (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_ad33a73745b255546de9b5ae372b530fc}


Definition at line 255 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::add\+Transaction(), proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::remove\+Transaction(), proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::schedule\+Node\+Expiration(), and proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::update\+Priority().


\begin{DoxyCode}
255                                     \{
256       \textcolor{keywordflow}{return} id_;
257     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!get\+Parent@{get\+Parent}}
\index{get\+Parent@{get\+Parent}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{get\+Parent() const }]{\setlength{\rightskip}{0pt plus 5cm}{\bf Node}$\ast$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::get\+Parent (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a03c09475b75031926711657c6a75011c}


Definition at line 251 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by calculate\+Depth(), and proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::update\+Priority().


\begin{DoxyCode}
251                             \{
252       \textcolor{keywordflow}{return} parent_;
253     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!get\+Relative\+Enqueued\+Weight@{get\+Relative\+Enqueued\+Weight}}
\index{get\+Relative\+Enqueued\+Weight@{get\+Relative\+Enqueued\+Weight}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{get\+Relative\+Enqueued\+Weight() const }]{\setlength{\rightskip}{0pt plus 5cm}double proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::get\+Relative\+Enqueued\+Weight (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a5b03fd6fe26606a7e491366bf9e785f9}


Definition at line 315 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by visit\+B\+F\+S().


\begin{DoxyCode}
315                                              \{
316       \textcolor{keywordflow}{if} (!parent_) \{
317         \textcolor{keywordflow}{return} 1.0;
318       \}
319 
320       \textcolor{keywordflow}{if} (parent_->totalEnqueuedWeight_ == 0) \{
321         \textcolor{keywordflow}{return} 0.0;
322       \}
323 
324       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(weight_) / parent_->totalEnqueuedWeight_;
325     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!get\+Relative\+Weight@{get\+Relative\+Weight}}
\index{get\+Relative\+Weight@{get\+Relative\+Weight}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{get\+Relative\+Weight() const }]{\setlength{\rightskip}{0pt plus 5cm}double proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::get\+Relative\+Weight (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a1dc189af6aaca0e1b346d3162c9a2d05}


Definition at line 307 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by iterate().


\begin{DoxyCode}
307                                      \{
308       \textcolor{keywordflow}{if} (!parent_) \{
309         \textcolor{keywordflow}{return} 1.0;
310       \}
311 
312       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(weight_) / parent_->totalChildWeight_;
313     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!get\+Transaction@{get\+Transaction}}
\index{get\+Transaction@{get\+Transaction}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{get\+Transaction() const }]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P\+Transaction}$\ast$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::get\+Transaction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a851de670e0bd802e039fee067c0c823c}


Definition at line 266 of file H\+T\+T\+P2\+Priority\+Queue.\+h.


\begin{DoxyCode}
266                                             \{
267       \textcolor{keywordflow}{return} txn_;
268     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!get\+Weight@{get\+Weight}}
\index{get\+Weight@{get\+Weight}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{get\+Weight() const }]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::get\+Weight (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_ac26b18118f01059a417a9103c8dc58b7}


Definition at line 284 of file H\+T\+T\+P2\+Priority\+Queue.\+h.


\begin{DoxyCode}
284                                \{
285       \textcolor{keywordflow}{return} weight_;
286     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!in\+Egress\+Tree@{in\+Egress\+Tree}}
\index{in\+Egress\+Tree@{in\+Egress\+Tree}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{in\+Egress\+Tree() const }]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::in\+Egress\+Tree (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a94d68b146f59738a2234030cc2ba7d53}


Definition at line 303 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



References proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+Base\+::\+Base\+Node\+::is\+Enqueued().



Referenced by add\+Children(), emplace\+Node(), propagate\+Pending\+Egress\+Clear(), propagate\+Pending\+Egress\+Signal(), remove\+From\+Tree(), reparent(), and update\+Weight().


\begin{DoxyCode}
303                               \{
304       \textcolor{keywordflow}{return} isEnqueued() || totalEnqueuedWeight_ > 0;
305     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!is\+Descendant\+Of@{is\+Descendant\+Of}}
\index{is\+Descendant\+Of@{is\+Descendant\+Of}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{is\+Descendant\+Of(\+Node $\ast$node) const }]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::is\+Descendant\+Of (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$}]{node}
\end{DoxyParamCaption}
) const}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a76d04546777bbacef59ee297516e8eb7}


Definition at line 145 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References id\+\_\+, and parent\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::update\+Priority().


\begin{DoxyCode}
145                                                                          \{
146   Node* cur = parent_;
147   \textcolor{keywordflow}{while} (cur) \{
148     \textcolor{keywordflow}{if} (cur->id\_ == node->id\_) \{
149       \textcolor{keywordflow}{return} \textcolor{keyword}{true};
150     \}
151     cur = cur->parent_;
152   \}
153   \textcolor{keywordflow}{return} \textcolor{keyword}{false};
154 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!is\+Enqueued@{is\+Enqueued}}
\index{is\+Enqueued@{is\+Enqueued}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{is\+Enqueued() const override}]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::is\+Enqueued (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_adf1ce1f0033419664edbf1a0fc302357}


Definition at line 297 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by detach\+Child(), iterate(), remove\+From\+Tree(), proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::remove\+Transaction(), update\+Enqueued\+Weight(), and visit\+B\+F\+S().


\begin{DoxyCode}
297                                      \{
298       \textcolor{keywordflow}{return} (txn_ != \textcolor{keyword}{nullptr} && enqueued_);
299     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!iterate@{iterate}}
\index{iterate@{iterate}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{iterate(const std\+::function$<$ bool(\+H\+T\+T\+P\+Codec\+::\+Stream\+I\+D, H\+T\+T\+P\+Transaction $\ast$, double)$>$ \&fn, const std\+::function$<$ bool()$>$ \&stop\+Fn, bool all)}]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::iterate (
\begin{DoxyParamCaption}
\item[{const std\+::function$<$ bool({\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID}, {\bf H\+T\+T\+P\+Transaction} $\ast$, double)$>$ \&}]{fn, }
\item[{const std\+::function$<$ bool()$>$ \&}]{stop\+Fn, }
\item[{bool}]{all}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a3b83ff9c8ad4a6cf8f09399a69ed84b2}


Definition at line 261 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References children\+\_\+, get\+Relative\+Weight(), id\+\_\+, is\+Enqueued(), parent\+\_\+, total\+Enqueued\+Weight\+\_\+, total\+Enqueued\+Weight\+Check\+\_\+, and txn\+\_\+.


\begin{DoxyCode}
264                                                \{
265   \textcolor{keywordtype}{bool} stop = \textcolor{keyword}{false};
266   \textcolor{keywordflow}{if} (stopFn()) \{
267     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
268   \}
269 \textcolor{preprocessor}{#ifndef NDEBUG}
270   CHECK\_EQ(totalEnqueuedWeight_, totalEnqueuedWeightCheck_);
271 \textcolor{preprocessor}{#endif}
272   \textcolor{keywordflow}{if} (parent_ \textcolor{comment}{/* exclude root */}  && (all || isEnqueued())) \{
273     stop = fn(id_, txn_, getRelativeWeight());
274   \}
275   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& child: children_) \{
276     \textcolor{keywordflow}{if} (stop || stopFn()) \{
277       \textcolor{keywordflow}{return} \textcolor{keyword}{true};
278     \}
279     stop = child->iterate(fn, stopFn, all);
280   \}
281   \textcolor{keywordflow}{return} stop;
282 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!parent\+ID@{parent\+ID}}
\index{parent\+ID@{parent\+ID}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{parent\+I\+D() const }]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::parent\+ID (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a4868785ff399ffb7f0f8c99a4b01fb7e}


Definition at line 259 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::update\+Priority().


\begin{DoxyCode}
259                                        \{
260       \textcolor{keywordflow}{if} (parent_) \{
261         \textcolor{keywordflow}{return} parent_->id_;
262       \}
263       \textcolor{keywordflow}{return} queue_.getRootId();
264     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!propagate\+Pending\+Egress\+Clear@{propagate\+Pending\+Egress\+Clear}}
\index{propagate\+Pending\+Egress\+Clear@{propagate\+Pending\+Egress\+Clear}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{propagate\+Pending\+Egress\+Clear(\+Node $\ast$node)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::propagate\+Pending\+Egress\+Clear (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_abce0811035d4f6a39a0666e9211d800b}


Definition at line 202 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References in\+Egress\+Tree(), parent\+\_\+, remove\+Enqueued\+Child(), total\+Enqueued\+Weight\+\_\+, and weight\+\_\+.



Referenced by clear\+Pending\+Egress(), emplace\+Node(), remove\+From\+Tree(), and reparent().


\begin{DoxyCode}
203                                 \{
204   Node* parent = node->parent\_;
205   \textcolor{keywordtype}{bool} stop = node->inEgressTree();
206   \textcolor{comment}{// Continue subtracting node->weight\_ from parent\_->totalEnqueuedWeight\_}
207   \textcolor{comment}{// as long as node state changes from egress-in-subtree to}
208   \textcolor{comment}{// no-egress-in-subtree}
209   \textcolor{keywordflow}{while} (parent && !stop) \{
210     CHECK\_GE(parent->totalEnqueuedWeight\_, node->weight\_);
211     parent->totalEnqueuedWeight\_ -= node->weight\_;
212     parent->removeEnqueuedChild(node);
213     stop = parent->inEgressTree();
214     node = parent;
215     parent = parent->parent\_;
216   \}
217 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!propagate\+Pending\+Egress\+Signal@{propagate\+Pending\+Egress\+Signal}}
\index{propagate\+Pending\+Egress\+Signal@{propagate\+Pending\+Egress\+Signal}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{propagate\+Pending\+Egress\+Signal(\+Node $\ast$node)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::propagate\+Pending\+Egress\+Signal (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a3ed9707a6809218df7822dd00d618c38}


Definition at line 178 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References add\+Enqueued\+Child(), in\+Egress\+Tree(), parent\+\_\+, total\+Enqueued\+Weight\+\_\+, and weight\+\_\+.



Referenced by add\+Children(), reparent(), and signal\+Pending\+Egress().


\begin{DoxyCode}
179                                 \{
180   Node* parent = node->parent\_;
181   \textcolor{keywordtype}{bool} stop = node->totalEnqueuedWeight\_ > 0;
182   \textcolor{comment}{// Continue adding node->weight\_ to parent\_->totalEnqueuedWeight\_ as}
183   \textcolor{comment}{// long as node state changed from no-egress-in-subtree to}
184   \textcolor{comment}{// egress-in-subtree}
185   \textcolor{keywordflow}{while} (parent && !stop) \{
186     stop = parent->inEgressTree();
187     parent->totalEnqueuedWeight\_ += node->weight\_;
188     parent->addEnqueuedChild(node);
189     node = parent;
190     parent = parent->parent\_;
191   \}
192 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!refresh\+Timeout@{refresh\+Timeout}}
\index{refresh\+Timeout@{refresh\+Timeout}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{refresh\+Timeout()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::refresh\+Timeout (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_afad6a254ad3f6ed778e8bc876e0e8074}


Definition at line 394 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by update\+Weight().


\begin{DoxyCode}
394                           \{
395       \textcolor{keywordflow}{if} (!txn_ && !isPermanent_ && isScheduled()) \{
396         queue_.scheduleNodeExpiration(\textcolor{keyword}{this});
397       \}
398     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!remove\+Enqueued\+Child@{remove\+Enqueued\+Child}}
\index{remove\+Enqueued\+Child@{remove\+Enqueued\+Child}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{remove\+Enqueued\+Child(\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node $\ast$node)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::remove\+Enqueued\+Child (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_ada10cc7de8553da2c52eb51c6ec5e158}


Definition at line 166 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References enqueued\+Children\+\_\+, and enqueued\+Hook\+\_\+.



Referenced by propagate\+Pending\+Egress\+Clear().


\begin{DoxyCode}
166                                                                         \{
167   CHECK(node->enqueuedHook\_.is\_linked());
168   enqueuedChildren_.erase(enqueuedChildren_.iterator\_to(*node));
169 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!remove\+From\+Tree@{remove\+From\+Tree}}
\index{remove\+From\+Tree@{remove\+From\+Tree}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{remove\+From\+Tree()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::remove\+From\+Tree (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a3b1b47fbc191e09c43f27fbeb6ec0b8e}


Definition at line 233 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References add\+Children(), children\+\_\+, detach\+Child(), in\+Egress\+Tree(), is\+Enqueued(), parent\+\_\+, propagate\+Pending\+Egress\+Clear(), total\+Child\+Weight\+\_\+, total\+Enqueued\+Weight\+\_\+, and weight\+\_\+.



Referenced by drop\+Priority\+Nodes(), and proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::remove\+Transaction().


\begin{DoxyCode}
233                                        \{
234   \textcolor{keywordflow}{if} (!children_.empty()) \{
235     \textcolor{comment}{// update child weights so they sum to (approximately) this node's weight.}
236     \textcolor{keywordtype}{double} r = double(weight_) / totalChildWeight_;
237     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& child: children_) \{
238       uint64\_t newWeight = std::max(uint64\_t(child->weight\_ * r), uint64\_t(1));
239       CHECK\_LE(newWeight, 256);
240       child->updateWeight(uint8\_t(newWeight) - 1);
241     \}
242   \}
243 
244   CHECK(!isEnqueued());
245   \textcolor{keywordflow}{if} (inEgressTree()) \{
246     \textcolor{comment}{// Gah this is tricky.}
247     \textcolor{comment}{// The children of this node are moving to this node's parent.  We need the}
248     \textcolor{comment}{// tree in a consistent state before calling addChildren, so mark the}
249     \textcolor{comment}{// current node's totalEnqueuedWeight\_ as 0 and propagate the clear upwards.}
250     \textcolor{comment}{// addChildren will handle re-signalling egress.}
251     totalEnqueuedWeight_ = 0;
252     propagatePendingEgressClear(\textcolor{keyword}{this});
253   \}
254 
255   \textcolor{comment}{// move my children to my parent}
256   parent_->addChildren(std::move(children\_));
257   (void)parent_->detachChild(\textcolor{keyword}{this});
258 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!reparent@{reparent}}
\index{reparent@{reparent}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{reparent(\+Node $\ast$new\+Parent, bool exclusive)}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::reparent (
\begin{DoxyParamCaption}
\item[{{\bf H\+T\+T\+P2\+Priority\+Queue\+::\+Node} $\ast$}]{new\+Parent, }
\item[{bool}]{exclusive}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a26201ab228869cf6914d0e1fff249689}


Definition at line 117 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References detach\+Child(), emplace\+Node(), enqueued\+\_\+, in\+Egress\+Tree(), parent\+\_\+, propagate\+Pending\+Egress\+Clear(), propagate\+Pending\+Egress\+Signal(), and total\+Enqueued\+Weight\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::update\+Priority().


\begin{DoxyCode}
118                                                    \{
119   \textcolor{comment}{// Save enqueued\_ and totalEnqueuedWeight\_, clear them and restore}
120   \textcolor{comment}{// after reparenting}
121   \textcolor{keywordtype}{bool} wasInEgressTree = inEgressTree();
122   \textcolor{keywordtype}{bool} enqueued = enqueued_;
123   uint64\_t totalEnqueuedWeight = totalEnqueuedWeight_;
124   totalEnqueuedWeight_ = 0;
125   enqueued_ = \textcolor{keyword}{false};
126   \textcolor{keywordflow}{if} (wasInEgressTree) \{
127     propagatePendingEgressClear(\textcolor{keyword}{this});
128   \}
129 
130   \textcolor{keyword}{auto} \textcolor{keyword}{self} = parent_->detachChild(\textcolor{keyword}{this});
131   (void)newParent->emplaceNode(std::move(\textcolor{keyword}{self}), exclusive);
132 
133   \textcolor{comment}{// Restore state}
134   enqueued_ = enqueued;
135   \textcolor{keywordflow}{if} (wasInEgressTree) \{
136     propagatePendingEgressSignal(\textcolor{keyword}{this});
137   \}
138   totalEnqueuedWeight_ += totalEnqueuedWeight;
139 
140   \textcolor{keywordflow}{return} \textcolor{keyword}{this};
141 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!set\+Permanent@{set\+Permanent}}
\index{set\+Permanent@{set\+Permanent}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{set\+Permanent()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::set\+Permanent (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_ad64d44281ef8c5e2a8327a76a701ab57}


Definition at line 247 of file H\+T\+T\+P2\+Priority\+Queue.\+h.


\begin{DoxyCode}
247                         \{
248       isPermanent_ = \textcolor{keyword}{true};
249     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!signal\+Pending\+Egress@{signal\+Pending\+Egress}}
\index{signal\+Pending\+Egress@{signal\+Pending\+Egress}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{signal\+Pending\+Egress()}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::signal\+Pending\+Egress (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a714d4aaf2721ea42f06498c58044d48b}


Definition at line 172 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References enqueued\+\_\+, and propagate\+Pending\+Egress\+Signal().


\begin{DoxyCode}
172                                             \{
173   enqueued_ = \textcolor{keyword}{true};
174   propagatePendingEgressSignal(\textcolor{keyword}{this});
175 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!timeout\+Expired@{timeout\+Expired}}
\index{timeout\+Expired@{timeout\+Expired}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{timeout\+Expired() noexceptoverride}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::timeout\+Expired (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [noexcept]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a8d19bfacd4d17fdfd5a25dfdc822e022}


Definition at line 387 of file H\+T\+T\+P2\+Priority\+Queue.\+h.


\begin{DoxyCode}
387                                             \{
388       VLOG(5) << \textcolor{stringliteral}{"Node="} << id_ << \textcolor{stringliteral}{" expired"};
389       CHECK(txn_ == \textcolor{keyword}{nullptr});
390       queue_.pendingWeightChange_ = \textcolor{keyword}{true};
391       removeFromTree();
392     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!update\+Enqueued\+Weight@{update\+Enqueued\+Weight}}
\index{update\+Enqueued\+Weight@{update\+Enqueued\+Weight}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{update\+Enqueued\+Weight(bool active\+Nodes)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::update\+Enqueued\+Weight (
\begin{DoxyParamCaption}
\item[{bool}]{active\+Nodes}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_aa224a9f052aee7223776bb055043ccf1}


Definition at line 325 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References children\+\_\+, enqueued\+Hook\+\_\+, is\+Enqueued(), parent\+\_\+, total\+Child\+Weight\+\_\+, total\+Enqueued\+Weight\+Check\+\_\+, and weight\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::iterate\+B\+F\+S(), proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::next\+Egress(), and proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::update\+Enqueued\+Weight().


\begin{DoxyCode}
325                                                              \{
326   totalEnqueuedWeightCheck_ = totalChildWeight_;
327   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& child: children_) \{
328     child->updateEnqueuedWeight(activeNodes);
329   \}
330   \textcolor{keywordflow}{if} (activeNodes) \{
331     \textcolor{keywordflow}{if} (totalEnqueuedWeightCheck_ == 0 && !isEnqueued()) \{
332       \textcolor{comment}{// Must only be called with activeCount\_ > 0, root cannot be dequeued}
333       CHECK\_NOTNULL(parent_)->totalEnqueuedWeightCheck\_ -= weight_;
334     \} \textcolor{keywordflow}{else} \{
335       CHECK(parent_ == \textcolor{keyword}{nullptr} || enqueuedHook_.is\_linked());
336     \}
337   \} \textcolor{keywordflow}{else} \{
338     totalEnqueuedWeightCheck_ = 0;
339   \}
340 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!update\+Weight@{update\+Weight}}
\index{update\+Weight@{update\+Weight}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{update\+Weight(uint8\+\_\+t weight)}]{\setlength{\rightskip}{0pt plus 5cm}void proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::update\+Weight (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{weight}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a38641bccb0c48ddb2d0747964ac14791}


Definition at line 221 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References in\+Egress\+Tree(), parent\+\_\+, refresh\+Timeout(), total\+Child\+Weight\+\_\+, total\+Enqueued\+Weight\+\_\+, and weight\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::update\+Priority().


\begin{DoxyCode}
221                                                    \{
222   int16\_t delta = weight - weight_ + 1;
223   weight\_ = weight + 1;
224   parent_->totalChildWeight_ += delta;
225   \textcolor{keywordflow}{if} (inEgressTree()) \{
226     parent_->totalEnqueuedWeight_ += delta;
227   \}
228   refreshTimeout();
229 \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!visit\+B\+FS@{visit\+B\+FS}}
\index{visit\+B\+FS@{visit\+B\+FS}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{visit\+B\+F\+S(double relative\+Parent\+Weight, const std\+::function$<$ bool(\+H\+T\+T\+P2\+Priority\+Queue \&queue, H\+T\+T\+P\+Codec\+::\+Stream\+I\+D, H\+T\+T\+P\+Transaction $\ast$, double)$>$ \&fn, bool all, Pending\+List \&pending\+Nodes, bool enqueued\+Children)}]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::visit\+B\+FS (
\begin{DoxyParamCaption}
\item[{double}]{relative\+Parent\+Weight, }
\item[{const std\+::function$<$ bool({\bf H\+T\+T\+P2\+Priority\+Queue} \&queue, {\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID}, {\bf H\+T\+T\+P\+Transaction} $\ast$, double)$>$ \&}]{fn, }
\item[{bool}]{all, }
\item[{{\bf Pending\+List} \&}]{pending\+Nodes, }
\item[{bool}]{enqueued\+Children}
\end{DoxyParamCaption}
)}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a7434bdf947944b6947ed8d2dd7ee26b9}


Definition at line 285 of file H\+T\+T\+P2\+Priority\+Queue.\+cpp.



References children\+\_\+, enqueued\+Children\+\_\+, get\+Relative\+Enqueued\+Weight(), id\+\_\+, is\+Enqueued(), parent\+\_\+, queue\+\_\+, total\+Enqueued\+Weight\+\_\+, total\+Enqueued\+Weight\+Check\+\_\+, and txn\+\_\+.



Referenced by proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::iterate\+B\+F\+S(), and proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::next\+Egress().


\begin{DoxyCode}
290                                                     \{
291   \textcolor{keywordtype}{bool} invoke = (parent_ != \textcolor{keyword}{nullptr} && (all || isEnqueued()));
292   \textcolor{keyword}{auto} relativeEnqueuedWeight = getRelativeEnqueuedWeight();
293 
294 \textcolor{preprocessor}{#ifndef NDEBUG}
295   CHECK\_EQ(totalEnqueuedWeight_, totalEnqueuedWeightCheck_);
296 \textcolor{preprocessor}{#endif}
297   \textcolor{comment}{// Add children when all==true, or for any not invoked node with}
298   \textcolor{comment}{// pending children}
299   \textcolor{keywordflow}{if} (all || (!invoke && totalEnqueuedWeight_ > 0)) \{
300     \textcolor{keywordtype}{double} newRelWeight = relativeParentWeight * relativeEnqueuedWeight;
301     \textcolor{keywordflow}{if} (enqueuedChildren) \{
302       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} child = enqueuedChildren_.begin();
303            child != enqueuedChildren_.end();
304            child++) \{
305         pendingNodes.emplace\_back(child->id\_, &(*child), newRelWeight);
306       \}
307     \} \textcolor{keywordflow}{else} \{
308       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& child: children_) \{
309         pendingNodes.emplace\_back(child->id\_, child.get(), newRelWeight);
310       \}
311     \}
312   \}
313 
314   \textcolor{comment}{// Invoke fn last in case it deletes this node}
315   \textcolor{keywordflow}{if} (invoke && fn(queue_, id_, txn_,
316                    relativeParentWeight * relativeEnqueuedWeight)) \{
317     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
318   \}
319 
320   \textcolor{keywordflow}{return} \textcolor{keyword}{false};
321 \}
\end{DoxyCode}


\subsection{Friends And Related Function Documentation}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!hash\+\_\+value@{hash\+\_\+value}}
\index{hash\+\_\+value@{hash\+\_\+value}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{hash\+\_\+value}]{\setlength{\rightskip}{0pt plus 5cm}std\+::size\+\_\+t hash\+\_\+value (
\begin{DoxyParamCaption}
\item[{const {\bf Node} \&}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [friend]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a849a4ba15f6583fd21f46723c8b4bec2}


Definition at line 243 of file H\+T\+T\+P2\+Priority\+Queue.\+h.


\begin{DoxyCode}
243                                                   \{
244       \textcolor{keywordflow}{return} IdHash()(node.id\_);
245     \}
\end{DoxyCode}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!operator==@{operator==}}
\index{operator==@{operator==}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{operator==}]{\setlength{\rightskip}{0pt plus 5cm}bool operator== (
\begin{DoxyParamCaption}
\item[{const {\bf Node} \&}]{lhs, }
\item[{const {\bf Node} \&}]{rhs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [friend]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a7a9eeb9777c59bfc82b4eff6f8df1cc6}


Definition at line 240 of file H\+T\+T\+P2\+Priority\+Queue.\+h.


\begin{DoxyCode}
240                                                              \{
241       \textcolor{keywordflow}{return} lhs.id\_ == rhs.id\_;
242     \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!children\+\_\+@{children\+\_\+}}
\index{children\+\_\+@{children\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{children\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}std\+::list$<$std\+::unique\+\_\+ptr$<${\bf Node}$>$ $>$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::children\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a6d5761a5cdb948b5bb4d25e58326a295}


Definition at line 412 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by add\+Child(), add\+Child\+To\+New\+Subtree\+Root(), detach\+Child(), drop\+Priority\+Nodes(), emplace\+Node(), flatten\+Subtree(), flatten\+Subtree\+D\+F\+S(), iterate(), remove\+From\+Tree(), update\+Enqueued\+Weight(), and visit\+B\+F\+S().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!enqueued\+\_\+@{enqueued\+\_\+}}
\index{enqueued\+\_\+@{enqueued\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{enqueued\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::enqueued\+\_\+ \{false\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_aae050ef4f2e8f36a5b5f15fe4b2f7735}


Definition at line 406 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by clear\+Pending\+Egress(), reparent(), and signal\+Pending\+Egress().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!enqueued\+Children\+\_\+@{enqueued\+Children\+\_\+}}
\index{enqueued\+Children\+\_\+@{enqueued\+Children\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{enqueued\+Children\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}folly\+::\+Intrusive\+List$<${\bf Node}, \&{\bf Node\+::enqueued\+Hook\+\_\+}$>$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::enqueued\+Children\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_afc68859ccd5c9a6f71d064b7a2a58b82}


Definition at line 418 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by add\+Enqueued\+Child(), remove\+Enqueued\+Child(), and visit\+B\+F\+S().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!enqueued\+Hook\+\_\+@{enqueued\+Hook\+\_\+}}
\index{enqueued\+Hook\+\_\+@{enqueued\+Hook\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{enqueued\+Hook\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}folly\+::\+Intrusive\+List\+Hook proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::enqueued\+Hook\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a691b4cf23427192902419b451f9954cb}


Definition at line 417 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by add\+Enqueued\+Child(), remove\+Enqueued\+Child(), and update\+Enqueued\+Weight().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!id\+\_\+@{id\+\_\+}}
\index{id\+\_\+@{id\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{id\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P\+Codec\+::\+Stream\+ID} proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::id\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_acec3a682a81ca0dff311b16fabfa0ee2}


Definition at line 402 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by add\+Child(), emplace\+Node(), is\+Descendant\+Of(), iterate(), Node(), proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::\+Id\+Node\+Equal\+::operator()(), and visit\+B\+F\+S().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!is\+Permanent\+\_\+@{is\+Permanent\+\_\+}}
\index{is\+Permanent\+\_\+@{is\+Permanent\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{is\+Permanent\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}bool proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::is\+Permanent\+\_\+ \{false\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_af20865216d96f0bc45abdd2171791fad}


Definition at line 405 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by convert\+Virtual\+Node(), detach\+Child(), and drop\+Priority\+Nodes().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!k\+Default\+Weight@{k\+Default\+Weight}}
\index{k\+Default\+Weight@{k\+Default\+Weight}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{k\+Default\+Weight}]{\setlength{\rightskip}{0pt plus 5cm}const uint16\+\_\+t proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::k\+Default\+Weight = 16\hspace{0.3cm}{\ttfamily [static]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_ae5295eff5c62ee4b2beed72ba4d3da77}


Definition at line 215 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by add\+Child\+To\+New\+Subtree\+Root().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!parent\+\_\+@{parent\+\_\+}}
\index{parent\+\_\+@{parent\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{parent\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Node}$\ast$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::parent\+\_\+ \{{\bf nullptr}\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_ac2ad7dd94ab501566da25cbdbee5d352}


Definition at line 401 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by detach\+Child(), is\+Descendant\+Of(), iterate(), propagate\+Pending\+Egress\+Clear(), propagate\+Pending\+Egress\+Signal(), remove\+From\+Tree(), reparent(), update\+Enqueued\+Weight(), update\+Weight(), and visit\+B\+F\+S().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!queue\+\_\+@{queue\+\_\+}}
\index{queue\+\_\+@{queue\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{queue\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P2\+Priority\+Queue}\& proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::queue\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_acabc7c3308dba6c07bedad503e9041bf}


Definition at line 400 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by convert\+Virtual\+Node(), detach\+Child(), Node(), visit\+B\+F\+S(), and $\sim$\+Node().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!self\+\_\+@{self\+\_\+}}
\index{self\+\_\+@{self\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{self\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}std\+::list$<$std\+::unique\+\_\+ptr$<${\bf Node}$>$ $>$\+::iterator proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::self\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_aa4720ec8458f1ca5b80308dba2e614ea}


Definition at line 413 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by add\+Child(), add\+Child\+To\+New\+Subtree\+Root(), and detach\+Child().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!total\+Child\+Weight\+\_\+@{total\+Child\+Weight\+\_\+}}
\index{total\+Child\+Weight\+\_\+@{total\+Child\+Weight\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{total\+Child\+Weight\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}uint64\+\_\+t proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::total\+Child\+Weight\+\_\+ \{0\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_aacd6a5144c6427099e3209bbb69e8e3b}


Definition at line 411 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by add\+Child(), detach\+Child(), emplace\+Node(), flatten\+Subtree(), remove\+From\+Tree(), update\+Enqueued\+Weight(), and update\+Weight().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!total\+Enqueued\+Weight\+\_\+@{total\+Enqueued\+Weight\+\_\+}}
\index{total\+Enqueued\+Weight\+\_\+@{total\+Enqueued\+Weight\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{total\+Enqueued\+Weight\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}uint64\+\_\+t proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::total\+Enqueued\+Weight\+\_\+ \{0\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a18d546db98034916f794ea7f6ebeacd6}


Definition at line 410 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by add\+Children(), emplace\+Node(), flatten\+Subtree(), iterate(), propagate\+Pending\+Egress\+Clear(), propagate\+Pending\+Egress\+Signal(), remove\+From\+Tree(), reparent(), update\+Weight(), and visit\+B\+F\+S().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!total\+Enqueued\+Weight\+Check\+\_\+@{total\+Enqueued\+Weight\+Check\+\_\+}}
\index{total\+Enqueued\+Weight\+Check\+\_\+@{total\+Enqueued\+Weight\+Check\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{total\+Enqueued\+Weight\+Check\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}uint64\+\_\+t proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::total\+Enqueued\+Weight\+Check\+\_\+ \{0\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_ac95d7fd8704179238ab387e7814ff7c3}


Definition at line 408 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by emplace\+Node(), flatten\+Subtree(), iterate(), update\+Enqueued\+Weight(), and visit\+B\+F\+S().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!txn\+\_\+@{txn\+\_\+}}
\index{txn\+\_\+@{txn\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{txn\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}{\bf H\+T\+T\+P\+Transaction}$\ast$ proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::txn\+\_\+ \{{\bf nullptr}\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a32229378e71b45aaf3b783fb4a186da2}


Definition at line 404 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by calculate\+Depth(), convert\+Virtual\+Node(), detach\+Child(), drop\+Priority\+Nodes(), iterate(), visit\+B\+F\+S(), and $\sim$\+Node().

\index{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}!weight\+\_\+@{weight\+\_\+}}
\index{weight\+\_\+@{weight\+\_\+}!proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node@{proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node}}
\subsubsection[{weight\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t proxygen\+::\+H\+T\+T\+P2\+Priority\+Queue\+::\+Node\+::weight\+\_\+ \{{\bf k\+Default\+Weight}\}\hspace{0.3cm}{\ttfamily [private]}}\label{classproxygen_1_1HTTP2PriorityQueue_1_1Node_a498c8cf6394bb8e0b06c36a64d0f2bc2}


Definition at line 403 of file H\+T\+T\+P2\+Priority\+Queue.\+h.



Referenced by detach\+Child(), propagate\+Pending\+Egress\+Clear(), propagate\+Pending\+Egress\+Signal(), remove\+From\+Tree(), update\+Enqueued\+Weight(), and update\+Weight().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
proxygen/lib/http/session/{\bf H\+T\+T\+P2\+Priority\+Queue.\+h}\item 
proxygen/lib/http/session/{\bf H\+T\+T\+P2\+Priority\+Queue.\+cpp}\end{DoxyCompactItemize}
