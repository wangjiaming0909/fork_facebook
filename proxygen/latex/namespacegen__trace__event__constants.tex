\section{gen\+\_\+trace\+\_\+event\+\_\+constants Namespace Reference}
\label{namespacegen__trace__event__constants}\index{gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def {\bf main} (argv)
\item 
def {\bf gen\+\_\+java} (items, class\+\_\+name, install\+\_\+dir, output\+\_\+scope)
\item 
def {\bf gen\+\_\+cpp\+\_\+header} (items, class\+\_\+name, install\+\_\+dir, output\+\_\+scope)
\item 
def {\bf gen\+\_\+cpp\+\_\+source} (items, class\+\_\+name, install\+\_\+dir, header\+\_\+path, output\+\_\+scope)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}!gen\+\_\+cpp\+\_\+header@{gen\+\_\+cpp\+\_\+header}}
\index{gen\+\_\+cpp\+\_\+header@{gen\+\_\+cpp\+\_\+header}!gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}}
\subsubsection[{gen\+\_\+cpp\+\_\+header(items, class\+\_\+name, install\+\_\+dir, output\+\_\+scope)}]{\setlength{\rightskip}{0pt plus 5cm}def gen\+\_\+trace\+\_\+event\+\_\+constants.\+gen\+\_\+cpp\+\_\+header (
\begin{DoxyParamCaption}
\item[{}]{items, }
\item[{}]{class\+\_\+name, }
\item[{}]{install\+\_\+dir, }
\item[{}]{output\+\_\+scope}
\end{DoxyParamCaption}
)}\label{namespacegen__trace__event__constants_a63a5ebae8d17cb6121129abf95fdaefb}


Definition at line 134 of file gen\+\_\+trace\+\_\+event\+\_\+constants.\+py.



Referenced by main().


\begin{DoxyCode}
134 \textcolor{keyword}{def }gen_cpp_header(items, class\_name, install\_dir, output\_scope):
135     namespaces = output\_scope.split(\textcolor{stringliteral}{"::"})
136     file\_name = \textcolor{stringliteral}{"%s.h"} % class\_name
137     output\_file = os.path.join(install\_dir, file\_name)
138 
139     with open(output\_file, \textcolor{stringliteral}{"w+"}) \textcolor{keyword}{as} outf:
140         outf.write(\textcolor{stringliteral}{"// Copyright 2015-present Facebook. All Rights Reserved.\(\backslash\)n"})
141         outf.write(\textcolor{stringliteral}{"// ** AUTOGENERATED FILE. DO NOT HAND-EDIT **\(\backslash\)n\(\backslash\)n"})
142         outf.write(\textcolor{stringliteral}{"#pragma once\(\backslash\)n\(\backslash\)n"})
143         outf.write(\textcolor{stringliteral}{"#include <string>\(\backslash\)n\(\backslash\)n"})
144         \textcolor{keywordflow}{for} ns \textcolor{keywordflow}{in} namespaces:
145             outf.write(\textcolor{stringliteral}{"namespace %s \{ "} % ns)
146         outf.write(\textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n"})
147 
148         \textcolor{comment}{# generate enum class}
149         outf.write(\textcolor{stringliteral}{"enum class %s \{\(\backslash\)n"} % class\_name)
150         \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} items:
151             outf.write(\textcolor{stringliteral}{"    %s,\(\backslash\)n"} % item[0])
152         outf.write(\textcolor{stringliteral}{"\};\(\backslash\)n\(\backslash\)n"})
153 
154         \textcolor{comment}{# enum to string convert function}
155         outf.write(
156             \textcolor{stringliteral}{"extern const std::string& get%sString(%s);\(\backslash\)n"} % (class\_name, class\_name)
157         )
158 
159         outf.write(
160             \textcolor{stringliteral}{"extern %s get%sFromString(const std::string&);\(\backslash\)n"}
161             % (class\_name, class\_name)
162         )
163         \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} namespaces:
164             outf.write(\textcolor{stringliteral}{"\}"})
165         outf.write(\textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n"})
166 
167 
168 \textcolor{stringliteral}{"""}
169 \textcolor{stringliteral}{Generate cpp const string and implement convert function}
170 \textcolor{stringliteral}{"""}
171 
172 
\end{DoxyCode}
\index{gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}!gen\+\_\+cpp\+\_\+source@{gen\+\_\+cpp\+\_\+source}}
\index{gen\+\_\+cpp\+\_\+source@{gen\+\_\+cpp\+\_\+source}!gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}}
\subsubsection[{gen\+\_\+cpp\+\_\+source(items, class\+\_\+name, install\+\_\+dir, header\+\_\+path, output\+\_\+scope)}]{\setlength{\rightskip}{0pt plus 5cm}def gen\+\_\+trace\+\_\+event\+\_\+constants.\+gen\+\_\+cpp\+\_\+source (
\begin{DoxyParamCaption}
\item[{}]{items, }
\item[{}]{class\+\_\+name, }
\item[{}]{install\+\_\+dir, }
\item[{}]{header\+\_\+path, }
\item[{}]{output\+\_\+scope}
\end{DoxyParamCaption}
)}\label{namespacegen__trace__event__constants_ac3f40c6a4d574ce2d85dd893bab64a18}


Definition at line 173 of file gen\+\_\+trace\+\_\+event\+\_\+constants.\+py.



References main().



Referenced by main().


\begin{DoxyCode}
173 \textcolor{keyword}{def }gen_cpp_source(items, class\_name, install\_dir, header\_path, output\_scope):
174     namespaces = output\_scope.split(\textcolor{stringliteral}{"::"})
175     file\_name = \textcolor{stringliteral}{"%s.cpp"} % class\_name
176     output\_file = os.path.join(install\_dir, file\_name)
177 
178     with open(output\_file, \textcolor{stringliteral}{"w+"}) \textcolor{keyword}{as} outf:
179         outf.write(\textcolor{stringliteral}{"// Copyright 2015-present Facebook. All Rights Reserved.\(\backslash\)n"})
180         outf.write(\textcolor{stringliteral}{"// ** AUTOGENERATED FILE. DO NOT HAND-EDIT **\(\backslash\)n\(\backslash\)n"})
181         outf.write(\textcolor{stringliteral}{'#include "%s/%s.h"\(\backslash\)n\(\backslash\)n'} % (header\_path, class\_name))
182         outf.write(\textcolor{stringliteral}{"#include <stdexcept>\(\backslash\)n\(\backslash\)n"})
183 
184         \textcolor{keywordflow}{for} ns \textcolor{keywordflow}{in} namespaces:
185             outf.write(\textcolor{stringliteral}{"namespace %s \{ "} % ns)
186         outf.write(\textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n"})
187 
188         \textcolor{comment}{# const string names}
189         \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} items:
190             outf.write(
191                 \textcolor{stringliteral}{'static const std::string k%s%s = "%s";\(\backslash\)n'}
192                 % (class\_name, item[0], item[1])
193             )
194 
195         \textcolor{comment}{# generate enum to string convert function}
196         outf.write(
197             \textcolor{stringliteral}{"const std::string& get%sString(%s type) \{\(\backslash\)n"} % (class\_name, class\_name)
198         )
199 
200         outf.write(\textcolor{stringliteral}{'  static const std::string k%sInvalidType = "";\(\backslash\)n'} % class\_name)
201 
202         outf.write(\textcolor{stringliteral}{"\(\backslash\)n  switch (type) \{\(\backslash\)n"})
203         \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} items:
204             outf.write(
205                 \textcolor{stringliteral}{"    case %s::%s : return k%s%s;\(\backslash\)n"}
206                 % (class\_name, item[0], class\_name, item[0])
207             )
208         outf.write(\textcolor{stringliteral}{"  \}\(\backslash\)n"})
209         outf.write(\textcolor{stringliteral}{"  return k%sInvalidType;\(\backslash\)n"} % class\_name)
210         outf.write(\textcolor{stringliteral}{"\};\(\backslash\)n\(\backslash\)n"})
211 
212         outf.write(
213             \textcolor{stringliteral}{"  %s get%sFromString(const std::string& str) \{\(\backslash\)n"}
214             % (class\_name, class\_name)
215         )
216         \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} items:
217             outf.write(
218                 \textcolor{stringliteral}{"  if (str == k%s%s)  return %s::%s;\(\backslash\)n"}
219                 % (class\_name, item[0], class\_name, item[0])
220             )
221         outf.write(
222             \textcolor{stringliteral}{" throw std::invalid\_argument"}
223             \textcolor{stringliteral}{' ("No matching %s from string");\(\backslash\)n'} % (class\_name)
224         )
225         outf.write(\textcolor{stringliteral}{"\};\(\backslash\)n"})
226         outf.write(\textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n"})
227         \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} namespaces:
228             outf.write(\textcolor{stringliteral}{"\}"})
229         outf.write(\textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n"})
230 
231 
\end{DoxyCode}
\index{gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}!gen\+\_\+java@{gen\+\_\+java}}
\index{gen\+\_\+java@{gen\+\_\+java}!gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}}
\subsubsection[{gen\+\_\+java(items, class\+\_\+name, install\+\_\+dir, output\+\_\+scope)}]{\setlength{\rightskip}{0pt plus 5cm}def gen\+\_\+trace\+\_\+event\+\_\+constants.\+gen\+\_\+java (
\begin{DoxyParamCaption}
\item[{}]{items, }
\item[{}]{class\+\_\+name, }
\item[{}]{install\+\_\+dir, }
\item[{}]{output\+\_\+scope}
\end{DoxyParamCaption}
)}\label{namespacegen__trace__event__constants_aa42d9b0bd44e7bc2c5a637c5d2c1d979}


Definition at line 106 of file gen\+\_\+trace\+\_\+event\+\_\+constants.\+py.



Referenced by main().


\begin{DoxyCode}
106 \textcolor{keyword}{def }gen_java(items, class\_name, install\_dir, output\_scope):
107     packages = output\_scope.split(\textcolor{stringliteral}{"."})
108     file\_name = \textcolor{stringliteral}{"%s.java"} % class\_name
109     file\_path = os.path.join(*([install\_dir, \textcolor{stringliteral}{"src"}] + packages))
110     output\_file = os.path.join(file\_path, file\_name)
111 
112     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(file\_path):
113         os.makedirs(file\_path)
114 
115     with open(output\_file, \textcolor{stringliteral}{"w+"}) \textcolor{keyword}{as} outf:
116         outf.write(\textcolor{stringliteral}{"// Copyright 2015-present Facebook. All Rights Reserved.\(\backslash\)n"})
117         outf.write(\textcolor{stringliteral}{"// ** AUTOGENERATED FILE. DO NOT HAND-EDIT **\(\backslash\)n\(\backslash\)n"})
118         outf.write(\textcolor{stringliteral}{"package %s;\(\backslash\)n\(\backslash\)n"} % \textcolor{stringliteral}{"."}.join(packages))
119         outf.write(\textcolor{stringliteral}{"public interface %s \{\(\backslash\)n"} % class\_name)
120 
121         \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} items:
122             outf.write(
123                 \textcolor{stringliteral}{'    public static final String %s = "%s";\(\backslash\)n'} % (item[0], item[1])
124             )
125 
126         outf.write(\textcolor{stringliteral}{"\}\(\backslash\)n"})
127 
128 
129 \textcolor{stringliteral}{"""}
130 \textcolor{stringliteral}{Generate cpp enum class and provide convert function from / to string}
131 \textcolor{stringliteral}{"""}
132 
133 
\end{DoxyCode}
\index{gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}!main@{main}}
\index{main@{main}!gen\+\_\+trace\+\_\+event\+\_\+constants@{gen\+\_\+trace\+\_\+event\+\_\+constants}}
\subsubsection[{main(argv)}]{\setlength{\rightskip}{0pt plus 5cm}def gen\+\_\+trace\+\_\+event\+\_\+constants.\+main (
\begin{DoxyParamCaption}
\item[{}]{argv}
\end{DoxyParamCaption}
)}\label{namespacegen__trace__event__constants_ac8e613952e6f4289219450e8385d1769}


Definition at line 18 of file gen\+\_\+trace\+\_\+event\+\_\+constants.\+py.



References gen\+\_\+cpp\+\_\+header(), gen\+\_\+cpp\+\_\+source(), and gen\+\_\+java().



Referenced by gen\+\_\+cpp\+\_\+source().


\begin{DoxyCode}
18 \textcolor{keyword}{def }main(argv):
19     \textcolor{comment}{# args parser}
20     parser = optparse.OptionParser()
21     parser.add\_option(
22         \textcolor{stringliteral}{"--install\_dir"},
23         dest=\textcolor{stringliteral}{"install\_dir"},
24         type=\textcolor{stringliteral}{"string"},
25         default=\textcolor{keywordtype}{None},
26         help=\textcolor{stringliteral}{"Absolute path to generate files"},
27     )
28     parser.add\_option(
29         \textcolor{stringliteral}{"--fbcode\_dir"},
30         dest=\textcolor{stringliteral}{"fbcode\_dir"},
31         type=\textcolor{stringliteral}{"string"},
32         default=\textcolor{keywordtype}{None},
33         help=\textcolor{stringliteral}{"Absolute path to fbcode directory"},
34     )
35     parser.add\_option(
36         \textcolor{stringliteral}{"--input\_files"},
37         dest=\textcolor{stringliteral}{"input\_files"},
38         type=\textcolor{stringliteral}{"string"},
39         default=\textcolor{keywordtype}{None},
40         help=\textcolor{stringliteral}{"Relative path of input file"},
41     )
42     parser.add\_option(
43         \textcolor{stringliteral}{"--output\_scope"},
44         dest=\textcolor{stringliteral}{"output\_scope"},
45         type=\textcolor{stringliteral}{"string"},
46         default=\textcolor{keywordtype}{None},
47         help=\textcolor{stringliteral}{"namespace / package of output file"},
48     )
49     parser.add\_option(
50         \textcolor{stringliteral}{"--output\_type"},
51         dest=\textcolor{stringliteral}{"output\_type"},
52         type=\textcolor{stringliteral}{"choice"},
53         choices=[\textcolor{stringliteral}{"java"}, \textcolor{stringliteral}{"cpp"}],
54         default=\textcolor{keywordtype}{None},
55         help=\textcolor{stringliteral}{"File type to generate"},
56     )
57     parser.add\_option(
58         \textcolor{stringliteral}{"--header\_path"},
59         dest=\textcolor{stringliteral}{"header\_path"},
60         type=\textcolor{stringliteral}{"string"},
61         default=\textcolor{keywordtype}{None},
62         help=\textcolor{stringliteral}{"Relative path to cpp header"},
63     )
64     options, \_ = parser.parse\_args()
65 
66     \textcolor{keyword}{assert} options.install\_dir \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"Missing arg: --install\_dir"}
67     \textcolor{keyword}{assert} options.fbcode\_dir \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"Missing arg: --fbcode\_dir"}
68     \textcolor{keyword}{assert} options.input\_files \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"Missing arg: --input\_files"}
69     \textcolor{keyword}{assert} options.output\_scope \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"Missing arg: --output\_scope"}
70     \textcolor{keyword}{assert} options.output\_type \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"Missing arg: --output\_type"}
71 
72     file\_names = options.input\_files.split(\textcolor{stringliteral}{","})
73     \textcolor{keywordflow}{for} file\_name \textcolor{keywordflow}{in} file\_names:
74         \textcolor{comment}{# strip the file extension and use the file name for class name}
75         class\_name = os.path.basename(file\_name).split(\textcolor{stringliteral}{"."})[0]
76 
77         \textcolor{comment}{# parse items from source}
78         items = []
79         with open(file\_name, \textcolor{stringliteral}{"r") as inf:}
80 \textcolor{stringliteral}{            }\textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} inf:
81                 sp = re.match(\textcolor{stringliteral}{r"(.*), \(\backslash\)"(.*)\(\backslash\)""}, line, re.I)
82                 \textcolor{keywordflow}{if} sp:
83                     items.append((sp.group(1), sp.group(2)))
84 
85         \textcolor{keywordflow}{if} options.output\_type == \textcolor{stringliteral}{"java"}:
86             gen_java(items, class\_name, options.install\_dir, options.output\_scope)
87 
88         \textcolor{keywordflow}{elif} options.output\_type == \textcolor{stringliteral}{"cpp"}:
89             \textcolor{keyword}{assert} options.header\_path \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"Missing arg: --header\_path"}
90 
91             gen_cpp_header(items, class\_name, options.install\_dir, options.output\_scope)
92             gen_cpp_source(
93                 items,
94                 class\_name,
95                 options.install\_dir,
96                 options.header\_path,
97                 options.output\_scope,
98             )
99 
100 
101 \textcolor{stringliteral}{"""}
102 \textcolor{stringliteral}{Generate java interface class}
103 \textcolor{stringliteral}{"""}
104 
105 
\end{DoxyCode}
